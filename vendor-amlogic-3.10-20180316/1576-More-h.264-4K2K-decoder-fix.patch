From 3c4a7707fcef8cfb97b79e6c481f4fdb26e4185d Mon Sep 17 00:00:00 2001
From: timyao <tim.yao@amlogic.com>
Date: Fri, 18 Oct 2013 18:54:49 -0700
Subject: [PATCH 1576/5965] More h.264 4K2K decoder fix (cherry picked from
 commit 670017f0de363e4eb0974d29309bd71f26ad2757)

---
 .../amports/m8/ucode/h264_4k2k/h264c_linux.h  |   8 +-
 .../m8/ucode/h264_4k2k/h264mmc_linux.h        | 104 ++++----
 .../m8/ucode/h264_4k2k/h264slice_linux.h      | 246 +++++++++---------
 drivers/amlogic/amports/vh264_4k2k.c          |  35 +++
 4 files changed, 215 insertions(+), 178 deletions(-)

diff --git a/drivers/amlogic/amports/m8/ucode/h264_4k2k/h264c_linux.h b/drivers/amlogic/amports/m8/ucode/h264_4k2k/h264c_linux.h
index 0fc6191e2e83..fc32fb11e8ab 100755
--- a/drivers/amlogic/amports/m8/ucode/h264_4k2k/h264c_linux.h
+++ b/drivers/amlogic/amports/m8/ucode/h264_4k2k/h264c_linux.h
@@ -4,7 +4,7 @@ const u32 MicroCode[] __attribute__ ((aligned (8))) = {
 	0xc7ffd00,0xa60c141,0xc781b80,0x0800000,0xa608181,0xc7ffbc0,0xa6081c1,0xc7838c0,
 	0xc7ffb00,0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,
 	0xc781e40,0x0000000,0xcc00000,0x0400000,0xcb80003,0x0000000,0xcc00000,0x0400000,
-	0xc7a4380,0x0000000,0xcc00000,0x0400000,0xcc00000,0x0400000,0xc7a4200,0x0000000,
+	0xc7a4400,0x0000000,0xcc00000,0x0400000,0xcc00000,0x0400000,0xc7a4280,0x0000000,
 	0xc781ac0,0x0000000,0xcc00000,0x0400000,0x6800000,0x6800001,0x7400040,0xb2fc7c1,
 	0x4001041,0x7c01b80,0x7c01bc0,0x7c01c00,0x7c00c40,0x7c00c80,0x68002c0,0x7c00700,
 	0x7c006c0,0x6803fc0,0x7c01300,0x69fffc0,0x7c02140,0x7c00280,0x64c4000,0x64c4201,
@@ -13,7 +13,7 @@ const u32 MicroCode[] __attribute__ ((aligned (8))) = {
 	0x80c0002,0x6bffe80,0x6030400,0x6810003,0x809ca02,0xc7fe9c0,0x0400000,0x6034201,
 	0x649ce01,0x2000040,0x6034100,0x6a10000,0x6c001c0,0x6034000,0xa60c042,0xc000980,
 	0x0000000,0xa60c082,0xc000ac0,0x0000000,0xa60c0c2,0xc000a80,0x0000000,0x6434000,
-	0x580f000,0xbef8040,0xcc00000,0x0000000,0x649d100,0xaa180c0,0x6840000,0x6819501,
+	0x580f000,0xbef8040,0xcc00000,0x0000000,0x649d100,0xaa180c0,0x6840000,0x6819581,
 	0xc07f9c0,0x6800082,0x809d103,0x6bffd80,0x6030400,0x809ca04,0xc78e080,0x0400000,
 	0x649d100,0xaa18100,0x68c0000,0x6821401,0xc07f6c0,0x68000c2,0x809d104,0x6bffe80,
 	0x6030400,0x6810e83,0x809ca06,0xc78dd40,0x0400000,0x6800000,0x7c01280,0x7c01500,
@@ -54,5 +54,7 @@ const u32 MicroCode[] __attribute__ ((aligned (8))) = {
 	0x4c03082,0x609c002,0x8007401,0x78006c0,0x4001000,0x68006c1,0xb803040,0x0000000,
 	0x68002c0,0xcc00000,0x7c006c0,0x649c002,0xa6fc002,0x0000000,0x609c100,0x609c201,
 	0x809c00a,0x649cd00,0xbe0e000,0xc7800c0,0x8007001,0x8007401,0x649c000,0xa6fc000,
-	0x0000000,0xcc00000,0x0000000,0x0000000
+	0x0000000,0xcc00000,0x0000000,0x649c007,0xa6bc007,0x0000000,0x609c105,0x609c206,
+	0x809c00a,0x649cd05,0xbe12005,0xc780140,0x8007001,0x0000000,0x8007401,0x0000000,
+	0x649c005,0xa6b4005,0x0000000,0xcc00000,0x0000000,0x0000000
 };
diff --git a/drivers/amlogic/amports/m8/ucode/h264_4k2k/h264mmc_linux.h b/drivers/amlogic/amports/m8/ucode/h264_4k2k/h264mmc_linux.h
index 0bc73c895bf4..07843b7cdbbf 100755
--- a/drivers/amlogic/amports/m8/ucode/h264_4k2k/h264mmc_linux.h
+++ b/drivers/amlogic/amports/m8/ucode/h264_4k2k/h264mmc_linux.h
@@ -1,7 +1,7 @@
 const u32 MicroCode[] __attribute__ ((aligned (8))) = {
 	0x7801618,0x78014c8,0xa613fc8,0x0000000,0x6800008,0x7c014c8,0xa60c018,0x4000658,
 	0xc7834c0,0xaa0c008,0x6800049,0x6800089,0x700024a,0x780000b,0xa83c2ca,0x740024b,
-	0x649cd09,0xbe0e009,0xc780940,0x0000000,0x67f290a,0xa20c04a,0xc017a80,0x901e28a,
+	0x649cd09,0xbe0e009,0xc780940,0x0000000,0x67f290a,0xa20c04a,0xc017ac0,0x901e28a,
 	0x7800809,0x97082c9,0x78009c9,0x96082c9,0x609c10b,0x40012c8,0x609c00b,0x8007401,
 	0x649c00b,0xa6fc00b,0x0000000,0x649c10b,0x63f2d0b,0x910828b,0x7c001ca,0x900828b,
 	0x7c0020a,0x649c20b,0x63f2e0b,0x7c0014b,0x92102cb,0x7c0018b,0xc0060c0,0x0000000,
@@ -10,22 +10,22 @@ const u32 MicroCode[] __attribute__ ((aligned (8))) = {
 	0x92102cb,0x7c0018b,0x83f2d00,0x83f2e00,0x67f2a08,0x4002208,0x9c08008,0x9c087c8,
 	0x9c08788,0x63f2a08,0x7801148,0xa62c148,0x78014c8,0xa624008,0x6800008,0x7c01b88,
 	0x7c01bc8,0x7c01c08,0x649cd09,0xbe16009,0xc780540,0x0000000,0xc780800,0x0000000,
-	0x67f290a,0xc016c40,0x901e28a,0xc009e00,0x0000000,0x67f2908,0x93c2248,0xaa100c9,
+	0x67f290a,0xc016c80,0x901e28a,0xc009e00,0x0000000,0x67f2908,0x93c2248,0xaa100c9,
 	0xaa0c009,0xc780480,0x0000000,0x4002208,0x9c08008,0x9c087c8,0x9c08788,0xc780300,
-	0x63f2908,0x67f2a08,0xc016380,0x901e288,0x67f2a08,0x4002208,0x9c08008,0x9c087c8,
+	0x63f2908,0x67f2a08,0xc0163c0,0x901e288,0x67f2a08,0x4002208,0x9c08008,0x9c087c8,
 	0x9c08788,0xc780080,0x63f2a08,0x6800008,0x7c000c8,0x7c00108,0x649cd09,0xbe66009,
 	0x0000000,0x67f2a0a,0x93c220a,0xb20c048,0x901e28a,0x400128a,0x6800048,0x97c2288,
 	0x63f2a0a,0xbe2004a,0x0000000,0x67f2a0a,0x6800088,0x97c2288,0x63f2a0a,0xc7edf40,
-	0x809ca01,0x901e28a,0xc015b80,0x440128a,0xc016800,0x0000000,0xc7803c0,0x0000000,
+	0x809ca01,0x901e28a,0xc015bc0,0x440128a,0xc016840,0x0000000,0xc7803c0,0x0000000,
 	0x67f290a,0x93c220a,0xb20c048,0x901e28a,0x400128a,0x6800048,0x97c2288,0x63f290a,
-	0x901e28a,0xbe1004a,0xaa0c00a,0xc015940,0x440128a,0xc0047c0,0x0000000,0xa26e00b,
+	0x901e28a,0xbe1004a,0xaa0c00a,0xc015980,0x440128a,0xc0047c0,0x0000000,0xa26e00b,
 	0x910820b,0xbe32008,0x78014cb,0xaa0c00b,0x68000cb,0x680010b,0x680004a,0x340a20a,
 	0x6bfffc8,0x300a20a,0x70002c8,0x2808288,0x74002c8,0x649cd09,0xbe2a009,0x0000000,
 	0x67f2509,0x93e1249,0xa618009,0x0000000,0x6800009,0x98097c9,0x63f2409,0x63f2509,
 	0xc7ed300,0x809ca07,0x7c01ac9,0x7c01b4a,0x78014c8,0xa62c008,0x900820b,0x7c01fc8,
 	0x7800248,0xa60c008,0x6800048,0x7c01548,0x6800008,0x7c00248,0x7801548,0x7c02008,
 	0x649cd09,0xbe22009,0x0000000,0x67f2a0a,0x6800088,0x97c2288,0x63f2a0a,0xc780300,
-	0x83f2500,0xc015080,0x0000000,0x67f290a,0x6800088,0x97c2288,0x63f290a,0xc011ec0,
+	0x83f2500,0xc0150c0,0x0000000,0x67f290a,0x6800088,0x97c2288,0x63f290a,0xc011f00,
 	0x0000000,0xc010980,0x0000000,0x7801688,0xaa08088,0xc780980,0x7801149,0xaa20149,
 	0x7801109,0xaa18009,0x0000000,0xfc01240,0xaa0c009,0xc00c440,0x0000000,0xc06ee40,
 	0x80c2301,0xc06eec0,0x0000000,0x401a205,0x7800ec9,0x2008248,0x7c01a08,0x7800f48,
@@ -37,7 +37,7 @@ const u32 MicroCode[] __attribute__ ((aligned (8))) = {
 	0xfc01200,0xaa10008,0x7801916,0xc00c640,0x6808011,0xaa18019,0x6808008,0x7801aca,
 	0x7801913,0xc00a5c0,0x6800012,0x7800e48,0x4000248,0xaa34008,0x6094209,0xc06de40,
 	0x80c2301,0x9484245,0xc06dd80,0x80c2301,0x9504245,0x6094209,0x680c008,0x6094008,
-	0xc012380,0x780190a,0x6494008,0x9c08248,0x6094008,0x7801108,0xaa38008,0x0000000,
+	0xc0123c0,0x780190a,0x6494008,0x9c08248,0x6094008,0x7801108,0xaa38008,0x0000000,
 	0x7801148,0xa61c148,0x0000000,0xfc01200,0x7c01988,0xfc01200,0xc780180,0x7c019c8,
 	0xfc01200,0xaa0c008,0xc00ad00,0x0000000,0x7800d48,0xaa18008,0x6800c09,0xc06d640,
 	0x80c2301,0x9402245,0x60c2109,0xc7fe700,0x0000000,0xaa60019,0xc0079c0,0x6808008,
@@ -52,7 +52,7 @@ const u32 MicroCode[] __attribute__ ((aligned (8))) = {
 	0xc009240,0x6808808,0x6808808,0x7000208,0x5418208,0x609b308,0x649b308,0x48ff208,
 	0x7c01a48,0x7800e88,0xa60c088,0x6800009,0x6815409,0x9402248,0xa644048,0x6094209,
 	0xc06c000,0x80c2301,0x9484245,0xc06bf40,0x80c2301,0x9504245,0x6094209,0x680c008,
-	0x6094008,0xc010540,0x780190a,0x680d808,0x6094008,0xc010440,0x780194a,0xc7fe0c0,
+	0x6094008,0xc010580,0x780190a,0x680d808,0x6094008,0xc010480,0x780194a,0xc7fe0c0,
 	0x0000000,0x78014c8,0xaa0c008,0x6804049,0x6806049,0x6800008,0x780020a,0x7400248,
 	0xd07ffca,0x4008249,0xcc00000,0x0000000,0xc0013c0,0x6a0200b,0x649cd09,0xa226009,
 	0x67f2909,0xa21c049,0xc06d380,0x0000000,0x67f2609,0x93e1249,0xaaf0009,0x0000000,
@@ -95,7 +95,7 @@ const u32 MicroCode[] __attribute__ ((aligned (8))) = {
 	0x7800213,0x6bfffcd,0x400134d,0xb41b4cd,0x400038d,0x400044e,0x540338e,0x200e2ce,
 	0x400138e,0x700038c,0xa21004c,0x9c0c00c,0xc7ffd80,0x740038c,0x914224c,0xa6cc049,
 	0x910130c,0xaa0c00c,0x400138e,0x400238e,0x400130e,0x700038e,0x700030c,0x961038c,
-	0xb0ea38a,0x0000000,0x6800052,0x400028e,0xc7ff980,0x4000411,0xaa0c012,0xc00a280,
+	0xb0ea38a,0x0000000,0x6800052,0x400028e,0xc7ff980,0x4000411,0xaa0c012,0xc00a2c0,
 	0x0000000,0xcc00000,0x0000000,0x680004c,0x780090b,0x340c2cc,0x6808009,0x7801acf,
 	0xb8033c9,0xcc00000,0x0000000,0x78014cb,0xaa0c00b,0x680400b,0x680600b,0x700024a,
 	0x540328a,0x200a2ca,0x400628a,0x700028a,0xb00320a,0x4000349,0x240a30a,0x400134d,
@@ -159,47 +159,47 @@ const u32 MicroCode[] __attribute__ ((aligned (8))) = {
 	0xa60c00f,0x0000000,0x44014d3,0x4000493,0x4000453,0x7c01c95,0x58103d5,0x7c01ccf,
 	0xb803452,0x4000412,0x4000411,0x7c01d10,0x58103d0,0x7c01d4f,0x7c01d92,0x58103d2,
 	0x7c01dcf,0x7c01e11,0x58103d1,0x7c01e4f,0x7801714,0xcc00000,0x7c01c54,0x7801108,
-	0xaa18008,0x6808008,0x78009c9,0x2009209,0x7801ac8,0xb403248,0xcc00000,0x0000000,
-	0x6808009,0x7801acf,0x78014cb,0xaa0c00b,0x680400b,0x680600b,0x700024a,0x400040a,
-	0x540328a,0x200a2ca,0x400128a,0x700028c,0x910130c,0xaa0c00c,0x400128a,0x400228a,
-	0x400130a,0x700028a,0x700030c,0x961028c,0x4000349,0x400134d,0xb4143cd,0x700034e,
-	0x400044e,0x540338e,0x200e2ce,0x400138e,0x700038c,0x910130c,0xaa0c00c,0x400138e,
-	0x400238e,0x400130e,0x700038e,0x700030c,0x961038c,0xb0f038a,0x0000000,0x400028e,
-	0xc7ffb40,0x4000411,0xc000100,0x78014cf,0xcc00000,0x0000000,0xaa0c00f,0x680400b,
-	0x680600b,0x5403390,0x200e2ce,0x400138e,0x700038c,0xbe0804c,0xa24830c,0x9c0c0cc,
-	0x9c0c08c,0x9c0c00c,0x740038c,0x440138e,0x700038c,0x481f30c,0xaa0c00f,0x68000c8,
-	0x6800108,0x680004a,0x340a30a,0x6bfffcc,0x300a30a,0x7000209,0x2809289,0x7400209,
-	0xcc00000,0x0000000,0x6809008,0x78001c9,0x4001249,0x2009209,0x7801b48,0xb403248,
-	0xcc00000,0x0000000,0x6809009,0x7801b4f,0x78014cb,0xaa0c00b,0x680400b,0x680600b,
-	0x700024a,0x400040a,0x540328a,0x200a2ca,0x400128a,0x700028c,0xa21804c,0x0000000,
-	0x4001249,0xb8f73c9,0xcc00000,0x0000000,0x910130c,0xaa0c00c,0x400128a,0x400228a,
-	0x400130a,0x700028a,0x700030c,0x961028c,0x4000349,0x400134d,0xb4153cd,0x700034e,
-	0x400044e,0x540338e,0x200e2ce,0x400138e,0x700038c,0xbee004c,0x910130c,0xaa0c00c,
-	0x400138e,0x400238e,0x400130e,0x700038e,0x700030c,0x961038c,0xb0ef38a,0x0000000,
-	0x400028e,0xc7ffb00,0x4000411,0xc000180,0x78014cf,0xaa08011,0xc7ff680,0xcc00000,
-	0x0000000,0x6800011,0xaa0c00f,0x680400b,0x680600b,0x5403390,0x200e2ce,0x400138e,
-	0x700038d,0x400030d,0x980d2cd,0x9c0d28d,0x9c0d0cd,0x9c0d08d,0x9c0d00d,0x740038d,
-	0xa21c30c,0x980d00d,0x740038d,0x6800051,0x440138e,0x700038c,0x481f30c,0x94c240f,
-	0x780070b,0x74002d0,0x40012cb,0x68006cc,0xb80330b,0x0000000,0x68002cb,0x78006cc,
-	0xa40c30b,0x0000000,0x649c70c,0xaa0c00c,0xc05e000,0x0000000,0x649c00c,0xaa0c00c,
-	0xc7ffe80,0x0000000,0xc05ef00,0x0000000,0xcc00000,0x7c0070b,0x680000b,0x400128a,
-	0xfc01200,0xaa20048,0x680004c,0x6494208,0x9084208,0x340c20c,0x540830c,0xc780340,
-	0x609410c,0xc05b5c0,0x80c2301,0xc05b640,0x0000000,0x4000305,0xc05b480,0x80c2301,
-	0xc05b500,0x0000000,0x950914c,0x6094105,0xfc01200,0xaa24048,0x680004c,0x6494208,
-	0x9104208,0x340c20c,0x540830c,0x609410c,0xc780600,0x609410c,0xc05b080,0x80c2301,
-	0xc05b100,0x0000000,0x4000305,0xc05af40,0x80c2301,0xc05afc0,0x0000000,0x950914c,
-	0x6094105,0xc05adc0,0x80c2301,0xc05ae40,0x0000000,0x4000305,0xc05ac80,0x80c2301,
-	0xc05ad00,0x0000000,0x950914c,0x6094105,0x40012cb,0xb8cb28b,0xcc00000,0x0000000,
-	0x67f290b,0x901e30b,0xac0428c,0xb8fd28c,0x93c230b,0xbaec08c,0xcc00000,0x0000000,
-	0xc05c400,0x0000000,0x67f2a0b,0x901e30b,0xac0428c,0xb8fb28c,0x93c230b,0xbae408c,
-	0xcc00000,0x0000000,0x67f2a0b,0xa21804b,0x901e30b,0xb8fd28c,0xac0328c,0x93c230b,
-	0xa6e80cc,0xcc00000,0x0000000,0x69a0009,0x6c00789,0x680400a,0xc000bc0,0x6a0400b,
-	0x78000c9,0x63f2b09,0x7800109,0x63f2c09,0x7800289,0x63f2809,0x7800249,0x63f2709,
-	0x7801c09,0x63f2309,0x7801b89,0x7801bca,0x961024a,0x63f2209,0x7801c89,0x7801cca,
-	0x961024a,0x63f2109,0xcc00000,0x0000000,0x69a0009,0x6c00789,0x680400a,0xc000580,
-	0x6b0400b,0x67f2b09,0x7c000c9,0x67f2c09,0x7c00109,0x67f2809,0x7c00289,0x67f2709,
-	0x7c00249,0x67f2309,0x7c01c09,0x67f2209,0x7c01b89,0x9210249,0x7c01bc9,0x67f2109,
-	0x7c01c89,0x9210249,0x7c01cc9,0xcc00000,0x0000000,0x603520a,0x649ce0a,0x200a24a,
-	0x603510a,0x603500b,0x6435009,0x580f249,0xbef8049,0x0000000,0x6435309,0x900c249,
-	0xa6f8009,0x0000000,0xcc00000,0x0000000,0x0000000,0x0000000
+	0xaa1c008,0x6808008,0x78009c9,0x4001249,0x2009209,0x7801ac8,0xb403248,0xcc00000,
+	0x0000000,0x6808009,0x7801acf,0x78014cb,0xaa0c00b,0x680400b,0x680600b,0x700024a,
+	0x400040a,0x540328a,0x200a2ca,0x400128a,0x700028c,0x910130c,0xaa0c00c,0x400128a,
+	0x400228a,0x400130a,0x700028a,0x700030c,0x961028c,0x4000349,0x400134d,0xb4143cd,
+	0x700034e,0x400044e,0x540338e,0x200e2ce,0x400138e,0x700038c,0x910130c,0xaa0c00c,
+	0x400138e,0x400238e,0x400130e,0x700038e,0x700030c,0x961038c,0xb0f038a,0x0000000,
+	0x400028e,0xc7ffb40,0x4000411,0xc000100,0x78014cf,0xcc00000,0x0000000,0xaa0c00f,
+	0x680400b,0x680600b,0x5403390,0x200e2ce,0x400138e,0x700038c,0xbe0804c,0xa24830c,
+	0x9c0c0cc,0x9c0c08c,0x9c0c00c,0x740038c,0x440138e,0x700038c,0x481f30c,0xaa0c00f,
+	0x68000c8,0x6800108,0x680004a,0x340a30a,0x6bfffcc,0x300a30a,0x7000209,0x2809289,
+	0x7400209,0xcc00000,0x0000000,0x6809008,0x78001c9,0x4001249,0x2009209,0x7801b48,
+	0xb403248,0xcc00000,0x0000000,0x6809009,0x7801b4f,0x78014cb,0xaa0c00b,0x680400b,
+	0x680600b,0x700024a,0x400040a,0x540328a,0x200a2ca,0x400128a,0x700028c,0xa21804c,
+	0x0000000,0x4001249,0xb8f73c9,0xcc00000,0x0000000,0x910130c,0xaa0c00c,0x400128a,
+	0x400228a,0x400130a,0x700028a,0x700030c,0x961028c,0x4000349,0x400134d,0xb4153cd,
+	0x700034e,0x400044e,0x540338e,0x200e2ce,0x400138e,0x700038c,0xbee004c,0x910130c,
+	0xaa0c00c,0x400138e,0x400238e,0x400130e,0x700038e,0x700030c,0x961038c,0xb0ef38a,
+	0x0000000,0x400028e,0xc7ffb00,0x4000411,0xc000180,0x78014cf,0xaa08011,0xc7ff680,
+	0xcc00000,0x0000000,0x6800011,0xaa0c00f,0x680400b,0x680600b,0x5403390,0x200e2ce,
+	0x400138e,0x700038d,0x400030d,0x980d2cd,0x9c0d28d,0x9c0d0cd,0x9c0d08d,0x9c0d00d,
+	0x740038d,0xa21c30c,0x980d00d,0x740038d,0x6800051,0x440138e,0x700038c,0x481f30c,
+	0x94c240f,0x780070b,0x74002d0,0x40012cb,0x68006cc,0xb80330b,0x0000000,0x68002cb,
+	0x78006cc,0xa40c30b,0x0000000,0x649c70c,0xaa0c00c,0xc05dfc0,0x0000000,0x649c00c,
+	0xaa0c00c,0xc7ffe80,0x0000000,0xc05eec0,0x0000000,0xcc00000,0x7c0070b,0x680000b,
+	0x400128a,0xfc01200,0xaa20048,0x680004c,0x6494208,0x9084208,0x340c20c,0x540830c,
+	0xc780340,0x609410c,0xc05b580,0x80c2301,0xc05b600,0x0000000,0x4000305,0xc05b440,
+	0x80c2301,0xc05b4c0,0x0000000,0x950914c,0x6094105,0xfc01200,0xaa24048,0x680004c,
+	0x6494208,0x9104208,0x340c20c,0x540830c,0x609410c,0xc780600,0x609410c,0xc05b040,
+	0x80c2301,0xc05b0c0,0x0000000,0x4000305,0xc05af00,0x80c2301,0xc05af80,0x0000000,
+	0x950914c,0x6094105,0xc05ad80,0x80c2301,0xc05ae00,0x0000000,0x4000305,0xc05ac40,
+	0x80c2301,0xc05acc0,0x0000000,0x950914c,0x6094105,0x40012cb,0xb8cb28b,0xcc00000,
+	0x0000000,0x67f290b,0x901e30b,0xac0428c,0xb8fd28c,0x93c230b,0xbaec08c,0xcc00000,
+	0x0000000,0xc05c3c0,0x0000000,0x67f2a0b,0x901e30b,0xac0428c,0xb8fb28c,0x93c230b,
+	0xbae408c,0xcc00000,0x0000000,0x67f2a0b,0xa21804b,0x901e30b,0xb8fd28c,0xac0328c,
+	0x93c230b,0xa6e80cc,0xcc00000,0x0000000,0x69a0009,0x6c00789,0x680400a,0xc000bc0,
+	0x6a0400b,0x78000c9,0x63f2b09,0x7800109,0x63f2c09,0x7800289,0x63f2809,0x7800249,
+	0x63f2709,0x7801c09,0x63f2309,0x7801b89,0x7801bca,0x961024a,0x63f2209,0x7801c89,
+	0x7801cca,0x961024a,0x63f2109,0xcc00000,0x0000000,0x69a0009,0x6c00789,0x680400a,
+	0xc000580,0x6b0400b,0x67f2b09,0x7c000c9,0x67f2c09,0x7c00109,0x67f2809,0x7c00289,
+	0x67f2709,0x7c00249,0x67f2309,0x7c01c09,0x67f2209,0x7c01b89,0x9210249,0x7c01bc9,
+	0x67f2109,0x7c01c89,0x9210249,0x7c01cc9,0xcc00000,0x0000000,0x603520a,0x649ce0a,
+	0x200a24a,0x603510a,0x603500b,0x6435009,0x580f249,0xbef8049,0x0000000,0x6435309,
+	0x900c249,0xa6f8009,0x0000000,0xcc00000,0x0000000,0x0000000,0x0000000
 };
diff --git a/drivers/amlogic/amports/m8/ucode/h264_4k2k/h264slice_linux.h b/drivers/amlogic/amports/m8/ucode/h264_4k2k/h264slice_linux.h
index e38ffa650f9d..db6c43ac41aa 100755
--- a/drivers/amlogic/amports/m8/ucode/h264_4k2k/h264slice_linux.h
+++ b/drivers/amlogic/amports/m8/ucode/h264_4k2k/h264slice_linux.h
@@ -8,19 +8,19 @@ const u32 MicroCode[] __attribute__ ((aligned (8))) = {
 	0xc0012c0,0x0000000,0x6800008,0x60c2108,0xc001b00,0x0000000,0x80c0001,0x8030504,
 	0xc7ef300,0x0400000,0x6bfd98a,0x603040a,0x0400000,0x64c430a,0x580128a,0xbaf980a,
 	0x64c0008,0xbe3c048,0x0000000,0x0800000,0x6bffe8a,0x603040a,0xcc00000,0x0400000,
-	0xc780000,0xc780000,0xc780000,0x0000000,0xbef9008,0x0000000,0xc78c3c0,0x680000a,
+	0xc780000,0xc780000,0xc780000,0x0000000,0xbef9008,0x0000000,0xc78c440,0x680000a,
 	0xaa4c048,0xbeed208,0x683ffcb,0xaadc00b,0x44012cb,0x64e0f08,0x9003248,0x9063288,
 	0xb40324a,0x240a24a,0x400828a,0xba180ca,0xaedc0ca,0x80c3e00,0x64c3f08,0x9002208,
-	0xa6cc0c8,0xcb80024,0x0000000,0x649cd0a,0xa21600a,0x67f290a,0xa20c04a,0xc78be00,
-	0x0000000,0x680000a,0x7802048,0xaa18008,0xaa0c011,0x0000000,0x680004a,0xc78bc00,
+	0xa6cc0c8,0xcb80024,0x0000000,0x649cd0a,0xa21600a,0x67f290a,0xa20c04a,0xc78be80,
+	0x0000000,0x680000a,0x7802048,0xaa18008,0xaa0c011,0x0000000,0x680004a,0xc78bc80,
 	0x0000000,0x7800b08,0xaa14388,0x7801688,0xaa08088,0xc784b00,0xc7880c0,0xaa08088,
 	0xc783440,0xc787240,0x0000000,0x649c908,0x4001208,0x609c908,0x6800015,0x7c020d5,
 	0x7c02115,0x7c02155,0x7c02195,0x7c021d5,0x6803fc8,0x7c02248,0x6800008,0x7c02308,
 	0x7c02388,0x7c023c8,0x7c02408,0x7c02448,0x7802588,0x4001208,0x7c025c8,0x6800048,
 	0x60e0c08,0x7c02788,0x7c02608,0x6800008,0x7c027c8,0x68003c8,0x7c02648,0x6805c08,
-	0x60c2108,0x80c2170,0x6800088,0x7c02708,0xc0168c0,0x0000000,0xcc00000,0x6800016,
+	0x60c2108,0x80c2170,0x6800088,0x7c02708,0xc016940,0x0000000,0xcc00000,0x6800016,
 	0x78027cb,0xa6fc00b,0x0000000,0x6a0002b,0x6c007ab,0x690002a,0x649cd08,0xbe1a008,
-	0x6c007aa,0x6a0002b,0x6c00eeb,0x680002a,0x6c00eea,0xc016900,0x0000000,0xc016e00,
+	0x6c007aa,0x6a0002b,0x6c00eeb,0x680002a,0x6c00eea,0xc016980,0x0000000,0xc016e80,
 	0x0000000,0x6900009,0x649cd08,0xbe12008,0x6c000c9,0x6800009,0x6c00809,0x7801688,
 	0x649ce0a,0x2009289,0x5c0c289,0x6819d64,0xaa18088,0x6800009,0x68166e4,0xaa0c148,
 	0x6800049,0x6800089,0x7c02549,0x7801748,0x94c2248,0x60c0409,0x7c0268a,0x6800008,
@@ -28,13 +28,13 @@ const u32 MicroCode[] __attribute__ ((aligned (8))) = {
 	0x6490708,0x9808088,0x98080c8,0x6090708,0x6495108,0x98083c8,0x6095108,0x7c026cb,
 	0x7800b08,0x944220a,0x7c00b08,0xa640388,0x68000ca,0x6495108,0x940420a,0x9808648,
 	0x6095108,0x6490708,0x9808448,0x6090708,0x6498e08,0x9808788,0x6098e08,0x7801688,
-	0xaa0c088,0x6818d64,0x6814ee4,0xc00c280,0x0000000,0x7800d48,0xa610008,0x7801a08,
+	0xaa0c088,0x6818d64,0x6814ee4,0xc00c300,0x0000000,0x7800d48,0xa610008,0x7801a08,
 	0xc780b00,0x60c0a08,0xfc07200,0x80c2940,0x7801a08,0x9808188,0x98083c8,0x60c0a08,
-	0x9c083c8,0x9808388,0xc00c440,0x60c0a08,0x7802549,0x64c0a08,0x91c2208,0xa6f8008,
+	0x9c083c8,0x9808388,0xc00c4c0,0x60c0a08,0x7802549,0x64c0a08,0x91c2208,0xa6f8008,
 	0x780285b,0x6c0001b,0x680001c,0x6c0001c,0x680001d,0x6c0001d,0x680001e,0x6c0001e,
 	0x6bfffdf,0xa628009,0x7800b08,0x680030a,0xaa18388,0x7c0280a,0x680018a,0x7c0280a,
 	0xcc00000,0x60c0715,0xcc00000,0x680030a,0xaa18388,0x7c0280a,0x680018a,0x7c0280a,
-	0xcc00000,0x60c0715,0xcc00000,0x0000000,0xc00bbc0,0x80c0600,0x780285b,0x6c0001b,
+	0xcc00000,0x60c0715,0xcc00000,0x0000000,0xc00bc40,0x80c0600,0x780285b,0x6c0001b,
 	0x680001c,0x6c0001c,0x680001d,0x6c0001d,0x680001e,0x6c0001e,0x6bfffdf,0x7802549,
 	0xa628009,0x7800b08,0x680030a,0xaa18388,0x7c0280a,0x680018a,0x7c0280a,0xcc00000,
 	0x60c0715,0xcc00000,0x680030a,0xaa18388,0x7c0280a,0x680018a,0x7c0280a,0xcc00000,
@@ -87,131 +87,131 @@ const u32 MicroCode[] __attribute__ ((aligned (8))) = {
 	0x6a40009,0x6431e0a,0xbefc04a,0x6c00109,0x7800b0a,0xa66838a,0xa264055,0x780298b,
 	0xaa1c00b,0x780274b,0x0800000,0x780278a,0x400128a,0x7c0278a,0x0400000,0xb61408b,
 	0x0000000,0x80c2170,0xc780880,0x80c260e,0x683ffcb,0x44012cb,0xaa0c00b,0x78027ca,
-	0xa6f400a,0x780278a,0x440128a,0xc0095c0,0x7c0278a,0xc7805c0,0x8030580,0x78027ca,
+	0xa6f400a,0x780278a,0x440128a,0xc009640,0x7c0278a,0xc7805c0,0x8030580,0x78027ca,
 	0xa6fc00a,0x0000000,0x60e0509,0x7802749,0x680180a,0x9502289,0x60c210a,0x80c260e,
 	0x6800089,0x7c02348,0xba0c088,0x4001208,0x6800008,0x7c02308,0x78020c8,0x7c02208,
 	0x7802988,0x7c029c8,0x7c027c9,0x8030580,0x7802908,0xaa14725,0x4001208,0x7802109,
 	0xa20c049,0x0000000,0x7c02908,0x683ffc9,0x64c2308,0x9304208,0xaa2c008,0x0000000,
 	0x80c3e01,0x64c3f08,0x93e1208,0xaae4008,0xb6e0049,0x4401249,0x6bfffc9,0xc7f56c0,
-	0x7c02a89,0x64c2b08,0x60c2b08,0x780224e,0xba13fce,0x6800009,0xc781140,0x7c02249,
+	0x7c02a89,0x64c2b08,0x60c2b08,0x780224e,0xba13fce,0x6800009,0xc7810c0,0x7c02249,
 	0x6808009,0xba1070e,0x400028e,0x441c28a,0x680c009,0x54032ca,0x200b28b,0x20092c9,
 	0x740025f,0x4001249,0x921031b,0x740024c,0x4001249,0x740025b,0x4001249,0x740025c,
 	0x4001249,0x921031c,0x740024c,0x4001249,0x740025d,0x4001249,0x921031d,0x740024c,
-	0x4001249,0x740025e,0x4001249,0x921031e,0x740024c,0x7800a49,0xac09949,0x78020cb,
-	0xaa40725,0x400030b,0x780210b,0xc780340,0x942f2cc,0xc781540,0x0000000,0xa61000b,
-	0xaa14725,0x780210b,0xa20c04b,0xa6146ca,0x40012ce,0xb60c70e,0x680000b,0x680070b,
-	0x7c0224b,0xb012949,0xaa0800b,0xa64070b,0x780228b,0xa20c04b,0x6a0800c,0x6a0c00c,
-	0x649ce0b,0x200a2ea,0x78022cd,0x54092cd,0x200b28b,0x603510b,0x6803f0b,0x603520b,
-	0x603500c,0xc007200,0x0000000,0x7800b08,0xaa84388,0x78020c8,0x4001208,0x7c020c8,
-	0x7802149,0x4001249,0x7c02149,0x7800a49,0xb847248,0x6800008,0x7c020c8,0xc002b80,
+	0x4001249,0x740025e,0x4001249,0x921031e,0x740024c,0x7800a49,0xac07949,0x78020cb,
+	0xaa38725,0x400030b,0x780210b,0xc7802c0,0x942f2cc,0xa61000b,0xaa14725,0x780210b,
+	0xa20c04b,0xa6146ca,0x40012ce,0xb60c70e,0x680000b,0x680070b,0x7c0224b,0xb012949,
+	0xaa0800b,0xa64070b,0x780228b,0xa20c04b,0x6a0800c,0x6a0c00c,0x649ce0b,0x200a2ea,
+	0x78022cd,0x54092cd,0x200b28b,0x603510b,0x6803f0b,0x603520b,0x603500c,0xc007300,
+	0x0000000,0x7800b08,0xa610388,0x78020c8,0xc780e00,0x0000000,0x4001208,0x7c020c8,
+	0x7802149,0x4001249,0x7c02149,0x7800a49,0xb849248,0x6800008,0x7c020c8,0xc002c00,
 	0x0000000,0x7802109,0xae0c049,0x4401249,0x6800009,0x649cd0a,0xa21a00a,0x0000000,
 	0x67f410a,0x954a289,0xc780140,0x63f410a,0x67f400a,0x954a289,0x63f400a,0x7802109,
-	0x4001249,0x78026ca,0xb831289,0x7c02109,0x680004a,0xc002200,0x0000000,0xc0656c0,
-	0x0000000,0x649cd0a,0xa21e00a,0x67f290a,0x83f4100,0x68000c9,0x97c2289,0xc7801c0,
-	0x63f290a,0x83f4000,0x67f2a0a,0x68000c9,0x97c2289,0x63f2a0a,0x8032100,0x809ca01,
-	0xc7f34c0,0x6802ac3,0x7802109,0xbe10049,0x4001209,0xc780580,0x7c02108,0x4401209,
-	0x7c02108,0x78020c8,0x4001208,0x7c020c8,0x7802149,0x4001249,0x7c02149,0x7800a49,
-	0xb80b248,0x6800008,0x7c020c8,0x7802109,0x4002249,0x78026ca,0xb805289,0x7c02109,
-	0x6800008,0xc7ff4c0,0x7c02148,0x64c3b08,0x920c208,0xb20ca08,0x680204b,0x7c02a4b,
-	0x78020c8,0x9508548,0x780210a,0x940854a,0x7800a4a,0xb01494a,0x6808009,0xa628725,
-	0xc780a40,0x0000000,0x780210b,0xa20c04b,0x50012cb,0x4001208,0x5401208,0xc780a40,
-	0x940120b,0x4001208,0xa418288,0x780224a,0x7802108,0xa27c048,0x400220a,0xc780380,
-	0x6800008,0xaa7c725,0x780210b,0xa2bc04b,0x40012c8,0xa4ed28b,0xc780680,0x6800008,
-	0xaa14725,0x6800008,0x7802108,0x5001208,0x4801208,0xb60c70a,0x6808009,0x680c009,
-	0xc780400,0x0000000,0xa628048,0x400220a,0x7802108,0xbe1c048,0x400220a,0xc7ffd80,
-	0x6800048,0xaabc008,0x780224a,0x400120a,0xba10708,0xb6ace08,0x680c009,0x441c208,
-	0x5403288,0x200a20a,0x2009289,0x700024a,0x7c0288a,0x4001249,0x700024a,0x4001249,
-	0x7000257,0x96105ca,0x4001249,0x7000258,0x4001249,0x700024a,0x961060a,0x4001249,
-	0x7000259,0x4001249,0x700024a,0x961064a,0x4001249,0x700025a,0x4001249,0x700024a,
-	0x961068a,0x6bfda8a,0x603040a,0xcc00000,0x0400000,0x78027c8,0xa6fc008,0x0000000,
-	0x64c0008,0xa2f0048,0x64c3d08,0x580a208,0xbef80c8,0x6a00008,0x60c3d08,0x64c3d08,
-	0x580a208,0xbef80c8,0x0000000,0xcc00000,0x0000000,0x7801688,0xaa0c188,0xcc00000,
-	0x0000000,0x649cd08,0xa20e008,0xc7800c0,0x67f4008,0x67f4108,0x93e1248,0xaae0009,
-	0x9288248,0x7801a4a,0xa4f5289,0x914a208,0x7802589,0xb60c689,0x6800049,0x6800109,
-	0xb4ef248,0xc7ffc00,0x0000000,0x7801608,0xaa18008,0x7801688,0xa614088,0x0000000,
-	0x8098002,0x80980f0,0xc780a80,0x80c2400,0x64c2208,0x9305248,0x93a22c8,0x9205288,
-	0x92a2308,0x540230c,0x2c0b30b,0x9105388,0x91a2308,0x540430c,0x2c0b30b,0x90053c8,
-	0x90a2308,0x540630c,0x2c0b30b,0x7801688,0xa63c188,0x80c2408,0x64c2208,0x480330b,
-	0xaa340cc,0x0000000,0x480f2cb,0x9305388,0x93a2308,0x540430c,0x2c0b30b,0x92053c8,
-	0x92a2308,0x540630c,0x2c0b30b,0xc780280,0x0000000,0x48032cb,0x9305288,0x93a2308,
-	0x540230c,0x2c0b30b,0xc7800c0,0x0000000,0xc780600,0x5418249,0x609b309,0x649b309,
-	0x541828a,0x609b30a,0x649b30a,0x541838e,0x609b30e,0x649b30e,0x54183cf,0x609b30f,
-	0x649b30f,0x8098002,0x6bfffcc,0x541030c,0x6bfffcd,0x2c0d30d,0x609820d,0x480330b,
-	0xa6540cc,0x0000000,0xc7800c0,0x0000000,0xc7806c0,0x5410309,0x581030c,0x5410349,
-	0x2c0d30d,0x609810d,0x540430b,0x609800c,0xa813289,0x0000000,0x541030a,0x581030c,
-	0x541034a,0x2c0d30d,0x609820d,0xc780300,0x0000000,0x5410309,0x581030c,0x541034a,
-	0x2c0d30d,0x609810d,0x540430b,0x4c0430c,0x609800c,0xc7800c0,0x0000000,0xc780380,
-	0x480330b,0x541830c,0x2c0c24c,0x483034b,0x541434d,0x2c0d38d,0xa80734c,0x0000000,
-	0x541030e,0x581030c,0x541034f,0x2c0d30d,0x609820d,0x7800b0c,0xa60c38c,0x6800725,
-	0x5801965,0x6bfffcc,0x680001b,0x7802857,0x6800018,0x680001c,0x6800019,0x680001d,
-	0x680001a,0x680001e,0x4000817,0x4000858,0x4000899,0x40008da,0x680800b,0x680070f,
-	0x74002cc,0x40012cb,0x74002db,0x40012cb,0x74002d7,0x40012cb,0x74002d8,0x40012cb,
-	0x74002dc,0x40012cb,0x74002d9,0x40012cb,0x74002dd,0x40012cb,0x74002da,0x40012cb,
-	0x74002de,0xd07fbcf,0x40012cb,0x7c0288c,0x7c028cc,0x961030c,0x80c0700,0x60c270c,
-	0x96105db,0x60c0217,0x961061c,0x780254f,0xaa1800f,0x60c0218,0x961065d,0x60c0219,
-	0x961069e,0x60c021a,0x80c0701,0x60c270c,0x60c0217,0xaa1000f,0x60c0218,0x60c0219,
-	0x60c021a,0x7800a4f,0xb00894f,0x649ce09,0x200826a,0x6035108,0x6803f08,0x6035208,
-	0x6a08008,0x6035008,0x78020c8,0xa60c008,0x6803fc8,0x7c02248,0x6800008,0x7c02908,
-	0xac0b94f,0x7802248,0xb613fc8,0xba0c708,0x441c208,0x7c02248,0x6435008,0x580f208,
-	0xbef8048,0xcc00000,0x0000000,0x6435008,0x580f208,0xbef8048,0x0000000,0x6435308,
-	0x900c208,0xa6f8008,0x0000000,0x649ce09,0x200826a,0x6035108,0x6803f08,0x6035208,
-	0x6b0c008,0x6035008,0x5401225,0xac0520f,0x6800088,0x7c02288,0xc7ff8c0,0x7c022c8,
-	0x681000a,0x20092aa,0x649ce0a,0x2009289,0x54012a5,0x200a94a,0x680008b,0x7c0228b,
-	0x68000cb,0x6435008,0x580f208,0xbef8048,0x6803f08,0x6035109,0x6035208,0x6a08008,
-	0x6035008,0xac0328f,0xc7ff3c0,0x7c022cb,0x6808008,0x2009209,0x200a94a,0xc7ffc80,
-	0x40012cb,0x400134d,0x480f34d,0x7c022cd,0x980c38c,0x780228d,0x54092cd,0x200ba8b,
-	0x649ce0a,0x200b28b,0x400134d,0x480f34d,0x7c0228d,0x643500d,0x580f34d,0xbef804d,
-	0x0000000,0x643530d,0x900c34d,0xa6f800d,0x0000000,0x603510b,0x6803f0b,0x603520b,
-	0xc7fed80,0x603500c,0x780230c,0xa60c00c,0x440120c,0x6800088,0xaa14008,0x6a01009,
-	0xaa0c048,0x6a22009,0x6a40009,0x6c00109,0x60e0509,0x7c02348,0x7802749,0x680180a,
-	0x9502289,0x60c210a,0x80c260e,0x680004a,0x7c0294a,0x78020c9,0x7c02209,0x7802989,
-	0x7c029c9,0x6800089,0xcc00000,0x7c027c9,0xcc00000,0x0400000,0x64e1226,0x91e19a6,
-	0xbef0066,0x78027e6,0xaa480a6,0xc782b40,0x6800027,0x6c04027,0x7802969,0x97c19e9,
-	0x60e1227,0x7802127,0xa210067,0x40005ab,0x6900016,0x2016ad6,0x649ce26,0x2016996,
-	0x6800026,0x7c02766,0xc7824c0,0x6800126,0x7802767,0xaa080a7,0xc7812c0,0x78025e8,
-	0xaeb00a8,0x7802969,0xaa50725,0x7802226,0x54069a6,0x7802128,0x5801a28,0xbe10068,
-	0x40009eb,0x6900027,0x2027ae7,0x649ce28,0x2027a27,0x20269e6,0x44409a6,0x60e1326,
-	0xaa48029,0x40c05a6,0x6805c28,0x60c2128,0xc780380,0x4040596,0x54059a6,0x7802128,
-	0xbe10068,0x40009eb,0x6900027,0x2027ae7,0x649ce28,0x2027a27,0x20269e6,0x44209a6,
-	0x60e1326,0x40605a6,0x7802368,0xaa14028,0x6a2c227,0xaa0c068,0x6a2c027,0x6a2c127,
-	0xaa10029,0x6c04027,0x68003e6,0x95069e6,0x97c19e9,0x60e1227,0x6800026,0x7c02766,
-	0x6800126,0xc781cc0,0x7c027e6,0x78023a7,0x78023e8,0x96109e8,0x7802828,0x2427a27,
-	0x2427a27,0x7802969,0xaa0c029,0x2427a27,0x2427a27,0x78026a6,0x54099a6,0x20269e6,
-	0x54039e6,0x60e1327,0x7802368,0xaa34028,0x6a44227,0xaa2c068,0x6a44027,0xc780240,
-	0x6a44127,0xa64c0e7,0x78027a6,0x64e0c28,0x9010a28,0xb8e6a26,0xcc00000,0x0400000,
-	0xaa10029,0x6c0c027,0x68005e6,0x95069e6,0x97c19e9,0x60e1227,0x6800016,0x6800026,
-	0x7c02766,0x6800166,0xc781280,0x7c027e6,0x7802627,0xaa1c027,0x44019e7,0x7c02627,
-	0x78025e7,0x44019e7,0xc780f00,0x7c025e7,0x7802427,0x7c024a7,0x7802466,0x7c024e6,
-	0x96109e6,0x78026a6,0x54099a6,0x20269e6,0x7802828,0x2027a27,0x7c02427,0x92109e7,
-	0x7c02467,0x54039e6,0x60e1327,0x7802368,0xaa14028,0x6a16227,0xaa0c068,0x6a16027,
-	0x6a16127,0x78029e8,0xaa30028,0x78027a6,0x64e0c28,0x9010a28,0xb806a26,0x78024a8,
-	0x7c02428,0x78024e8,0xc7fd880,0x7c02468,0x40019a6,0x7c027a6,0x7c02527,0x6c00027,
-	0x60e1227,0x6800066,0xc780680,0x7c027e6,0xba58126,0x7802967,0xa608027,0xc7ff340,
-	0x78027a7,0x40019e7,0x7c027a7,0xaa0c126,0x6800027,0x80c2170,0xc780300,0x7c02967,
-	0xa6d0066,0x78025e7,0xaa30027,0x44019e7,0xb228067,0x7c025e7,0x7802726,0xaa0c0e6,
-	0x0000000,0x80c2170,0x6800026,0x7c027e6,0xcc00000,0x0400000,0xc780540,0x0000000,
-	0xa610026,0x40005ab,0x6900016,0x2016ad6,0x649ce28,0xc780ac0,0x2016a16,0xaa0c725,
-	0x90a8996,0x90c7996,0x7800a68,0xb825a26,0xa8f4a26,0x91c1996,0xa62c026,0x40005ab,
-	0x6900016,0xc780200,0x2016ad6,0x78023a7,0x78023e8,0xaa6c016,0x96109e8,0xc7ffc00,
-	0x0000000,0x649ce28,0x2016a16,0x78026a6,0x54099a6,0x7802828,0x2427a27,0x20269e6,
-	0x54039e6,0x60e1327,0x7802526,0x90049e6,0xaa14027,0x6a14226,0xaa0c127,0x6a14026,
-	0x6a14126,0x6c08026,0x60e0d16,0xaa0c725,0x4020596,0x4020596,0xc7ff380,0x60e1226,
-	0x78026a6,0x54099a6,0x20269e6,0x7802828,0x2027a27,0x7c023a7,0x92109e7,0x7c023e7,
-	0x54039e6,0x60e1327,0x7802526,0xa618016,0x9c261e6,0x60e1226,0x68000e6,0xc7fef40,
-	0x7c027e6,0x6c08026,0x60e0d16,0xaae8725,0x4020596,0xc7ffe00,0x4020596,0x64e120a,
-	0x91e128a,0xbef804a,0x64e000a,0x64e030b,0x64e0e0c,0x64e0c0d,0x680100e,0x609840e,
-	0x8098400,0x680020e,0xd00000e,0x0000000,0x60e000a,0x60e030b,0x60e0e0c,0xcc00000,
-	0x60e0c0d,0xc000d00,0x0000000,0x681010a,0x6c3474a,0x609070a,0x6490b0a,0x980a00a,
-	0x980a0ca,0x6090b0a,0x9c0a00a,0x9c0a0ca,0x6090b0a,0x649ce0b,0x200a2eb,0x609440a,
-	0x690000a,0x200aaca,0x649ce0b,0x200a2ca,0x609450a,0xcc00000,0x0000000,0xc000b40,
-	0x0000000,0x8095007,0x8095000,0x6800049,0x7800a4b,0x68002ca,0xb00328b,0x0000000,
-	0x6800009,0x6498e0b,0x97c12c9,0x6098e0b,0x6497f09,0x68000cb,0x970224b,0x6097f09,
-	0x6820889,0x6c00209,0x6095109,0x7800a4b,0xb20c2cb,0x680040b,0x6800c0b,0x6495109,
-	0x970624b,0x9809649,0x6095109,0xcc00000,0x0000000,0x683ffc9,0x649090a,0xa21004a,
-	0xaa0c009,0xc7fff40,0x4401249,0x6490b0a,0x980a00a,0x980a0ca,0x6090b0a,0x9c0a00a,
-	0x9c0a0ca,0x6090b0a,0xcc00000,0x0000000,0x683ffca,0x649530b,0x90012cb,0x649bb09,
-	0x920c249,0x20092c9,0xaa10009,0xaa0c00a,0xc7ffe40,0x440128a,0xcc00000,0x0000000,
-	0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,
+	0x4001249,0x78026ca,0xb404289,0x7c02109,0xc780c40,0x0000000,0x680004a,0xc002200,
+	0x0000000,0xc065640,0x0000000,0x649cd0a,0xa21e00a,0x67f290a,0x83f4100,0x68000c9,
+	0x97c2289,0xc7801c0,0x63f290a,0x83f4000,0x67f2a0a,0x68000c9,0x97c2289,0x63f2a0a,
+	0x8032100,0x809ca01,0xc7f3440,0x6802ac3,0x7802109,0xbe10049,0x4001209,0xc780580,
+	0x7c02108,0x4401209,0x7c02108,0x78020c8,0x4001208,0x7c020c8,0x7802149,0x4001249,
+	0x7c02149,0x7800a49,0xb80b248,0x6800008,0x7c020c8,0x7802109,0x4002249,0x78026ca,
+	0xb805289,0x7c02109,0x6800008,0xc7ff4c0,0x7c02148,0x64c3b08,0x920c208,0xb20ca08,
+	0x680204b,0x7c02a4b,0x78020c8,0x9508548,0x780210a,0x940854a,0x7800a4a,0xb01494a,
+	0x6808009,0xa628725,0xc780a40,0x0000000,0x780210b,0xa20c04b,0x50012cb,0x4001208,
+	0x5401208,0xc780a40,0x940120b,0x4001208,0xa418288,0x780224a,0x7802108,0xa27c048,
+	0x400220a,0xc780380,0x6800008,0xaa7c725,0x780210b,0xa2bc04b,0x40012c8,0xa4ed28b,
+	0xc780680,0x6800008,0xaa14725,0x6800008,0x7802108,0x5001208,0x4801208,0xb60c70a,
+	0x6808009,0x680c009,0xc780400,0x0000000,0xa628048,0x400220a,0x7802108,0xbe1c048,
+	0x400220a,0xc7ffd80,0x6800048,0xaabc008,0x780224a,0x400120a,0xba10708,0xb6ace08,
+	0x680c009,0x441c208,0x5403288,0x200a20a,0x2009289,0x700024a,0x7c0288a,0x4001249,
+	0x700024a,0x4001249,0x7000257,0x96105ca,0x4001249,0x7000258,0x4001249,0x700024a,
+	0x961060a,0x4001249,0x7000259,0x4001249,0x700024a,0x961064a,0x4001249,0x700025a,
+	0x4001249,0x700024a,0x961068a,0x6bfda8a,0x603040a,0xcc00000,0x0400000,0x78027c8,
+	0xa6fc008,0x0000000,0x64c0008,0xa2f0048,0x64c3d08,0x580a208,0xbef80c8,0x6a00008,
+	0x60c3d08,0x64c3d08,0x580a208,0xbef80c8,0x0000000,0xcc00000,0x0000000,0x7801688,
+	0xaa0c188,0xcc00000,0x0000000,0x649cd08,0xa20e008,0xc7800c0,0x67f4008,0x67f4108,
+	0x93e1248,0xaae0009,0x9288248,0x7801a4a,0xa4f5289,0x914a208,0x7802589,0xb60c689,
+	0x6800049,0x6800109,0xb4ef248,0xc7ffc00,0x0000000,0x7801608,0xaa18008,0x7801688,
+	0xa614088,0x0000000,0x8098002,0x80980f0,0xc780a80,0x80c2400,0x64c2208,0x9305248,
+	0x93a22c8,0x9205288,0x92a2308,0x540230c,0x2c0b30b,0x9105388,0x91a2308,0x540430c,
+	0x2c0b30b,0x90053c8,0x90a2308,0x540630c,0x2c0b30b,0x7801688,0xa63c188,0x80c2408,
+	0x64c2208,0x480330b,0xaa340cc,0x0000000,0x480f2cb,0x9305388,0x93a2308,0x540430c,
+	0x2c0b30b,0x92053c8,0x92a2308,0x540630c,0x2c0b30b,0xc780280,0x0000000,0x48032cb,
+	0x9305288,0x93a2308,0x540230c,0x2c0b30b,0xc7800c0,0x0000000,0xc780600,0x5418249,
+	0x609b309,0x649b309,0x541828a,0x609b30a,0x649b30a,0x541838e,0x609b30e,0x649b30e,
+	0x54183cf,0x609b30f,0x649b30f,0x8098002,0x6bfffcc,0x541030c,0x6bfffcd,0x2c0d30d,
+	0x609820d,0x480330b,0xa6540cc,0x0000000,0xc7800c0,0x0000000,0xc7806c0,0x5410309,
+	0x581030c,0x5410349,0x2c0d30d,0x609810d,0x540430b,0x609800c,0xa813289,0x0000000,
+	0x541030a,0x581030c,0x541034a,0x2c0d30d,0x609820d,0xc780300,0x0000000,0x5410309,
+	0x581030c,0x541034a,0x2c0d30d,0x609810d,0x540430b,0x4c0430c,0x609800c,0xc7800c0,
+	0x0000000,0xc780380,0x480330b,0x541830c,0x2c0c24c,0x483034b,0x541434d,0x2c0d38d,
+	0xa80734c,0x0000000,0x541030e,0x581030c,0x541034f,0x2c0d30d,0x609820d,0x7800b0c,
+	0xa60c38c,0x6800725,0x5801965,0x6bfffcc,0x680001b,0x7802857,0x6800018,0x680001c,
+	0x6800019,0x680001d,0x680001a,0x680001e,0x4000817,0x4000858,0x4000899,0x40008da,
+	0x680800b,0x680070f,0x74002cc,0x40012cb,0x74002db,0x40012cb,0x74002d7,0x40012cb,
+	0x74002d8,0x40012cb,0x74002dc,0x40012cb,0x74002d9,0x40012cb,0x74002dd,0x40012cb,
+	0x74002da,0x40012cb,0x74002de,0xd07fbcf,0x40012cb,0x7c0288c,0x7c028cc,0x961030c,
+	0x80c0700,0x60c270c,0x96105db,0x60c0217,0x961061c,0x780254f,0xaa1800f,0x60c0218,
+	0x961065d,0x60c0219,0x961069e,0x60c021a,0x80c0701,0x60c270c,0x60c0217,0xaa1000f,
+	0x60c0218,0x60c0219,0x60c021a,0x7800a4f,0xb00894f,0x649ce09,0x200826a,0x6035108,
+	0x6803f08,0x6035208,0x6a08008,0x6035008,0x78020c8,0xa60c008,0x6803fc8,0x7c02248,
+	0x6800008,0x7c02908,0xac0b94f,0x7802248,0xb613fc8,0xba0c708,0x441c208,0x7c02248,
+	0x6435008,0x580f208,0xbef8048,0xcc00000,0x0000000,0x6435008,0x580f208,0xbef8048,
+	0x0000000,0x6435308,0x900c208,0xa6f8008,0x0000000,0x649ce09,0x200826a,0x6035108,
+	0x6803f08,0x6035208,0x6b0c008,0x6035008,0x5401225,0xac0520f,0x6800088,0x7c02288,
+	0xc7ff8c0,0x7c022c8,0x681000a,0x20092aa,0x649ce0a,0x2009289,0x54012a5,0x200a94a,
+	0x680008b,0x7c0228b,0x68000cb,0x6435008,0x580f208,0xbef8048,0x6803f08,0x6035109,
+	0x6035208,0x6a08008,0x6035008,0xac0328f,0xc7ff3c0,0x7c022cb,0x6808008,0x2009209,
+	0x200a94a,0xc7ffc80,0x40012cb,0x400134d,0x480f34d,0x7c022cd,0x980c38c,0x780228d,
+	0x54092cd,0x200ba8b,0x649ce0a,0x200b28b,0x400134d,0x480f34d,0x7c0228d,0x643500d,
+	0x580f34d,0xbef804d,0x0000000,0x643530d,0x900c34d,0xa6f800d,0x0000000,0x603510b,
+	0x6803f0b,0x603520b,0xc7fed80,0x603500c,0x780230c,0xa60c00c,0x440120c,0x6800088,
+	0xaa14008,0x6a01009,0xaa0c048,0x6a22009,0x6a40009,0x6c00109,0x60e0509,0x7c02348,
+	0x7802749,0x680180a,0x9502289,0x60c210a,0x80c260e,0x680004a,0x7c0294a,0x78020c9,
+	0x7c02209,0x7802989,0x7c029c9,0x6800089,0xcc00000,0x7c027c9,0xcc00000,0x0400000,
+	0x64e1226,0x91e19a6,0xbef0066,0x78027e6,0xaa480a6,0xc782b40,0x6800027,0x6c04027,
+	0x7802969,0x97c19e9,0x60e1227,0x7802127,0xa210067,0x40005ab,0x6900016,0x2016ad6,
+	0x649ce26,0x2016996,0x6800026,0x7c02766,0xc7824c0,0x6800126,0x7802767,0xaa080a7,
+	0xc7812c0,0x78025e8,0xaeb00a8,0x7802969,0xaa50725,0x7802226,0x54069a6,0x7802128,
+	0x5801a28,0xbe10068,0x40009eb,0x6900027,0x2027ae7,0x649ce28,0x2027a27,0x20269e6,
+	0x44409a6,0x60e1326,0xaa48029,0x40c05a6,0x6805c28,0x60c2128,0xc780380,0x4040596,
+	0x54059a6,0x7802128,0xbe10068,0x40009eb,0x6900027,0x2027ae7,0x649ce28,0x2027a27,
+	0x20269e6,0x44209a6,0x60e1326,0x40605a6,0x7802368,0xaa14028,0x6a2c227,0xaa0c068,
+	0x6a2c027,0x6a2c127,0xaa10029,0x6c04027,0x68003e6,0x95069e6,0x97c19e9,0x60e1227,
+	0x6800026,0x7c02766,0x6800126,0xc781cc0,0x7c027e6,0x78023a7,0x78023e8,0x96109e8,
+	0x7802828,0x2427a27,0x2427a27,0x7802969,0xaa0c029,0x2427a27,0x2427a27,0x78026a6,
+	0x54099a6,0x20269e6,0x54039e6,0x60e1327,0x7802368,0xaa34028,0x6a44227,0xaa2c068,
+	0x6a44027,0xc780240,0x6a44127,0xa64c0e7,0x78027a6,0x64e0c28,0x9010a28,0xb8e6a26,
+	0xcc00000,0x0400000,0xaa10029,0x6c0c027,0x68005e6,0x95069e6,0x97c19e9,0x60e1227,
+	0x6800016,0x6800026,0x7c02766,0x6800166,0xc781280,0x7c027e6,0x7802627,0xaa1c027,
+	0x44019e7,0x7c02627,0x78025e7,0x44019e7,0xc780f00,0x7c025e7,0x7802427,0x7c024a7,
+	0x7802466,0x7c024e6,0x96109e6,0x78026a6,0x54099a6,0x20269e6,0x7802828,0x2027a27,
+	0x7c02427,0x92109e7,0x7c02467,0x54039e6,0x60e1327,0x7802368,0xaa14028,0x6a16227,
+	0xaa0c068,0x6a16027,0x6a16127,0x78029e8,0xaa30028,0x78027a6,0x64e0c28,0x9010a28,
+	0xb806a26,0x78024a8,0x7c02428,0x78024e8,0xc7fd880,0x7c02468,0x40019a6,0x7c027a6,
+	0x7c02527,0x6c00027,0x60e1227,0x6800066,0xc780680,0x7c027e6,0xba58126,0x7802967,
+	0xa608027,0xc7ff340,0x78027a7,0x40019e7,0x7c027a7,0xaa0c126,0x6800027,0x80c2170,
+	0xc780300,0x7c02967,0xa6d0066,0x78025e7,0xaa30027,0x44019e7,0xb228067,0x7c025e7,
+	0x7802726,0xaa0c0e6,0x0000000,0x80c2170,0x6800026,0x7c027e6,0xcc00000,0x0400000,
+	0xc780540,0x0000000,0xa610026,0x40005ab,0x6900016,0x2016ad6,0x649ce28,0xc780ac0,
+	0x2016a16,0xaa0c725,0x90a8996,0x90c7996,0x7800a68,0xb825a26,0xa8f4a26,0x91c1996,
+	0xa62c026,0x40005ab,0x6900016,0xc780200,0x2016ad6,0x78023a7,0x78023e8,0xaa6c016,
+	0x96109e8,0xc7ffc00,0x0000000,0x649ce28,0x2016a16,0x78026a6,0x54099a6,0x7802828,
+	0x2427a27,0x20269e6,0x54039e6,0x60e1327,0x7802526,0x90049e6,0xaa14027,0x6a14226,
+	0xaa0c127,0x6a14026,0x6a14126,0x6c08026,0x60e0d16,0xaa0c725,0x4020596,0x4020596,
+	0xc7ff380,0x60e1226,0x78026a6,0x54099a6,0x20269e6,0x7802828,0x2027a27,0x7c023a7,
+	0x92109e7,0x7c023e7,0x54039e6,0x60e1327,0x7802526,0xa618016,0x9c261e6,0x60e1226,
+	0x68000e6,0xc7fef40,0x7c027e6,0x6c08026,0x60e0d16,0xaae8725,0x4020596,0xc7ffe00,
+	0x4020596,0x64e120a,0x91e128a,0xbef804a,0x64e000a,0x64e030b,0x64e0e0c,0x64e0c0d,
+	0x680100e,0x609840e,0x8098400,0x680020e,0xd00000e,0x0000000,0x60e000a,0x60e030b,
+	0x60e0e0c,0xcc00000,0x60e0c0d,0xc000d00,0x0000000,0x681010a,0x6c3474a,0x609070a,
+	0x6490b0a,0x980a00a,0x980a0ca,0x6090b0a,0x9c0a00a,0x9c0a0ca,0x6090b0a,0x649ce0b,
+	0x200a2eb,0x609440a,0x690000a,0x200aaca,0x649ce0b,0x200a2ca,0x609450a,0xcc00000,
+	0x0000000,0xc000b40,0x0000000,0x8095007,0x8095000,0x6800049,0x7800a4b,0x68002ca,
+	0xb00328b,0x0000000,0x6800009,0x6498e0b,0x97c12c9,0x6098e0b,0x6497f09,0x68000cb,
+	0x970224b,0x6097f09,0x6820889,0x6c00209,0x6095109,0x7800a4b,0xb20c2cb,0x680040b,
+	0x6800c0b,0x6495109,0x970624b,0x9809649,0x6095109,0xcc00000,0x0000000,0x683ffc9,
+	0x649090a,0xa21004a,0xaa0c009,0xc7fff40,0x4401249,0x6490b0a,0x980a00a,0x980a0ca,
+	0x6090b0a,0x9c0a00a,0x9c0a0ca,0x6090b0a,0xcc00000,0x0000000,0x683ffca,0x649530b,
+	0x90012cb,0x649bb09,0x920c249,0x20092c9,0xaa10009,0xaa0c00a,0xc7ffe40,0x440128a,
+	0xcc00000,0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,
 	0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,
 	0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,
 	0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,0x0000000,
diff --git a/drivers/amlogic/amports/vh264_4k2k.c b/drivers/amlogic/amports/vh264_4k2k.c
index 4ffc83c2de64..d09ed585bce4 100755
--- a/drivers/amlogic/amports/vh264_4k2k.c
+++ b/drivers/amlogic/amports/vh264_4k2k.c
@@ -753,6 +753,22 @@ printk("M->S,[%d] %s = 0x%x\n",ret, reg_name[ret], READ_VREG(MAILBOX_DATA_1));
                 printk("REC_CANVAS_ADDR = 0x%x\n", READ_VREG(MAILBOX_DATA_1));
                 WRITE_VREG(MAILBOX_COMMAND, CMD_FINISHED);
                 break;
+            case 4:
+                printk("after DPB_MMCO\n");
+                WRITE_VREG(MAILBOX_COMMAND, CMD_FINISHED);
+                break;
+            case 5:
+                printk("MBY = 0x%x, S_MBXY = 0x%x\n", READ_VREG(MAILBOX_DATA_1), READ_VREG(0x2c07));
+                WRITE_VREG(MAILBOX_COMMAND, CMD_FINISHED);
+                break;
+            case 6:
+                printk("after FIFO_OUT_FRAME\n");
+                WRITE_VREG(MAILBOX_COMMAND, CMD_FINISHED);
+                break;
+            case 7:
+                printk("after RELEASE_EXCEED_REF_BUFF\n");
+                WRITE_VREG(MAILBOX_COMMAND, CMD_FINISHED);
+                break;
             case 0x5a:
                 printk("\n");
                 break;
@@ -790,6 +806,22 @@ static irqreturn_t vh264_4k2k_vdec2_isr(int irq, void *dev_id)
                 printk("REC_CANVAS_ADDR = 0x%x\n", READ_VREG(VDEC2_MAILBOX_DATA_1));
                 WRITE_VREG(VDEC2_MAILBOX_COMMAND, CMD_FINISHED);
                 break;
+            case 4:
+                printk("after DPB_MMCO\n");
+                WRITE_VREG(VDEC2_MAILBOX_COMMAND, CMD_FINISHED);
+                break;
+            case 5:
+                printk("MBY = 0x%x, M/S_MBXY = 0x%x-0x%x\n", READ_VREG(VDEC2_MAILBOX_DATA_1), READ_VREG(0xc07), READ_VREG(0x2c07));
+                WRITE_VREG(VDEC2_MAILBOX_COMMAND, CMD_FINISHED);
+                break;
+            case 6:
+                printk("after FIFO_OUT_FRAME\n");
+                WRITE_VREG(VDEC2_MAILBOX_COMMAND, CMD_FINISHED);
+                break;
+            case 7:
+                printk("after RELEASE_EXCEED_REF_BUFF\n");
+                WRITE_VREG(VDEC2_MAILBOX_COMMAND, CMD_FINISHED);
+                break;
             case 0x5a:
                 printk("\n");
                 break;
@@ -1069,6 +1101,9 @@ static void vh264_4k2k_prot_init(void)
     SET_VREG_MASK(MDEC_PIC_DC_CTRL, 1<<17);
     SET_VREG_MASK(VDEC2_MDEC_PIC_DC_CTRL, 1<<17);
 #endif
+
+    WRITE_VREG(MDEC_PIC_DC_THRESH, 0x404038aa);
+    WRITE_VREG(VDEC2_MDEC_PIC_DC_THRESH, 0x404038aa);
 }
 
 static void vh264_4k2k_local_init(void)
-- 
2.19.0

