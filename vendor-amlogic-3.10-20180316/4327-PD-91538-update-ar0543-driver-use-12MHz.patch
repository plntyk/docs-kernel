From f06136681baf062ef661efa084a49c5cc156aa7c Mon Sep 17 00:00:00 2001
From: "jiyu.yang" <jiyu.yang@amlogic.com>
Date: Wed, 11 Jun 2014 17:06:28 +0800
Subject: [PATCH 4327/5965] PD#91538 update ar0543 driver use 12MHz

this commit also fixed followed.
PD#92183 jiwei.chen@amlogic.com
PD#92185 Jiyu.Yang@amlogic.com
PD#91979 journ.zhou@amlogic.com
PD#91296 Lizhi.Wang@amlogic.com
PD#91210 simon.zheng@amlogic.com
PD#91530 simon.zheng@amlogic.com
PD#91538 simon.zheng@amlogic.com
PD#91544 simon.zheng@amlogic.com
PD#92311 Yingwei.Long@amlogic.com
PD#91936 zhenfei.li@amlogic.com
PD#91804 jiwei.chen@amlogic.com
PD#91557 simon.zheng@amlogic.com
---
 drivers/amlogic/camera/ar0543.c        | 2704 +++++++++++++++++-------
 include/linux/amlogic/tvin/tvin_v4l2.h |    1 +
 2 files changed, 1987 insertions(+), 718 deletions(-)

diff --git a/drivers/amlogic/camera/ar0543.c b/drivers/amlogic/camera/ar0543.c
index 82dd030cc02a..9f4bbdd5e285 100755
--- a/drivers/amlogic/camera/ar0543.c
+++ b/drivers/amlogic/camera/ar0543.c
@@ -33,6 +33,7 @@
 #include <media/v4l2-device.h>
 #include <media/v4l2-ioctl.h>
 #include <linux/wakelock.h>
+#include <linux/vmalloc.h>
 
 #include <linux/i2c.h>
 #include <media/v4l2-chip-ident.h>
@@ -60,7 +61,7 @@
 #define MAGIC_RE_MEM 0x123039dc
 #define AR0543_RES0_CANVAS_INDEX CAMERA_USER_CANVAS_INDEX
 
-
+static int capture_proc = 0;
 /* Wake up at about 30 fps */
 #define WAKE_NUMERATOR 30
 #define WAKE_DENOMINATOR 1001
@@ -117,7 +118,8 @@ static int t_index = -1;
 static int dest_hactive = 640;
 static int dest_vactive = 480;
 static bool bDoingAutoFocusMode = false;
-static configure_t *cf;
+static configure_t *cf = NULL;
+static cam_parameter_t *g_cp = NULL;
 /* supported controls */
 static struct v4l2_queryctrl ar0543_qctrl[] = {
 	{
@@ -209,7 +211,7 @@ static struct v4l2_queryctrl ar0543_qctrl[] = {
 		.maximum       = FLASHLIGHT_TORCH,
 		.step          = 0x1,
 		.default_value = FLASHLIGHT_OFF,
-		.flags         = V4L2_CTRL_FLAG_SLIDER,
+		.flags         = V4L2_CTRL_FLAG_DISABLED,
 	},{
 		.id            = V4L2_CID_ZOOM_ABSOLUTE,
 		.type          = V4L2_CTRL_TYPE_INTEGER,
@@ -612,6 +614,8 @@ struct ar0543_device {
 	
 	struct vdin_v4l2_ops_s *vops;
 	
+    unsigned int            is_vdin_start;
+
 	fe_arg_t fe_arg;
 	
 	vdin_arg_t vdin_arg;
@@ -672,112 +676,376 @@ static cam_i2c_msg_t AR0543_preview_VGA_script[] = {
 };
 
 static cam_i2c_msg_t AR0543_VGA_script_mipi[] = {
-// This file was generated by: AR0542 (A-5141) Register Wizard
-//   Version: 4.5.13.36518    Build Date: 07/08/2013
-// 
-// [PLL PARAMETERS]
-// 
-// Bypass PLL: Unchecked
-// Input Frequency: 24.000
-// Use Min Freq.: Unchecked
-// Target VT Frequency: 96.000
-// Target op_sys_clk Frequency: Unspecified
-// 
-// Target PLL VT Frequency: 96 MHz
-// Target PLL OP Frequency: 96 MHz
-// MT9P017 Input Clock Frequency: 24 MHz
-// MT9P017 VT (Internal) Pixel Clock Frequency: 96 MHz
-// MT9P017 OP (Output) Pixel Clock Frequency: 48 MHz
-// pre_pll_clk_div = 2
-// pll_multiplier = 40
-// vt_sys_clk_div = 1
-// vt_pix_clk_div = 5
-// op_sys_clk_div = 1
-// op_pix_clk_div = 10
-// ip_clk = 12 MHz
-// op_clk = 480 MHz
-// op_sys_clk = 480 MHz
-// 
-// [SENSOR PARAMETERS]
-// 
-// Requested Frames Per Second: 30.000
-// Output Columns: 640
-// Output Rows: 480
-// Use Binning: Checked
-// Allow Skipping: Unchecked
-// Blanking Computation: HB Max then VB
-// 
-// Max Frame Time: 33.3333 msec
-// Max Frame Clocks: 3200000.0 clocks (96 MHz)
-// Maximun Frame Rate: 199.602 fps
-// Pixel Clock: divided by 1
-// Skip Mode: 4x cols, 4x rows, Bin Mode: Yes
-// Horiz clks:  640 active + 5146 blank = 5786 total
-// Vert  rows:  480 active + 73 blank = 553 total
-// 
-// Actual Frame Clocks: 3200000 clocks
-// Row Time: 60.271 usec / 5786 clocks
-// Frame time: 33.333333 msec
-// Frames per Sec: 30 fps
-// 
-// 
-// 
-
-
-
-//[AR0542 (A-5141) Register Wizard Defaults]
-
-
-	{2,0x0103, 0x01},    //SOFTWARE_RESET (clears itself)                               
-	{TIME_DELAY, 0, 5},      //Initialization Time                                      
-	                                                                                    
-	//stop_streaming                                                                    
-	{2,0x0100, 0x00},    // MODE_SELECT                                                 
-	{2,0x301A, 0x0218},    //RESET_REGISTER enable mipi interface  bit[9] mask bad frame
-	{2,0x3064, 0xB800},    // SMIA_TEST                                                 
-	{2,0x31AE, 0x0202},    // two lane                                                  
-	{2,0x0112, 0x0A0A},    // 10bit raw output                                          
-	{1,0x0300, 0x05},    //vt_pix_clk_div = 5                                           
-	{1,0x0302, 0x01},    //vt_sys_clk_div = 1                                           
-	{1,0x0304, 0x02},    //pre_pll_clk_div = 2                                          
-	{1,0x0306, 0x28},    //pll_multiplier    =  40                                      
-	{1,0x0308, 0x0A},    //op_pix_clk_div =  10                                         
-	{1,0x030A, 0x01},    //op_sys_clk_div = 1                                           
-	                                                                                    
-	  //stop_streaming                                                                  
-	{1,0x0100, 0x0 },    // MODE_SELECT                                                 
-	{1,0x0104, 0x01},    // GROUPED_PARAMETER_HOLD = 0x1                                
-	                                                                                    
-	//1296 x 972  Timing settings 30fps                                                 
-	{2,0x3064, 0xB800},    // SMIA_TEST                                                 
-	{2,0x31AE, 0x0202},    // two lane 201 tow 202                                      
-	{2,0x0112, 0x0A0A},    // 10bit raw output                                          
-	//PLL MCLK=26MHZ, PCLK = 104MHZ, VT = 104MHZ                                        
-	{1,0x0300, 0x05},    //vt_pix_clk_div = 5                                           
-	{1,0x0302, 0x01},    //vt_sys_clk_div = 1                                           
-	{1,0x0304, 0x02},    //pre_pll_clk_div = 2                                          
-	{1,0x0306, 0x28},    //pll_multiplier    =  40                                      
-	{1,0x0308, 0x0A},    //op_pix_clk_div =  10                                         
-	{1,0x030A, 0x01},    //op_sys_clk_div = 1                                           
-	                                                                                    
-	{2,0x0344, 0x0018},    // X_ADDR_START   =  8                                       
-	{2,0x0346, 0x0014},    // Y_ADDR_START   =  8                                       
-	{2,0x0348, 0x0A11},    // X_ADDR_END      = 2597                                    
-	{2,0x034A, 0x078D},    // Y_ADDR_END       =  1949                                  
-	{2,0x3040, 0x85C7},    // READ_MODE  10 011 000011 xy binning enable xodd=3, yodd=3 
-	{2,0x034C, 0x0280},    // X_OUTPUT_SIZE    = 1296                                   
-	{2,0x034E, 0x01E0},    // Y_OUTPUT_SIZE    =  972                                   
-	{2,0x300C, 0x169A},    // LINE_LENGTH  3151                                         
-	{2,0x300A, 0x0229},    // FRAME_LINEs  1100                                         
-	                                                                                    
-	{2,0x3014, 0x1356},    // fine_integration_time                                     
-	{2,0x3010, 0x0184},    // fine_correction  
-	{2,0x3012, 0x0228},    // Coarse Integration Time = 0x228                                          
-	{1,0x0104, 0x00},    // GROUPED_PARAMETER_HOLD                                      
-	                                                                                    
-	    //start_streaming                                                               
-	{1,0x0100, 0x01},    // MODE_SELECT    
-	{END_OF_SCRIPT, 0, 0},
+        // This file was generated by: AR0542 (A-5141) Register Wizard
+        //   Version: 4.5.13.36518    Build Date: 07/08/2013
+        //
+        // [PLL PARAMETERS]
+        //
+        // Bypass PLL: Unchecked
+        // Input Frequency: 24.000
+        // Use Min Freq.: Unchecked
+        // Target VT Frequency: 96.000
+        // Target op_sys_clk Frequency: Unspecified
+        //
+        // Target PLL VT Frequency: 96 MHz
+        // Target PLL OP Frequency: 96 MHz
+        // MT9P017 Input Clock Frequency: 24 MHz
+        // MT9P017 VT (Internal) Pixel Clock Frequency: 96 MHz
+        // MT9P017 OP (Output) Pixel Clock Frequency: 48 MHz
+        // pre_pll_clk_div = 2
+        // pll_multiplier = 40
+        // vt_sys_clk_div = 1
+        // vt_pix_clk_div = 5
+        // op_sys_clk_div = 1
+        // op_pix_clk_div = 10
+        // ip_clk = 12 MHz
+        // op_clk = 480 MHz
+        // op_sys_clk = 480 MHz
+        //
+        // [SENSOR PARAMETERS]
+        //
+        // Requested Frames Per Second: 30.000
+        // Output Columns: 640
+        // Output Rows: 480
+        // Use Binning: Checked
+        // Allow Skipping: Unchecked
+        // Blanking Computation: HB Max then VB
+        //
+        // Max Frame Time: 33.3333 msec
+        // Max Frame Clocks: 3200000.0 clocks (96 MHz)
+        // Maximun Frame Rate: 199.602 fps
+        // Pixel Clock: divided by 1
+        // Skip Mode: 4x cols, 4x rows, Bin Mode: Yes
+        // Horiz clks:  640 active + 5146 blank = 5786 total
+        // Vert  rows:  480 active + 73 blank = 553 total
+        //
+        // Actual Frame Clocks: 3200000 clocks
+        // Row Time: 60.271 usec / 5786 clocks
+        // Frame time: 33.333333 msec
+        // Frames per Sec: 30 fps
+        //
+        //
+        //
+
+
+
+        //[AR0542 (A-5141) Register Wizard Defaults]
+        {1,0x0103, 0x01},    //SOFTWARE_RESET (clears itself)
+        {TIME_DELAY, 0, 5},      //Initialization Time
+
+        //stop_streaming
+        {1,0x0100, 0x00},    // MODE_SELECT
+        {2,0x301A, 0x0218},    //RESET_REGISTER enable mipi interface  bit[9] mask bad frame
+        {2,0x3064, 0xB800},    // SMIA_TEST
+        {2,0x31AE, 0x0202},    // two lane
+        {2,0x0112, 0x0A0A},    // 10bit raw output
+
+#if 1
+        //1.)    Add the ?¡ãRecommended Settings?¡À
+        //[=========== Recommended Settings ==============]
+        //[REV1_recommended_settings]
+        {2, 0x316A, 0x8400}, // RESERVED
+        {2, 0x316C, 0x8400}, // RESERVED
+        {2, 0x316E, 0x8400}, // RESERVED
+        {2, 0x3EFA, 0x1A1F}, // RESERVED
+        {2, 0x3ED2, 0xD965}, // RESERVED
+        {2, 0x3ED8, 0x7F1B}, // RESERVED
+        {2, 0x3EDA, 0x2F11}, // RESERVED
+        {2, 0x3EE2, 0x0060}, // RESERVED
+        {2, 0x3EF2, 0xD965}, // RESERVED
+        {2, 0x3EF8, 0x797F}, // RESERVED
+        {2, 0x3EFC, 0x286F}, // Customer_Request 35298
+        {2, 0x3EFE, 0x2C01},
+        //[REV1_pixel_timing]
+        // @00 Jump Table  // Customer_Request 35298 - Start
+        {2, 0x3E00, 0x042F},
+        {2, 0x3E02, 0xFFFF},
+        {2, 0x3E04, 0xFFFF},
+        {2, 0x3E06, 0xFFFF},
+        // @04 Read
+        {2, 0x3E08, 0x8071},
+        {2, 0x3E0A, 0x7281},
+        {2, 0x3E0C, 0x4011},
+        {2, 0x3E0E, 0x8010},
+        {2, 0x3E10, 0x60A5},
+        {2, 0x3E12, 0x4080},
+        {2, 0x3E14, 0x4180},
+        {2, 0x3E16, 0x0018},
+        {2, 0x3E18, 0x46B7},
+        {2, 0x3E1A, 0x4994},
+        {2, 0x3E1C, 0x4997},
+        {2, 0x3E1E, 0x4682},
+        {2, 0x3E20, 0x0018},
+        {2, 0x3E22, 0x4241},
+        {2, 0x3E24, 0x8000},
+        {2, 0x3E26, 0x1880},
+        {2, 0x3E28, 0x4785},
+        {2, 0x3E2A, 0x4992},
+        {2, 0x3E2C, 0x4997},
+        {2, 0x3E2E, 0x4780},
+        {2, 0x3E30, 0x4D80},
+        {2, 0x3E32, 0x100C},
+        {2, 0x3E34, 0x8000},
+        {2, 0x3E36, 0x184A},
+        {2, 0x3E38, 0x8042},
+        {2, 0x3E3A, 0x001A},
+        {2, 0x3E3C, 0x9610},
+        {2, 0x3E3E, 0x0C80},
+        {2, 0x3E40, 0x4DC6},
+        {2, 0x3E42, 0x4A80},
+        {2, 0x3E44, 0x0018},
+        {2, 0x3E46, 0x8042},
+        {2, 0x3E48, 0x8041},
+        {2, 0x3E4A, 0x0018},
+        {2, 0x3E4C, 0x804B},
+        {2, 0x3E4E, 0xB74B},
+        {2, 0x3E50, 0x8010},
+        {2, 0x3E52, 0x6056},
+        {2, 0x3E54, 0x001C},
+        {2, 0x3E56, 0x8211},
+        {2, 0x3E58, 0x8056},
+        {2, 0x3E5A, 0x827C},
+        {2, 0x3E5C, 0x0970},
+        {2, 0x3E5E, 0x8082},
+        {2, 0x3E60, 0x7281},
+        {2, 0x3E62, 0x4C40},
+        {2, 0x3E64, 0x8E4D},
+        {2, 0x3E66, 0x8110},
+        {2, 0x3E68, 0x0CAF},
+        {2, 0x3E6A, 0x4D80},
+        {2, 0x3E6C, 0x100C},
+        {2, 0x3E6E, 0x8440},
+        {2, 0x3E70, 0x4C81},
+        {2, 0x3E72, 0x7C5F},
+        {2, 0x3E74, 0x7000},
+        {2, 0x3E76, 0x0000},
+        {2, 0x3E78, 0x0000},
+        {2, 0x3E7A, 0x0000},
+        {2, 0x3E7C, 0x0000},
+        {2, 0x3E7E, 0x0000},
+        {2, 0x3E80, 0x0000},
+        {2, 0x3E82, 0x0000},
+        {2, 0x3E84, 0x0000},
+        {2, 0x3E86, 0x0000},
+        {2, 0x3E88, 0x0000},
+        {2, 0x3E8A, 0x0000},
+        {2, 0x3E8C, 0x0000},
+        {2, 0x3E8E, 0x0000},
+        {2, 0x3E90, 0x0000},
+        {2, 0x3E92, 0x0000},
+        {2, 0x3E94, 0x0000},
+        {2, 0x3E96, 0x0000},
+        {2, 0x3E98, 0x0000},
+        {2, 0x3E9A, 0x0000},
+        {2, 0x3E9C, 0x0000},
+        {2, 0x3E9E, 0x0000},
+        {2, 0x3EA0, 0x0000},
+        {2, 0x3EA2, 0x0000},
+        {2, 0x3EA4, 0x0000},
+        {2, 0x3EA6, 0x0000},
+        {2, 0x3EA8, 0x0000},
+        {2, 0x3EAA, 0x0000},
+        {2, 0x3EAC, 0x0000},
+        {2, 0x3EAE, 0x0000},
+        {2, 0x3EB0, 0x0000},
+        {2, 0x3EB2, 0x0000},
+        {2, 0x3EB4, 0x0000},
+        {2, 0x3EB6, 0x0000},
+        {2, 0x3EB8, 0x0000},
+        {2, 0x3EBA, 0x0000},
+        {2, 0x3EBC, 0x0000},
+        {2, 0x3EBE, 0x0000},
+        {2, 0x3EC0, 0x0000},
+        {2, 0x3EC2, 0x0000},
+        {2, 0x3EC4, 0x0000},
+        {2, 0x3EC6, 0x0000},
+        {2, 0x3EC8, 0x0000},
+        {2, 0x3ECA, 0x0000}, // Customer_Request 35298 - End
+
+        {2, 0x3170, 0x2150},
+        {2, 0x317A, 0x0150},
+        {2, 0x3ECC, 0x2200},
+        {2, 0x3174, 0x0000},
+        {2, 0x3176, 0X0000},
+        {2, 0x30BC, 0x0384},
+        {2, 0x30C0, 0x1220},
+        {2, 0x30D4, 0x9200},
+        {2, 0x30B2, 0xC000},
+        {2, 0x31B0, 0x00C4},
+        {2, 0x31B2, 0x0064},
+        {2, 0x31B4, 0x0E77},
+        {2, 0x31B6, 0x0D24},
+        {2, 0x31B8, 0x020E},
+        {2, 0x31BA, 0x0710},
+        {2, 0x31BC, 0x2A0D},
+        {2, 0x31BE, 0xC003},
+        {2, 0x3ECE, 0x000A}, // DAC_LD_2_3
+
+        //2.)    Add the 2DDC setting
+        // add 2DDC setting_05132014
+        // AR0543 ADACD and 2DDC settings
+        // updated June 2013--ADACD and 2DDC settings
+        // ADACD: low gain
+        {2, 0x3100, 0x0002},     // ADACD_CONTROL
+        {2, 0x3102, 0x0064},     // ADACD_NOISE_MODEL1
+        {2, 0x3104, 0x0B6D},     // ADACD_NOISE_MODEL2
+        {2, 0x3106, 0x0201},     // ADACD_NOISE_FLOOR1
+        {2, 0x3108, 0x0905},     // ADACD_NOISE_FLOOR2
+        {2, 0x310A, 0x002A},     // ADACD_PEDESTAL
+        //2DDC: low gain
+        {2, 0x31E0, 0x1F01},      // PIX_DEF_ID
+        {2, 0x3F02, 0x0001},      // PIX_DEF_2D_DDC_THRESH_HI3
+        {2, 0x3F04, 0x0032},      // PIX_DEF_2D_DDC_THRESH_LO3
+        {2, 0x3F06, 0x015E},      // PIX_DEF_2D_DDC_THRESH_HI4
+        {2, 0x3F08, 0x0190},      // PIX_DEF_2D_DDC_THRESH_LO4
+        //3.)    Add Minimum Analog Gain ( Normalized 1x Gain)
+        //>> Just test in normal light environment
+        // add Minimum Analog Gain
+        {2, 0x305E, 0x1127}, // GLOBAL_GAIN
+#endif
+
+        {1,0x0104, 0x01},    // GROUPED_PARAMETER_HOLD = 0x1
+#if 1 //85h lens shading
+        {2, 0x3780, 0x0000}, 	// POLY_SC_ENABLE
+        {2, 0x3600, 0x0170}, 	// P_GR_P0Q0
+        {2, 0x3602, 0x2348}, 	// P_GR_P0Q1
+        {2, 0x3604, 0x1D71}, 	// P_GR_P0Q2
+        {2, 0x3606, 0x2808}, 	// P_GR_P0Q3
+        {2, 0x3608, 0xC4B0}, 	// P_GR_P0Q4
+        {2, 0x360A, 0x0170}, 	// P_RD_P0Q0
+        {2, 0x360C, 0xC04C}, 	// P_RD_P0Q1
+        {2, 0x360E, 0x1CD1}, 	// P_RD_P0Q2
+        {2, 0x3610, 0x15EF}, 	// P_RD_P0Q3
+        {2, 0x3612, 0xFD30}, 	// P_RD_P0Q4
+        {2, 0x3614, 0x00D0}, 	// P_BL_P0Q0
+        {2, 0x3616, 0x64EA}, 	// P_BL_P0Q1
+        {2, 0x3618, 0x2FF0}, 	// P_BL_P0Q2
+        {2, 0x361A, 0xB6EE}, 	// P_BL_P0Q3
+        {2, 0x361C, 0xABCF}, 	// P_BL_P0Q4
+        {2, 0x361E, 0x01F0}, 	// P_GB_P0Q0
+        {2, 0x3620, 0xF76C}, 	// P_GB_P0Q1
+        {2, 0x3622, 0x2751}, 	// P_GB_P0Q2
+        {2, 0x3624, 0x0FAE}, 	// P_GB_P0Q3
+        {2, 0x3626, 0xFFD0}, 	// P_GB_P0Q4
+        {2, 0x3640, 0x80ED}, 	// P_GR_P1Q0
+        {2, 0x3642, 0x834E}, 	// P_GR_P1Q1
+        {2, 0x3644, 0x8AEF}, 	// P_GR_P1Q2
+        {2, 0x3646, 0x3DAC}, 	// P_GR_P1Q3
+        {2, 0x3648, 0x2D50}, 	// P_GR_P1Q4
+        {2, 0x364A, 0xF32C}, 	// P_RD_P1Q0
+        {2, 0x364C, 0x5ECE}, 	// P_RD_P1Q1
+        {2, 0x364E, 0x8B0E}, 	// P_RD_P1Q2
+        {2, 0x3650, 0xA7AF}, 	// P_RD_P1Q3
+        {2, 0x3652, 0x2A6F}, 	// P_RD_P1Q4
+        {2, 0x3654, 0xA2AC}, 	// P_BL_P1Q0
+        {2, 0x3656, 0x134E}, 	// P_BL_P1Q1
+        {2, 0x3658, 0x3E6E}, 	// P_BL_P1Q2
+        {2, 0x365A, 0xCF6D}, 	// P_BL_P1Q3
+        {2, 0x365C, 0xA1CE}, 	// P_BL_P1Q4
+        {2, 0x365E, 0x9D2C}, 	// P_GB_P1Q0
+        {2, 0x3660, 0xC0CE}, 	// P_GB_P1Q1
+        {2, 0x3662, 0x310E}, 	// P_GB_P1Q2
+        {2, 0x3664, 0x2B6E}, 	// P_GB_P1Q3
+        {2, 0x3666, 0xA46E}, 	// P_GB_P1Q4
+        {2, 0x3680, 0x25F1}, 	// P_GR_P2Q0
+        {2, 0x3682, 0x612E}, 	// P_GR_P2Q1
+        {2, 0x3684, 0x166F}, 	// P_GR_P2Q2
+        {2, 0x3686, 0x544E}, 	// P_GR_P2Q3
+        {2, 0x3688, 0x92D3}, 	// P_GR_P2Q4
+        {2, 0x368A, 0x4DB1}, 	// P_RD_P2Q0
+        {2, 0x368C, 0xFE2D}, 	// P_RD_P2Q1
+        {2, 0x368E, 0x39CE}, 	// P_RD_P2Q2
+        {2, 0x3690, 0xCACF}, 	// P_RD_P2Q3
+        {2, 0x3692, 0x8073}, 	// P_RD_P2Q4
+        {2, 0x3694, 0x7BD0}, 	// P_BL_P2Q0
+        {2, 0x3696, 0x1A2E}, 	// P_BL_P2Q1
+        {2, 0x3698, 0x4BEF}, 	// P_BL_P2Q2
+        {2, 0x369A, 0x2FF0}, 	// P_BL_P2Q3
+        {2, 0x369C, 0xB072}, 	// P_BL_P2Q4
+        {2, 0x369E, 0x1EB1}, 	// P_GB_P2Q0
+        {2, 0x36A0, 0xB10D}, 	// P_GB_P2Q1
+        {2, 0x36A2, 0x532E}, 	// P_GB_P2Q2
+        {2, 0x36A4, 0xDEEE}, 	// P_GB_P2Q3
+        {2, 0x36A6, 0xEC12}, 	// P_GB_P2Q4
+        {2, 0x36C0, 0x39EC}, 	// P_GR_P3Q0
+        {2, 0x36C2, 0x89CD}, 	// P_GR_P3Q1
+        {2, 0x36C4, 0x39D0}, 	// P_GR_P3Q2
+        {2, 0x36C6, 0x7E10}, 	// P_GR_P3Q3
+        {2, 0x36C8, 0xD031}, 	// P_GR_P3Q4
+        {2, 0x36CA, 0x3BAF}, 	// P_RD_P3Q0
+        {2, 0x36CC, 0xEC8D}, 	// P_RD_P3Q1
+        {2, 0x36CE, 0x448E}, 	// P_RD_P3Q2
+        {2, 0x36D0, 0x402F}, 	// P_RD_P3Q3
+        {2, 0x36D2, 0xD691}, 	// P_RD_P3Q4
+        {2, 0x36D4, 0x6D49}, 	// P_BL_P3Q0
+        {2, 0x36D6, 0xF42D}, 	// P_BL_P3Q1
+        {2, 0x36D8, 0x2FB0}, 	// P_BL_P3Q2
+        {2, 0x36DA, 0x598B}, 	// P_BL_P3Q3
+        {2, 0x36DC, 0xCE91}, 	// P_BL_P3Q4
+        {2, 0x36DE, 0x0E2C}, 	// P_GB_P3Q0
+        {2, 0x36E0, 0x1189}, 	// P_GB_P3Q1
+        {2, 0x36E2, 0x0571}, 	// P_GB_P3Q2
+        {2, 0x36E4, 0x1DD0}, 	// P_GB_P3Q3
+        {2, 0x36E6, 0x9CB2}, 	// P_GB_P3Q4
+        {2, 0x3700, 0xD830}, 	// P_GR_P4Q0
+        {2, 0x3702, 0x8D0D}, 	// P_GR_P4Q1
+        {2, 0x3704, 0xB9F3}, 	// P_GR_P4Q2
+        {2, 0x3706, 0x9CB1}, 	// P_GR_P4Q3
+        {2, 0x3708, 0x5CF3}, 	// P_GR_P4Q4
+        {2, 0x370A, 0x8291}, 	// P_RD_P4Q0
+        {2, 0x370C, 0x65EE}, 	// P_RD_P4Q1
+        {2, 0x370E, 0xEDD3}, 	// P_RD_P4Q2
+        {2, 0x3710, 0xD82E}, 	// P_RD_P4Q3
+        {2, 0x3712, 0x3D14}, 	// P_RD_P4Q4
+        {2, 0x3714, 0xA150}, 	// P_BL_P4Q0
+        {2, 0x3716, 0xB06F}, 	// P_BL_P4Q1
+        {2, 0x3718, 0xFC12}, 	// P_BL_P4Q2
+        {2, 0x371A, 0x9170}, 	// P_BL_P4Q3
+        {2, 0x371C, 0x07B3}, 	// P_BL_P4Q4
+        {2, 0x371E, 0x9E90}, 	// P_GB_P4Q0
+        {2, 0x3720, 0xBD8B}, 	// P_GB_P4Q1
+        {2, 0x3722, 0xB413}, 	// P_GB_P4Q2
+        {2, 0x3724, 0x1611}, 	// P_GB_P4Q3
+        {2, 0x3726, 0x1B53}, 	// P_GB_P4Q4
+        {2, 0x3782, 0x04F4}, 	// POLY_ORIGIN_C
+        {2, 0x3784, 0x03C8}, 	// POLY_ORIGIN_R
+        {2, 0x37C0, 0x3E29}, 	// P_GR_Q5
+        {2, 0x37C2, 0x0FC8}, 	// P_RD_Q5
+        {2, 0x37C4, 0x0F2A}, 	// P_BL_Q5
+        {2, 0x37C6, 0x5209}, 	// P_GB_Q5
+        {2, 0x3780, 0x8000}, 	// POLY_SC_ENABLE
+#endif
+
+        //1296 x 972  Timing settings 30fps
+        {2,0x3064, 0xB800},    // SMIA_TEST
+        {2,0x31AE, 0x0202},    // two lane 201 tow 202
+        {2,0x0112, 0x0A0A},    // 10bit raw output
+        //PLL MCLK=26MHZ, PCLK = 104MHZ, VT = 104MHZ
+        {2,0x0300, 0x05},    //vt_pix_clk_div = 5
+        {2,0x0302, 0x01},    //vt_sys_clk_div = 1
+        {2,0x0304, 0x02},    //pre_pll_clk_div = 2
+        {2,0x0306, 0x50},    //pll_multiplier    =  40
+        {2,0x0308, 0x0A},    //op_pix_clk_div =  10
+        {2,0x030A, 0x01},    //op_sys_clk_div = 1
+
+        {2,0x0344, 0x0018},    // X_ADDR_START   =  8
+        {2,0x0346, 0x0014},    // Y_ADDR_START   =  8
+        {2,0x0348, 0x0A11},    // X_ADDR_END      = 2597
+        {2,0x034A, 0x078D},    // Y_ADDR_END       =  1949
+        {2,0x3040, 0x85C7},    // READ_MODE  10 011 000011 xy binning enable xodd=3, yodd=3
+        {2,0x034C, 0x0280},    // X_OUTPUT_SIZE    = 1296
+        {2,0x034E, 0x01E0},    // Y_OUTPUT_SIZE    =  972
+        {2,0x300C, 0x169A},    // LINE_LENGTH  3151
+        {2,0x300A, 0x0229},    // FRAME_LINEs  1100
+
+        {2,0x3014, 0x1356},    // fine_integration_time
+        {2,0x3010, 0x0184},    // fine_correction
+        {2,0x3012, 0x0228},    // Coarse Integration Time = 0x228
+        {1,0x0104, 0x00},    // GROUPED_PARAMETER_HOLD
+
+        //start_streaming
+        {1,0x0100, 0x01},    // MODE_SELECT
+        {END_OF_SCRIPT, 0, 0},
 };
 
 static cam_i2c_msg_t AR0543_preview_720P_script[] = {
@@ -785,108 +1053,373 @@ static cam_i2c_msg_t AR0543_preview_720P_script[] = {
 };
 
 static cam_i2c_msg_t AR0543_720P_script_mipi[] = {
-// This file was generated by: AR0542 (A-5141) Register Wizard
-//   Version: 4.5.13.36518    Build Date: 07/08/2013
-// 
-// [PLL PARAMETERS]
-// 
-// Bypass PLL: Unchecked
-// Input Frequency: 24.000
-// Use Min Freq.: Unchecked
-// Target VT Frequency: 96.000
-// Target op_sys_clk Frequency: Unspecified
-// 
-// Target PLL VT Frequency: 96 MHz
-// Target PLL OP Frequency: 96 MHz
-// MT9P017 Input Clock Frequency: 24 MHz
-// MT9P017 VT (Internal) Pixel Clock Frequency: 96 MHz
-// MT9P017 OP (Output) Pixel Clock Frequency: 48 MHz
-// pre_pll_clk_div = 2
-// pll_multiplier = 40
-// vt_sys_clk_div = 1
-// vt_pix_clk_div = 5
-// op_sys_clk_div = 1
-// op_pix_clk_div = 10
-// ip_clk = 12 MHz
-// op_clk = 480 MHz
-// op_sys_clk = 480 MHz
-// 
-// [SENSOR PARAMETERS]
-// 
-// Requested Frames Per Second: 30.000
-// Output Columns: 1280
-// Output Rows: 720
-// Use Binning: Checked
-// Allow Skipping: Unchecked
-// Blanking Computation: HB Max then VB
-// 
-// Max Frame Time: 33.3333 msec
-// Max Frame Clocks: 3200000.0 clocks (96 MHz)
-// Maximun Frame Rate: 70.788 fps
-// Pixel Clock: divided by 1
-// Skip Mode: 2x cols, 2x rows, Bin Mode: Yes
-// Horiz clks:  1280 active + 2755 blank = 4035 total
-// Vert  rows:  720 active + 73 blank = 793 total
-// 
-// Actual Frame Clocks: 3200000 clocks
-// Row Time: 42.031 usec / 4035 clocks
-// Frame time: 33.333333 msec
-// Frames per Sec: 30 fps
-// 
-// 
-// 
-
-
-
-	{2,0x0103, 0x01},    //SOFTWARE_RESET (clears itself)                               
-	{TIME_DELAY, 0, 5},      //Initialization Time                                      
-	                                                                                    
-	//stop_streaming                                                                    
-	{2,0x0100, 0x00},    // MODE_SELECT                                                 
-	{2,0x301A, 0x0218},    //RESET_REGISTER enable mipi interface  bit[9] mask bad frame
-	{2,0x3064, 0xB800},    // SMIA_TEST                                                 
-	{2,0x31AE, 0x0202},    // two lane                                                  
-	{2,0x0112, 0x0A0A},    // 10bit raw output                                          
-	{1,0x0300, 0x05},    //vt_pix_clk_div = 5                                           
-	{1,0x0302, 0x01},    //vt_sys_clk_div = 1                                           
-	{1,0x0304, 0x02},    //pre_pll_clk_div = 2                                          
-	{1,0x0306, 0x28},    //pll_multiplier    =  40                                      
-	{1,0x0308, 0x0A},    //op_pix_clk_div =  10                                         
-	{1,0x030A, 0x01},    //op_sys_clk_div = 1                                           
-	                                                                                    
-	  //stop_streaming                                                                  
-	{1,0x0100, 0x0 },    // MODE_SELECT                                                 
-	{1,0x0104, 0x01},    // GROUPED_PARAMETER_HOLD = 0x1                                
-	                                                                                    
-	//1296 x 972  Timing settings 30fps                                                 
-	{2,0x3064, 0xB800},    // SMIA_TEST                                                 
-	{2,0x31AE, 0x0202},    // two lane 201 tow 202                                      
-	{2,0x0112, 0x0A0A},    // 10bit raw output                                          
-	//PLL MCLK=26MHZ, PCLK = 104MHZ, VT = 104MHZ                                        
-	{1,0x0300, 0x05},    //vt_pix_clk_div = 5                                           
-	{1,0x0302, 0x01},    //vt_sys_clk_div = 1                                           
-	{1,0x0304, 0x02},    //pre_pll_clk_div = 2                                          
-	{1,0x0306, 0x28},    //pll_multiplier    =  40                                      
-	{1,0x0308, 0x0A},    //op_pix_clk_div =  10                                         
-	{1,0x030A, 0x01},    //op_sys_clk_div = 1                                           
-	                                                                                    
-	{2,0x0344, 0x0018},    // X_ADDR_START   =  8                                       
-	{2,0x0346, 0x0104},    // Y_ADDR_START   =  8                                       
-	{2,0x0348, 0x0A15},    // X_ADDR_END      = 2597                                    
-	{2,0x034A, 0x06A1},    // Y_ADDR_END       =  1949                                  
-	{2,0x3040, 0x84C3},    // READ_MODE  10 011 000011 xy binning enable xodd=3, yodd=3 
-	{2,0x034C, 0x0500},    // X_OUTPUT_SIZE    = 1296                                   
-	{2,0x034E, 0x02D0},    // Y_OUTPUT_SIZE    =  972                                   
-	{2,0x300C, 0x0FC3},    // LINE_LENGTH  3151                                         
-	{2,0x300A, 0x0319},    // FRAME_LINEs  1100                                         
-	                                                                                    
-	{2,0x3014, 0x0C7F},    // fine_integration_time                                     
-	{2,0x3010, 0x0319},    // fine_correction                                           
-	{1,0x0104, 0x00},    // GROUPED_PARAMETER_HOLD                                      
-	                                                                                    
-	    //start_streaming                                                               
-	{1,0x0100, 0x01},    // MODE_SELECT   
-	{END_OF_SCRIPT, 0, 0},
+        // This file was generated by: AR0542 (A-5141) Register Wizard
+        //   Version: 4.5.13.36518    Build Date: 07/08/2013
+        //
+        // [PLL PARAMETERS]
+        //
+        // Bypass PLL: Unchecked
+        // Input Frequency: 24.000
+        // Use Min Freq.: Unchecked
+        // Target VT Frequency: 96.000
+        // Target op_sys_clk Frequency: Unspecified
+        //
+        // Target PLL VT Frequency: 96 MHz
+        // Target PLL OP Frequency: 96 MHz
+        // MT9P017 Input Clock Frequency: 24 MHz
+        // MT9P017 VT (Internal) Pixel Clock Frequency: 96 MHz
+        // MT9P017 OP (Output) Pixel Clock Frequency: 48 MHz
+        // pre_pll_clk_div = 2
+        // pll_multiplier = 40
+        // vt_sys_clk_div = 1
+        // vt_pix_clk_div = 5
+        // op_sys_clk_div = 1
+        // op_pix_clk_div = 10
+        // ip_clk = 12 MHz
+        // op_clk = 480 MHz
+        // op_sys_clk = 480 MHz
+        //
+        // [SENSOR PARAMETERS]
+        //
+        // Requested Frames Per Second: 30.000
+        // Output Columns: 1280
+        // Output Rows: 720
+        // Use Binning: Checked
+        // Allow Skipping: Unchecked
+        // Blanking Computation: HB Max then VB
+        //
+        // Max Frame Time: 33.3333 msec
+        // Max Frame Clocks: 3200000.0 clocks (96 MHz)
+        // Maximun Frame Rate: 70.788 fps
+        // Pixel Clock: divided by 1
+        // Skip Mode: 2x cols, 2x rows, Bin Mode: Yes
+        // Horiz clks:  1280 active + 2755 blank = 4035 total
+        // Vert  rows:  720 active + 73 blank = 793 total
+        //
+        // Actual Frame Clocks: 3200000 clocks
+        // Row Time: 42.031 usec / 4035 clocks
+        // Frame time: 33.333333 msec
+        // Frames per Sec: 30 fps
+        //
+        //
+        //
+
+
+
+        {1,0x0103, 0x01},    //SOFTWARE_RESET (clears itself)
+        {TIME_DELAY, 0, 5},      //Initialization Time
+
+        //stop_streaming
+        {1,0x0100, 0x00},    // MODE_SELECT
+        {2,0x301A, 0x0218},    //RESET_REGISTER enable mipi interface  bit[9] mask bad frame
+        {2,0x3064, 0xB800},    // SMIA_TEST
+        {2,0x31AE, 0x0202},    // two lane
+        {2,0x0112, 0x0A0A},    // 10bit raw output
+#if 1
+        //1.)    Add the ?¡ãRecommended Settings?¡À
+        //[=========== Recommended Settings ==============]
+        //[REV1_recommended_settings]
+        {2, 0x316A, 0x8400}, // RESERVED
+        {2, 0x316C, 0x8400}, // RESERVED
+        {2, 0x316E, 0x8400}, // RESERVED
+        {2, 0x3EFA, 0x1A1F}, // RESERVED
+        {2, 0x3ED2, 0xD965}, // RESERVED
+        {2, 0x3ED8, 0x7F1B}, // RESERVED
+        {2, 0x3EDA, 0x2F11}, // RESERVED
+        {2, 0x3EE2, 0x0060}, // RESERVED
+        {2, 0x3EF2, 0xD965}, // RESERVED
+        {2, 0x3EF8, 0x797F}, // RESERVED
+        {2, 0x3EFC, 0x286F}, // Customer_Request 35298
+        {2, 0x3EFE, 0x2C01},
+        //[REV1_pixel_timing]
+        // @00 Jump Table  // Customer_Request 35298 - Start
+        {2, 0x3E00, 0x042F},
+        {2, 0x3E02, 0xFFFF},
+        {2, 0x3E04, 0xFFFF},
+        {2, 0x3E06, 0xFFFF},
+        // @04 Read
+        {2, 0x3E08, 0x8071},
+        {2, 0x3E0A, 0x7281},
+        {2, 0x3E0C, 0x4011},
+        {2, 0x3E0E, 0x8010},
+        {2, 0x3E10, 0x60A5},
+        {2, 0x3E12, 0x4080},
+        {2, 0x3E14, 0x4180},
+        {2, 0x3E16, 0x0018},
+        {2, 0x3E18, 0x46B7},
+        {2, 0x3E1A, 0x4994},
+        {2, 0x3E1C, 0x4997},
+        {2, 0x3E1E, 0x4682},
+        {2, 0x3E20, 0x0018},
+        {2, 0x3E22, 0x4241},
+        {2, 0x3E24, 0x8000},
+        {2, 0x3E26, 0x1880},
+        {2, 0x3E28, 0x4785},
+        {2, 0x3E2A, 0x4992},
+        {2, 0x3E2C, 0x4997},
+        {2, 0x3E2E, 0x4780},
+        {2, 0x3E30, 0x4D80},
+        {2, 0x3E32, 0x100C},
+        {2, 0x3E34, 0x8000},
+        {2, 0x3E36, 0x184A},
+        {2, 0x3E38, 0x8042},
+        {2, 0x3E3A, 0x001A},
+        {2, 0x3E3C, 0x9610},
+        {2, 0x3E3E, 0x0C80},
+        {2, 0x3E40, 0x4DC6},
+        {2, 0x3E42, 0x4A80},
+        {2, 0x3E44, 0x0018},
+        {2, 0x3E46, 0x8042},
+        {2, 0x3E48, 0x8041},
+        {2, 0x3E4A, 0x0018},
+        {2, 0x3E4C, 0x804B},
+        {2, 0x3E4E, 0xB74B},
+        {2, 0x3E50, 0x8010},
+        {2, 0x3E52, 0x6056},
+        {2, 0x3E54, 0x001C},
+        {2, 0x3E56, 0x8211},
+        {2, 0x3E58, 0x8056},
+        {2, 0x3E5A, 0x827C},
+        {2, 0x3E5C, 0x0970},
+        {2, 0x3E5E, 0x8082},
+        {2, 0x3E60, 0x7281},
+        {2, 0x3E62, 0x4C40},
+        {2, 0x3E64, 0x8E4D},
+        {2, 0x3E66, 0x8110},
+        {2, 0x3E68, 0x0CAF},
+        {2, 0x3E6A, 0x4D80},
+        {2, 0x3E6C, 0x100C},
+        {2, 0x3E6E, 0x8440},
+        {2, 0x3E70, 0x4C81},
+        {2, 0x3E72, 0x7C5F},
+        {2, 0x3E74, 0x7000},
+        {2, 0x3E76, 0x0000},
+        {2, 0x3E78, 0x0000},
+        {2, 0x3E7A, 0x0000},
+        {2, 0x3E7C, 0x0000},
+        {2, 0x3E7E, 0x0000},
+        {2, 0x3E80, 0x0000},
+        {2, 0x3E82, 0x0000},
+        {2, 0x3E84, 0x0000},
+        {2, 0x3E86, 0x0000},
+        {2, 0x3E88, 0x0000},
+        {2, 0x3E8A, 0x0000},
+        {2, 0x3E8C, 0x0000},
+        {2, 0x3E8E, 0x0000},
+        {2, 0x3E90, 0x0000},
+        {2, 0x3E92, 0x0000},
+        {2, 0x3E94, 0x0000},
+        {2, 0x3E96, 0x0000},
+        {2, 0x3E98, 0x0000},
+        {2, 0x3E9A, 0x0000},
+        {2, 0x3E9C, 0x0000},
+        {2, 0x3E9E, 0x0000},
+        {2, 0x3EA0, 0x0000},
+        {2, 0x3EA2, 0x0000},
+        {2, 0x3EA4, 0x0000},
+        {2, 0x3EA6, 0x0000},
+        {2, 0x3EA8, 0x0000},
+        {2, 0x3EAA, 0x0000},
+        {2, 0x3EAC, 0x0000},
+        {2, 0x3EAE, 0x0000},
+        {2, 0x3EB0, 0x0000},
+        {2, 0x3EB2, 0x0000},
+        {2, 0x3EB4, 0x0000},
+        {2, 0x3EB6, 0x0000},
+        {2, 0x3EB8, 0x0000},
+        {2, 0x3EBA, 0x0000},
+        {2, 0x3EBC, 0x0000},
+        {2, 0x3EBE, 0x0000},
+        {2, 0x3EC0, 0x0000},
+        {2, 0x3EC2, 0x0000},
+        {2, 0x3EC4, 0x0000},
+        {2, 0x3EC6, 0x0000},
+        {2, 0x3EC8, 0x0000},
+        {2, 0x3ECA, 0x0000}, // Customer_Request 35298 - End
+
+        {2, 0x3170, 0x2150},
+        {2, 0x317A, 0x0150},
+        {2, 0x3ECC, 0x2200},
+        {2, 0x3174, 0x0000},
+        {2, 0x3176, 0X0000},
+        {2, 0x30BC, 0x0384},
+        {2, 0x30C0, 0x1220},
+        {2, 0x30D4, 0x9200},
+        {2, 0x30B2, 0xC000},
+        {2, 0x31B0, 0x00C4},
+        {2, 0x31B2, 0x0064},
+        {2, 0x31B4, 0x0E77},
+        {2, 0x31B6, 0x0D24},
+        {2, 0x31B8, 0x020E},
+        {2, 0x31BA, 0x0710},
+        {2, 0x31BC, 0x2A0D},
+        {2, 0x31BE, 0xC003},
+        {2, 0x3ECE, 0x000A}, // DAC_LD_2_3
+
+        //2.)    Add the 2DDC setting
+        // add 2DDC setting_05132014
+        // AR0543 ADACD and 2DDC settings
+        // updated June 2013--ADACD and 2DDC settings
+        // ADACD: low gain
+        {2, 0x3100, 0x0002},     // ADACD_CONTROL
+        {2, 0x3102, 0x0064},     // ADACD_NOISE_MODEL1
+        {2, 0x3104, 0x0B6D},     // ADACD_NOISE_MODEL2
+        {2, 0x3106, 0x0201},     // ADACD_NOISE_FLOOR1
+        {2, 0x3108, 0x0905},     // ADACD_NOISE_FLOOR2
+        {2, 0x310A, 0x002A},     // ADACD_PEDESTAL
+        //2DDC: low gain
+        {2, 0x31E0, 0x1F01},      // PIX_DEF_ID
+        {2, 0x3F02, 0x0001},      // PIX_DEF_2D_DDC_THRESH_HI3
+        {2, 0x3F04, 0x0032},      // PIX_DEF_2D_DDC_THRESH_LO3
+        {2, 0x3F06, 0x015E},      // PIX_DEF_2D_DDC_THRESH_HI4
+        {2, 0x3F08, 0x0190},      // PIX_DEF_2D_DDC_THRESH_LO4
+        //3.)    Add Minimum Analog Gain ( Normalized 1x Gain)
+        //>> Just test in normal light environment
+        // add Minimum Analog Gain
+        {2, 0x305E, 0x1127}, // GLOBAL_GAIN
+#endif
+
+        {1,0x0104, 0x01},    // GROUPED_PARAMETER_HOLD = 0x1
+#if 1 //85h lens shading
+        {2, 0x3780, 0x0000}, 	// POLY_SC_ENABLE
+        {2, 0x3600, 0x0170}, 	// P_GR_P0Q0
+        {2, 0x3602, 0x2348}, 	// P_GR_P0Q1
+        {2, 0x3604, 0x1D71}, 	// P_GR_P0Q2
+        {2, 0x3606, 0x2808}, 	// P_GR_P0Q3
+        {2, 0x3608, 0xC4B0}, 	// P_GR_P0Q4
+        {2, 0x360A, 0x0170}, 	// P_RD_P0Q0
+        {2, 0x360C, 0xC04C}, 	// P_RD_P0Q1
+        {2, 0x360E, 0x1CD1}, 	// P_RD_P0Q2
+        {2, 0x3610, 0x15EF}, 	// P_RD_P0Q3
+        {2, 0x3612, 0xFD30}, 	// P_RD_P0Q4
+        {2, 0x3614, 0x00D0}, 	// P_BL_P0Q0
+        {2, 0x3616, 0x64EA}, 	// P_BL_P0Q1
+        {2, 0x3618, 0x2FF0}, 	// P_BL_P0Q2
+        {2, 0x361A, 0xB6EE}, 	// P_BL_P0Q3
+        {2, 0x361C, 0xABCF}, 	// P_BL_P0Q4
+        {2, 0x361E, 0x01F0}, 	// P_GB_P0Q0
+        {2, 0x3620, 0xF76C}, 	// P_GB_P0Q1
+        {2, 0x3622, 0x2751}, 	// P_GB_P0Q2
+        {2, 0x3624, 0x0FAE}, 	// P_GB_P0Q3
+        {2, 0x3626, 0xFFD0}, 	// P_GB_P0Q4
+        {2, 0x3640, 0x80ED}, 	// P_GR_P1Q0
+        {2, 0x3642, 0x834E}, 	// P_GR_P1Q1
+        {2, 0x3644, 0x8AEF}, 	// P_GR_P1Q2
+        {2, 0x3646, 0x3DAC}, 	// P_GR_P1Q3
+        {2, 0x3648, 0x2D50}, 	// P_GR_P1Q4
+        {2, 0x364A, 0xF32C}, 	// P_RD_P1Q0
+        {2, 0x364C, 0x5ECE}, 	// P_RD_P1Q1
+        {2, 0x364E, 0x8B0E}, 	// P_RD_P1Q2
+        {2, 0x3650, 0xA7AF}, 	// P_RD_P1Q3
+        {2, 0x3652, 0x2A6F}, 	// P_RD_P1Q4
+        {2, 0x3654, 0xA2AC}, 	// P_BL_P1Q0
+        {2, 0x3656, 0x134E}, 	// P_BL_P1Q1
+        {2, 0x3658, 0x3E6E}, 	// P_BL_P1Q2
+        {2, 0x365A, 0xCF6D}, 	// P_BL_P1Q3
+        {2, 0x365C, 0xA1CE}, 	// P_BL_P1Q4
+        {2, 0x365E, 0x9D2C}, 	// P_GB_P1Q0
+        {2, 0x3660, 0xC0CE}, 	// P_GB_P1Q1
+        {2, 0x3662, 0x310E}, 	// P_GB_P1Q2
+        {2, 0x3664, 0x2B6E}, 	// P_GB_P1Q3
+        {2, 0x3666, 0xA46E}, 	// P_GB_P1Q4
+        {2, 0x3680, 0x25F1}, 	// P_GR_P2Q0
+        {2, 0x3682, 0x612E}, 	// P_GR_P2Q1
+        {2, 0x3684, 0x166F}, 	// P_GR_P2Q2
+        {2, 0x3686, 0x544E}, 	// P_GR_P2Q3
+        {2, 0x3688, 0x92D3}, 	// P_GR_P2Q4
+        {2, 0x368A, 0x4DB1}, 	// P_RD_P2Q0
+        {2, 0x368C, 0xFE2D}, 	// P_RD_P2Q1
+        {2, 0x368E, 0x39CE}, 	// P_RD_P2Q2
+        {2, 0x3690, 0xCACF}, 	// P_RD_P2Q3
+        {2, 0x3692, 0x8073}, 	// P_RD_P2Q4
+        {2, 0x3694, 0x7BD0}, 	// P_BL_P2Q0
+        {2, 0x3696, 0x1A2E}, 	// P_BL_P2Q1
+        {2, 0x3698, 0x4BEF}, 	// P_BL_P2Q2
+        {2, 0x369A, 0x2FF0}, 	// P_BL_P2Q3
+        {2, 0x369C, 0xB072}, 	// P_BL_P2Q4
+        {2, 0x369E, 0x1EB1}, 	// P_GB_P2Q0
+        {2, 0x36A0, 0xB10D}, 	// P_GB_P2Q1
+        {2, 0x36A2, 0x532E}, 	// P_GB_P2Q2
+        {2, 0x36A4, 0xDEEE}, 	// P_GB_P2Q3
+        {2, 0x36A6, 0xEC12}, 	// P_GB_P2Q4
+        {2, 0x36C0, 0x39EC}, 	// P_GR_P3Q0
+        {2, 0x36C2, 0x89CD}, 	// P_GR_P3Q1
+        {2, 0x36C4, 0x39D0}, 	// P_GR_P3Q2
+        {2, 0x36C6, 0x7E10}, 	// P_GR_P3Q3
+        {2, 0x36C8, 0xD031}, 	// P_GR_P3Q4
+        {2, 0x36CA, 0x3BAF}, 	// P_RD_P3Q0
+        {2, 0x36CC, 0xEC8D}, 	// P_RD_P3Q1
+        {2, 0x36CE, 0x448E}, 	// P_RD_P3Q2
+        {2, 0x36D0, 0x402F}, 	// P_RD_P3Q3
+        {2, 0x36D2, 0xD691}, 	// P_RD_P3Q4
+        {2, 0x36D4, 0x6D49}, 	// P_BL_P3Q0
+        {2, 0x36D6, 0xF42D}, 	// P_BL_P3Q1
+        {2, 0x36D8, 0x2FB0}, 	// P_BL_P3Q2
+        {2, 0x36DA, 0x598B}, 	// P_BL_P3Q3
+        {2, 0x36DC, 0xCE91}, 	// P_BL_P3Q4
+        {2, 0x36DE, 0x0E2C}, 	// P_GB_P3Q0
+        {2, 0x36E0, 0x1189}, 	// P_GB_P3Q1
+        {2, 0x36E2, 0x0571}, 	// P_GB_P3Q2
+        {2, 0x36E4, 0x1DD0}, 	// P_GB_P3Q3
+        {2, 0x36E6, 0x9CB2}, 	// P_GB_P3Q4
+        {2, 0x3700, 0xD830}, 	// P_GR_P4Q0
+        {2, 0x3702, 0x8D0D}, 	// P_GR_P4Q1
+        {2, 0x3704, 0xB9F3}, 	// P_GR_P4Q2
+        {2, 0x3706, 0x9CB1}, 	// P_GR_P4Q3
+        {2, 0x3708, 0x5CF3}, 	// P_GR_P4Q4
+        {2, 0x370A, 0x8291}, 	// P_RD_P4Q0
+        {2, 0x370C, 0x65EE}, 	// P_RD_P4Q1
+        {2, 0x370E, 0xEDD3}, 	// P_RD_P4Q2
+        {2, 0x3710, 0xD82E}, 	// P_RD_P4Q3
+        {2, 0x3712, 0x3D14}, 	// P_RD_P4Q4
+        {2, 0x3714, 0xA150}, 	// P_BL_P4Q0
+        {2, 0x3716, 0xB06F}, 	// P_BL_P4Q1
+        {2, 0x3718, 0xFC12}, 	// P_BL_P4Q2
+        {2, 0x371A, 0x9170}, 	// P_BL_P4Q3
+        {2, 0x371C, 0x07B3}, 	// P_BL_P4Q4
+        {2, 0x371E, 0x9E90}, 	// P_GB_P4Q0
+        {2, 0x3720, 0xBD8B}, 	// P_GB_P4Q1
+        {2, 0x3722, 0xB413}, 	// P_GB_P4Q2
+        {2, 0x3724, 0x1611}, 	// P_GB_P4Q3
+        {2, 0x3726, 0x1B53}, 	// P_GB_P4Q4
+        {2, 0x3782, 0x04F4}, 	// POLY_ORIGIN_C
+        {2, 0x3784, 0x03C8}, 	// POLY_ORIGIN_R
+        {2, 0x37C0, 0x3E29}, 	// P_GR_Q5
+        {2, 0x37C2, 0x0FC8}, 	// P_RD_Q5
+        {2, 0x37C4, 0x0F2A}, 	// P_BL_Q5
+        {2, 0x37C6, 0x5209}, 	// P_GB_Q5
+        {2, 0x3780, 0x8000}, 	// POLY_SC_ENABLE
+#endif
+
+        //1296 x 972  Timing settings 30fps
+        {2,0x3064, 0xB800},    // SMIA_TEST
+        {2,0x31AE, 0x0202},    // two lane 201 tow 202
+        {2,0x0112, 0x0A0A},    // 10bit raw output
+        //PLL MCLK=26MHZ, PCLK = 104MHZ, VT = 104MHZ
+        {2,0x0300, 0x04},    //vt_pix_clk_div = 5
+        {2,0x0302, 0x01},    //vt_sys_clk_div = 1
+        {2,0x0304, 0x02},    //pre_pll_clk_div = 2
+        {2,0x0306, 0x40},    //pll_multiplier    =  40
+        {2,0x0308, 0x0A},    //op_pix_clk_div =  10
+        {2,0x030A, 0x01},    //op_sys_clk_div = 1
+
+        {2,0x0344, 0x0018},    // X_ADDR_START   =  8
+        {2,0x0346, 0x0104},    // Y_ADDR_START   =  8
+        {2,0x0348, 0x0A15},    // X_ADDR_END      = 2597
+        {2,0x034A, 0x06A1},    // Y_ADDR_END       =  1949
+        {2,0x3040, 0x84C3},    // READ_MODE  10 011 000011 xy binning enable xodd=3, yodd=3
+        {2,0x034C, 0x0500},    // X_OUTPUT_SIZE    = 1296
+        {2,0x034E, 0x02D0},    // Y_OUTPUT_SIZE    =  972
+        {2,0x300C, 0x0FC3},    // LINE_LENGTH  3151
+        {2,0x300A, 0x0319},    // FRAME_LINEs  1100
+
+        {2,0x3014, 0x0C7F},    // fine_integration_time
+        {2,0x3010, 0x0319},    // fine_correction
+        {1,0x0104, 0x00},    // GROUPED_PARAMETER_HOLD
+
+        //start_streaming
+        {1,0x0100, 0x01},    // MODE_SELECT
+        {END_OF_SCRIPT, 0, 0},
 };
 
 static cam_i2c_msg_t AR0543_preview_960P_script[] = {
@@ -894,455 +1427,1095 @@ static cam_i2c_msg_t AR0543_preview_960P_script[] = {
 };
 
 static cam_i2c_msg_t AR0543_960P_script_mipi[] = {
-	// This file was generated by: AR0542 (A-5141) Register Wizard
-	//   Version: 4.5.13.36518    Build Date: 07/08/2013
-	// 
-	// [PLL PARAMETERS]
-	// 
-	// Bypass PLL: Unchecked
-	// Input Frequency: 24.000
-	// Use Min Freq.: Unchecked
-	// Target VT Frequency: 96.000
-	// Target op_sys_clk Frequency: Unspecified
-	// 
-	// Target PLL VT Frequency: 96 MHz
-	// Target PLL OP Frequency: 96 MHz
-	// MT9P017 Input Clock Frequency: 24 MHz
-	// MT9P017 VT (Internal) Pixel Clock Frequency: 96 MHz
-	// MT9P017 OP (Output) Pixel Clock Frequency: 48 MHz
-	// pre_pll_clk_div = 2
-	// pll_multiplier = 40
-	// vt_sys_clk_div = 1
-	// vt_pix_clk_div = 5
-	// op_sys_clk_div = 1
-	// op_pix_clk_div = 10
-	// ip_clk = 12 MHz
-	// op_clk = 480 MHz
-	// op_sys_clk = 480 MHz
-	// 
-	// [SENSOR PARAMETERS]
-	// 
-	// Requested Frames Per Second: 29.000
-	// Output Columns: 1296
-	// Output Rows: 972
-	// Use Binning: Checked
-	// Allow Skipping: Unchecked
-	// Blanking Computation: HB Max then VB
-	// 
-	// Max Frame Time: 34.4828 msec
-	// Max Frame Clocks: 3310344.8 clocks (96 MHz)
-	// Maximun Frame Rate: 54.554 fps
-	// Pixel Clock: divided by 1
-	// Skip Mode: 2x cols, 2x rows, Bin Mode: Yes
-	// Horiz clks:  1296 active + 1871 blank = 3167 total
-	// Vert  rows:  972 active + 73 blank = 1045 total
-	// 
-	// Actual Frame Clocks: 3310344 clocks
-	// Row Time: 32.990 usec / 3167 clocks
-	// Frame time: 34.482750 msec
-	// Frames per Sec: 29 fps
-	// 
-	// 
-	// 
-	
-	
-	//[AR0542 (A-5141) Register Wizard Defaults]
+        // This file was generated by: AR0542 (A-5141) Register Wizard
+        //   Version: 4.5.13.36518    Build Date: 07/08/2013
+        //
+        // [PLL PARAMETERS]
+        //
+        // Bypass PLL: Unchecked
+        // Input Frequency: 24.000
+        // Use Min Freq.: Unchecked
+        // Target VT Frequency: 96.000
+        // Target op_sys_clk Frequency: Unspecified
+        //
+        // Target PLL VT Frequency: 96 MHz
+        // Target PLL OP Frequency: 96 MHz
+        // MT9P017 Input Clock Frequency: 24 MHz
+        // MT9P017 VT (Internal) Pixel Clock Frequency: 96 MHz
+        // MT9P017 OP (Output) Pixel Clock Frequency: 48 MHz
+        // pre_pll_clk_div = 2
+        // pll_multiplier = 40
+        // vt_sys_clk_div = 1
+        // vt_pix_clk_div = 5
+        // op_sys_clk_div = 1
+        // op_pix_clk_div = 10
+        // ip_clk = 12 MHz
+        // op_clk = 480 MHz
+        // op_sys_clk = 480 MHz
+        //
+        // [SENSOR PARAMETERS]
+        //
+        // Requested Frames Per Second: 29.000
+        // Output Columns: 1296
+        // Output Rows: 972
+        // Use Binning: Checked
+        // Allow Skipping: Unchecked
+        // Blanking Computation: HB Max then VB
+        //
+        // Max Frame Time: 34.4828 msec
+        // Max Frame Clocks: 3310344.8 clocks (96 MHz)
+        // Maximun Frame Rate: 54.554 fps
+        // Pixel Clock: divided by 1
+        // Skip Mode: 2x cols, 2x rows, Bin Mode: Yes
+        // Horiz clks:  1296 active + 1871 blank = 3167 total
+        // Vert  rows:  972 active + 73 blank = 1045 total
+        //
+        // Actual Frame Clocks: 3310344 clocks
+        // Row Time: 32.990 usec / 3167 clocks
+        // Frame time: 34.482750 msec
+        // Frames per Sec: 29 fps
+        //
+        //
+        //
+
+
+        //[AR0542 (A-5141) Register Wizard Defaults]
 #if 1
-	{2,0x0103, 0x01},    //SOFTWARE_RESET (clears itself)                               
-	{TIME_DELAY, 0, 5},      //Initialization Time                                      
-	                                                                                    
-	//stop_streaming                
-	                                                    
-	{1,0x0100, 0x00},    // MODE_SELECT                                                 
-	{2,0x301A, 0x0218},    //RESET_REGISTER enable mipi interface  bit[9] mask bad frame
-	{2,0x3064, 0xB800},    // SMIA_TEST                                                 
-	{2,0x31AE, 0x0202},    // two lane                                                  
-	{2,0x0112, 0x0A0A},    // 10bit raw output 
-	
-	                                         
-	{1,0x0300, 0x05},    //vt_pix_clk_div = 5                                           
-	{1,0x0302, 0x01},    //vt_sys_clk_div = 1                                           
-	{1,0x0304, 0x02},    //pre_pll_clk_div = 2                                          
-	{1,0x0306, 0x28},    //pll_multiplier    =  40                                      
-	{1,0x0308, 0x0A},    //op_pix_clk_div =  10                                         
-	{1,0x030A, 0x01},    //op_sys_clk_div = 1                                           
-	                                                                                    
-	  //stop_streaming                                                                  
-	{1,0x0100, 0x0 },    // MODE_SELECT                                                 
-	{1,0x0104, 0x01},    // GROUPED_PARAMETER_HOLD = 0x1                                
-	                                                                                    
-	//1296 x 972  Timing settings 30fps                                                 
-	{2,0x3064, 0xB800},    // SMIA_TEST                                                 
-	{2,0x31AE, 0x0202},    // two lane 201 tow 202                                      
-	{2,0x0112, 0x0A0A},    // 10bit raw output                                          
-	//PLL MCLK=24MHZ, PCLK = 96MHZ, VT = 96MHZ                                        
-	{1,0x0300, 0x05},    //vt_pix_clk_div = 5                                           
-	{1,0x0302, 0x01},    //vt_sys_clk_div = 1                                           
-	{1,0x0304, 0x02},    //pre_pll_clk_div = 2                                          
-	{1,0x0306, 0x28},    //pll_multiplier    =  40                                      
-	{1,0x0308, 0x0A},    //op_pix_clk_div =  10                                         
-	{1,0x030A, 0x01},    //op_sys_clk_div = 1      
-	
-	
-	
-	// Timing Settings
-	                                 
-	                                                                                    
-	{2,0x0344, 0x0008},    // X_ADDR_START   =  8                                       
-	{2,0x0346, 0x0008},    // Y_ADDR_START   =  8                                       
-	{2,0x0348, 0x0A25},    // X_ADDR_END      = 2597                                    
-	{2,0x034A, 0x079D},    // Y_ADDR_END       =  1949                                  
-	{2,0x3040, 0x84C3},    // READ_MODE  10 011 000011 xy binning enable xodd=3, yodd=3 
-	{2,0x034C, 0x0510},    // X_OUTPUT_SIZE    = 1296                                   
-	{2,0x034E, 0x03CC},    // Y_OUTPUT_SIZE    =  972    
-	                               
-	{2,0x300C, 0x0C5F},    // LINE_LENGTH  3151                                         
-	{2,0x300A, 0x0415},    // FRAME_LINEs  1100                                         
-	                                                                                    
-	{2,0x3014, 0x091B},    // fine_integration_time                                     
-	{2,0x3010, 0x0184},    // fine_correction                                           
-	{1,0x0104, 0x00},    // GROUPED_PARAMETER_HOLD                                      
-	                                                                                    
-	    //start_streaming                                                               
-	{1,0x0100, 0x01},    // MODE_SELECT    
+        {1,0x0103, 0x01},    //SOFTWARE_RESET (clears itself)
+        {TIME_DELAY, 0, 5},      //Initialization Time
+
+        //stop_streaming
+
+        {1,0x0100, 0x00},    // MODE_SELECT
+        //{2,0x301A, 0x0218},    //RESET_REGISTER enable mipi interface  bit[9] mask bad frame
+        {2,0x3064, 0xB800},    // SMIA_TEST
+        {2,0x31AE, 0x0202},    // two lane
+        {2,0x0112, 0x0A0A},    // 10bit raw output
+#if 1
+        //1.)    Add the ?¡ãRecommended Settings?¡À
+        //[=========== Recommended Settings ==============]
+        //[REV1_recommended_settings]
+        {2, 0x316A, 0x8400}, // RESERVED
+        {2, 0x316C, 0x8400}, // RESERVED
+        {2, 0x316E, 0x8400}, // RESERVED
+        {2, 0x3EFA, 0x1A1F}, // RESERVED
+        {2, 0x3ED2, 0xD965}, // RESERVED
+        {2, 0x3ED8, 0x7F1B}, // RESERVED
+        {2, 0x3EDA, 0x2F11}, // RESERVED
+        {2, 0x3EE2, 0x0060}, // RESERVED
+        {2, 0x3EF2, 0xD965}, // RESERVED
+        {2, 0x3EF8, 0x797F}, // RESERVED
+        {2, 0x3EFC, 0x286F}, // Customer_Request 35298
+        {2, 0x3EFE, 0x2C01},
+        //[REV1_pixel_timing]
+        // @00 Jump Table  // Customer_Request 35298 - Start
+        {2, 0x3E00, 0x042F},
+        {2, 0x3E02, 0xFFFF},
+        {2, 0x3E04, 0xFFFF},
+        {2, 0x3E06, 0xFFFF},
+        // @04 Read
+        {2, 0x3E08, 0x8071},
+        {2, 0x3E0A, 0x7281},
+        {2, 0x3E0C, 0x4011},
+        {2, 0x3E0E, 0x8010},
+        {2, 0x3E10, 0x60A5},
+        {2, 0x3E12, 0x4080},
+        {2, 0x3E14, 0x4180},
+        {2, 0x3E16, 0x0018},
+        {2, 0x3E18, 0x46B7},
+        {2, 0x3E1A, 0x4994},
+        {2, 0x3E1C, 0x4997},
+        {2, 0x3E1E, 0x4682},
+        {2, 0x3E20, 0x0018},
+        {2, 0x3E22, 0x4241},
+        {2, 0x3E24, 0x8000},
+        {2, 0x3E26, 0x1880},
+        {2, 0x3E28, 0x4785},
+        {2, 0x3E2A, 0x4992},
+        {2, 0x3E2C, 0x4997},
+        {2, 0x3E2E, 0x4780},
+        {2, 0x3E30, 0x4D80},
+        {2, 0x3E32, 0x100C},
+        {2, 0x3E34, 0x8000},
+        {2, 0x3E36, 0x184A},
+        {2, 0x3E38, 0x8042},
+        {2, 0x3E3A, 0x001A},
+        {2, 0x3E3C, 0x9610},
+        {2, 0x3E3E, 0x0C80},
+        {2, 0x3E40, 0x4DC6},
+        {2, 0x3E42, 0x4A80},
+        {2, 0x3E44, 0x0018},
+        {2, 0x3E46, 0x8042},
+        {2, 0x3E48, 0x8041},
+        {2, 0x3E4A, 0x0018},
+        {2, 0x3E4C, 0x804B},
+        {2, 0x3E4E, 0xB74B},
+        {2, 0x3E50, 0x8010},
+        {2, 0x3E52, 0x6056},
+        {2, 0x3E54, 0x001C},
+        {2, 0x3E56, 0x8211},
+        {2, 0x3E58, 0x8056},
+        {2, 0x3E5A, 0x827C},
+        {2, 0x3E5C, 0x0970},
+        {2, 0x3E5E, 0x8082},
+        {2, 0x3E60, 0x7281},
+        {2, 0x3E62, 0x4C40},
+        {2, 0x3E64, 0x8E4D},
+        {2, 0x3E66, 0x8110},
+        {2, 0x3E68, 0x0CAF},
+        {2, 0x3E6A, 0x4D80},
+        {2, 0x3E6C, 0x100C},
+        {2, 0x3E6E, 0x8440},
+        {2, 0x3E70, 0x4C81},
+        {2, 0x3E72, 0x7C5F},
+        {2, 0x3E74, 0x7000},
+        {2, 0x3E76, 0x0000},
+        {2, 0x3E78, 0x0000},
+        {2, 0x3E7A, 0x0000},
+        {2, 0x3E7C, 0x0000},
+        {2, 0x3E7E, 0x0000},
+        {2, 0x3E80, 0x0000},
+        {2, 0x3E82, 0x0000},
+        {2, 0x3E84, 0x0000},
+        {2, 0x3E86, 0x0000},
+        {2, 0x3E88, 0x0000},
+        {2, 0x3E8A, 0x0000},
+        {2, 0x3E8C, 0x0000},
+        {2, 0x3E8E, 0x0000},
+        {2, 0x3E90, 0x0000},
+        {2, 0x3E92, 0x0000},
+        {2, 0x3E94, 0x0000},
+        {2, 0x3E96, 0x0000},
+        {2, 0x3E98, 0x0000},
+        {2, 0x3E9A, 0x0000},
+        {2, 0x3E9C, 0x0000},
+        {2, 0x3E9E, 0x0000},
+        {2, 0x3EA0, 0x0000},
+        {2, 0x3EA2, 0x0000},
+        {2, 0x3EA4, 0x0000},
+        {2, 0x3EA6, 0x0000},
+        {2, 0x3EA8, 0x0000},
+        {2, 0x3EAA, 0x0000},
+        {2, 0x3EAC, 0x0000},
+        {2, 0x3EAE, 0x0000},
+        {2, 0x3EB0, 0x0000},
+        {2, 0x3EB2, 0x0000},
+        {2, 0x3EB4, 0x0000},
+        {2, 0x3EB6, 0x0000},
+        {2, 0x3EB8, 0x0000},
+        {2, 0x3EBA, 0x0000},
+        {2, 0x3EBC, 0x0000},
+        {2, 0x3EBE, 0x0000},
+        {2, 0x3EC0, 0x0000},
+        {2, 0x3EC2, 0x0000},
+        {2, 0x3EC4, 0x0000},
+        {2, 0x3EC6, 0x0000},
+        {2, 0x3EC8, 0x0000},
+        {2, 0x3ECA, 0x0000}, // Customer_Request 35298 - End
+
+        {2, 0x3170, 0x2150},
+        {2, 0x317A, 0x0150},
+        {2, 0x3ECC, 0x2200},
+        {2, 0x3174, 0x0000},
+        {2, 0x3176, 0X0000},
+        {2, 0x30BC, 0x0384},
+        {2, 0x30C0, 0x1220},
+        {2, 0x30D4, 0x9200},
+        {2, 0x30B2, 0xC000},
+        {2, 0x31B0, 0x00C4},
+        {2, 0x31B2, 0x0064},
+        {2, 0x31B4, 0x0E77},
+        {2, 0x31B6, 0x0D24},
+        {2, 0x31B8, 0x020E},
+        {2, 0x31BA, 0x0710},
+        {2, 0x31BC, 0x2A0D},
+        {2, 0x31BE, 0xC003},
+        {2, 0x3ECE, 0x000A}, // DAC_LD_2_3
+
+        //2.)    Add the 2DDC setting
+        // add 2DDC setting_05132014
+        // AR0543 ADACD and 2DDC settings
+        // updated June 2013--ADACD and 2DDC settings
+        // ADACD: low gain
+        {2, 0x3100, 0x0002},     // ADACD_CONTROL
+        {2, 0x3102, 0x0064},     // ADACD_NOISE_MODEL1
+        {2, 0x3104, 0x0B6D},     // ADACD_NOISE_MODEL2
+        {2, 0x3106, 0x0201},     // ADACD_NOISE_FLOOR1
+        {2, 0x3108, 0x0905},     // ADACD_NOISE_FLOOR2
+        {2, 0x310A, 0x002A},     // ADACD_PEDESTAL
+        //2DDC: low gain
+        {2, 0x31E0, 0x1F01},      // PIX_DEF_ID
+        {2, 0x3F02, 0x0001},      // PIX_DEF_2D_DDC_THRESH_HI3
+        {2, 0x3F04, 0x0032},      // PIX_DEF_2D_DDC_THRESH_LO3
+        {2, 0x3F06, 0x015E},      // PIX_DEF_2D_DDC_THRESH_HI4
+        {2, 0x3F08, 0x0190},      // PIX_DEF_2D_DDC_THRESH_LO4
+        //3.)    Add Minimum Analog Gain ( Normalized 1x Gain)
+        //>> Just test in normal light environment
+        // add Minimum Analog Gain
+        {2, 0x305E, 0x1127}, // GLOBAL_GAIN
 #endif
-	{END_OF_SCRIPT, 0, 0},
+
+        {1,0x0104, 0x01},    // GROUPED_PARAMETER_HOLD = 0x1
+#if 1 //85h lens shading
+        {2, 0x3780, 0x0000}, 	// POLY_SC_ENABLE
+        {2, 0x3600, 0x0170}, 	// P_GR_P0Q0
+        {2, 0x3602, 0x2348}, 	// P_GR_P0Q1
+        {2, 0x3604, 0x1D71}, 	// P_GR_P0Q2
+        {2, 0x3606, 0x2808}, 	// P_GR_P0Q3
+        {2, 0x3608, 0xC4B0}, 	// P_GR_P0Q4
+        {2, 0x360A, 0x0170}, 	// P_RD_P0Q0
+        {2, 0x360C, 0xC04C}, 	// P_RD_P0Q1
+        {2, 0x360E, 0x1CD1}, 	// P_RD_P0Q2
+        {2, 0x3610, 0x15EF}, 	// P_RD_P0Q3
+        {2, 0x3612, 0xFD30}, 	// P_RD_P0Q4
+        {2, 0x3614, 0x00D0}, 	// P_BL_P0Q0
+        {2, 0x3616, 0x64EA}, 	// P_BL_P0Q1
+        {2, 0x3618, 0x2FF0}, 	// P_BL_P0Q2
+        {2, 0x361A, 0xB6EE}, 	// P_BL_P0Q3
+        {2, 0x361C, 0xABCF}, 	// P_BL_P0Q4
+        {2, 0x361E, 0x01F0}, 	// P_GB_P0Q0
+        {2, 0x3620, 0xF76C}, 	// P_GB_P0Q1
+        {2, 0x3622, 0x2751}, 	// P_GB_P0Q2
+        {2, 0x3624, 0x0FAE}, 	// P_GB_P0Q3
+        {2, 0x3626, 0xFFD0}, 	// P_GB_P0Q4
+        {2, 0x3640, 0x80ED}, 	// P_GR_P1Q0
+        {2, 0x3642, 0x834E}, 	// P_GR_P1Q1
+        {2, 0x3644, 0x8AEF}, 	// P_GR_P1Q2
+        {2, 0x3646, 0x3DAC}, 	// P_GR_P1Q3
+        {2, 0x3648, 0x2D50}, 	// P_GR_P1Q4
+        {2, 0x364A, 0xF32C}, 	// P_RD_P1Q0
+        {2, 0x364C, 0x5ECE}, 	// P_RD_P1Q1
+        {2, 0x364E, 0x8B0E}, 	// P_RD_P1Q2
+        {2, 0x3650, 0xA7AF}, 	// P_RD_P1Q3
+        {2, 0x3652, 0x2A6F}, 	// P_RD_P1Q4
+        {2, 0x3654, 0xA2AC}, 	// P_BL_P1Q0
+        {2, 0x3656, 0x134E}, 	// P_BL_P1Q1
+        {2, 0x3658, 0x3E6E}, 	// P_BL_P1Q2
+        {2, 0x365A, 0xCF6D}, 	// P_BL_P1Q3
+        {2, 0x365C, 0xA1CE}, 	// P_BL_P1Q4
+        {2, 0x365E, 0x9D2C}, 	// P_GB_P1Q0
+        {2, 0x3660, 0xC0CE}, 	// P_GB_P1Q1
+        {2, 0x3662, 0x310E}, 	// P_GB_P1Q2
+        {2, 0x3664, 0x2B6E}, 	// P_GB_P1Q3
+        {2, 0x3666, 0xA46E}, 	// P_GB_P1Q4
+        {2, 0x3680, 0x25F1}, 	// P_GR_P2Q0
+        {2, 0x3682, 0x612E}, 	// P_GR_P2Q1
+        {2, 0x3684, 0x166F}, 	// P_GR_P2Q2
+        {2, 0x3686, 0x544E}, 	// P_GR_P2Q3
+        {2, 0x3688, 0x92D3}, 	// P_GR_P2Q4
+        {2, 0x368A, 0x4DB1}, 	// P_RD_P2Q0
+        {2, 0x368C, 0xFE2D}, 	// P_RD_P2Q1
+        {2, 0x368E, 0x39CE}, 	// P_RD_P2Q2
+        {2, 0x3690, 0xCACF}, 	// P_RD_P2Q3
+        {2, 0x3692, 0x8073}, 	// P_RD_P2Q4
+        {2, 0x3694, 0x7BD0}, 	// P_BL_P2Q0
+        {2, 0x3696, 0x1A2E}, 	// P_BL_P2Q1
+        {2, 0x3698, 0x4BEF}, 	// P_BL_P2Q2
+        {2, 0x369A, 0x2FF0}, 	// P_BL_P2Q3
+        {2, 0x369C, 0xB072}, 	// P_BL_P2Q4
+        {2, 0x369E, 0x1EB1}, 	// P_GB_P2Q0
+        {2, 0x36A0, 0xB10D}, 	// P_GB_P2Q1
+        {2, 0x36A2, 0x532E}, 	// P_GB_P2Q2
+        {2, 0x36A4, 0xDEEE}, 	// P_GB_P2Q3
+        {2, 0x36A6, 0xEC12}, 	// P_GB_P2Q4
+        {2, 0x36C0, 0x39EC}, 	// P_GR_P3Q0
+        {2, 0x36C2, 0x89CD}, 	// P_GR_P3Q1
+        {2, 0x36C4, 0x39D0}, 	// P_GR_P3Q2
+        {2, 0x36C6, 0x7E10}, 	// P_GR_P3Q3
+        {2, 0x36C8, 0xD031}, 	// P_GR_P3Q4
+        {2, 0x36CA, 0x3BAF}, 	// P_RD_P3Q0
+        {2, 0x36CC, 0xEC8D}, 	// P_RD_P3Q1
+        {2, 0x36CE, 0x448E}, 	// P_RD_P3Q2
+        {2, 0x36D0, 0x402F}, 	// P_RD_P3Q3
+        {2, 0x36D2, 0xD691}, 	// P_RD_P3Q4
+        {2, 0x36D4, 0x6D49}, 	// P_BL_P3Q0
+        {2, 0x36D6, 0xF42D}, 	// P_BL_P3Q1
+        {2, 0x36D8, 0x2FB0}, 	// P_BL_P3Q2
+        {2, 0x36DA, 0x598B}, 	// P_BL_P3Q3
+        {2, 0x36DC, 0xCE91}, 	// P_BL_P3Q4
+        {2, 0x36DE, 0x0E2C}, 	// P_GB_P3Q0
+        {2, 0x36E0, 0x1189}, 	// P_GB_P3Q1
+        {2, 0x36E2, 0x0571}, 	// P_GB_P3Q2
+        {2, 0x36E4, 0x1DD0}, 	// P_GB_P3Q3
+        {2, 0x36E6, 0x9CB2}, 	// P_GB_P3Q4
+        {2, 0x3700, 0xD830}, 	// P_GR_P4Q0
+        {2, 0x3702, 0x8D0D}, 	// P_GR_P4Q1
+        {2, 0x3704, 0xB9F3}, 	// P_GR_P4Q2
+        {2, 0x3706, 0x9CB1}, 	// P_GR_P4Q3
+        {2, 0x3708, 0x5CF3}, 	// P_GR_P4Q4
+        {2, 0x370A, 0x8291}, 	// P_RD_P4Q0
+        {2, 0x370C, 0x65EE}, 	// P_RD_P4Q1
+        {2, 0x370E, 0xEDD3}, 	// P_RD_P4Q2
+        {2, 0x3710, 0xD82E}, 	// P_RD_P4Q3
+        {2, 0x3712, 0x3D14}, 	// P_RD_P4Q4
+        {2, 0x3714, 0xA150}, 	// P_BL_P4Q0
+        {2, 0x3716, 0xB06F}, 	// P_BL_P4Q1
+        {2, 0x3718, 0xFC12}, 	// P_BL_P4Q2
+        {2, 0x371A, 0x9170}, 	// P_BL_P4Q3
+        {2, 0x371C, 0x07B3}, 	// P_BL_P4Q4
+        {2, 0x371E, 0x9E90}, 	// P_GB_P4Q0
+        {2, 0x3720, 0xBD8B}, 	// P_GB_P4Q1
+        {2, 0x3722, 0xB413}, 	// P_GB_P4Q2
+        {2, 0x3724, 0x1611}, 	// P_GB_P4Q3
+        {2, 0x3726, 0x1B53}, 	// P_GB_P4Q4
+        {2, 0x3782, 0x04F4}, 	// POLY_ORIGIN_C
+        {2, 0x3784, 0x03C8}, 	// POLY_ORIGIN_R
+        {2, 0x37C0, 0x3E29}, 	// P_GR_Q5
+        {2, 0x37C2, 0x0FC8}, 	// P_RD_Q5
+        {2, 0x37C4, 0x0F2A}, 	// P_BL_Q5
+        {2, 0x37C6, 0x5209}, 	// P_GB_Q5
+        {2, 0x3780, 0x8000}, 	// POLY_SC_ENABLE
+#endif
+
+
+        //1296 x 972  Timing settings 30fps
+        {2,0x3064, 0xB800},    // SMIA_TEST
+        {2,0x31AE, 0x0202},    // two lane 201 tow 202
+        {2,0x0112, 0x0A0A},    // 10bit raw output
+        //PLL MCLK=24MHZ, PCLK = 96MHZ, VT = 96MHZ
+        {2,0x0300, 0x05},    //vt_pix_clk_div = 5
+        {2,0x0302, 0x01},    //vt_sys_clk_div = 1
+        {2,0x0304, 0x02},    //pre_pll_clk_div = 2
+        {2,0x0306, 0x53},    //pll_multiplier    =  40
+        {2,0x0308, 0x0A},    //op_pix_clk_div =  10
+        {2,0x030A, 0x01},    //op_sys_clk_div = 1
+
+
+
+        // Timing Settings
+
+
+        {2,0x0344, 0x0008},    // X_ADDR_START   =  8
+        {2,0x0346, 0x0008},    // Y_ADDR_START   =  8
+        {2,0x0348, 0x0A25},    // X_ADDR_END      = 2597
+        {2,0x034A, 0x079D},    // Y_ADDR_END       =  1949
+        {2,0x3040, 0x84C3},    // READ_MODE  10 011 000011 xy binning enable xodd=3, yodd=3
+        {2,0x034C, 0x0510},    // X_OUTPUT_SIZE    = 1296
+        {2,0x034E, 0x03CC},    // Y_OUTPUT_SIZE    =  972
+
+        {2,0x300C, 0x0C5F},    // LINE_LENGTH  3151
+        {2,0x300A, 0x0415},    // FRAME_LINEs  1100
+
+        {2,0x3014, 0x091B},    // fine_integration_time
+        {2,0x3010, 0x0184},    // fine_correction
+        {1,0x0104, 0x00},    // GROUPED_PARAMETER_HOLD
+
+        //start_streaming
+        {1,0x0100, 0x01},    // MODE_SELECT
+#endif
+        {END_OF_SCRIPT, 0, 0},
 
 };
 
 static cam_i2c_msg_t AR0543_preview_1080P_script[] = {
-	{END_OF_SCRIPT, 0, 0},
+        {END_OF_SCRIPT, 0, 0},
 };
 
 static cam_i2c_msg_t AR0543_1080P_script_mipi[] = {
-// This file was generated by: AR0542 (A-5141) Register Wizard
-//   Version: 4.5.13.36518    Build Date: 07/08/2013
-// 
-// [PLL PARAMETERS]
-// 
-// Bypass PLL: Unchecked
-// Input Frequency: 24.000
-// Use Min Freq.: Unchecked
-// Target VT Frequency: 96.000
-// Target op_sys_clk Frequency: Unspecified
-// 
-// Target PLL VT Frequency: 96 MHz
-// Target PLL OP Frequency: 96 MHz
-// MT9P017 Input Clock Frequency: 24 MHz
-// MT9P017 VT (Internal) Pixel Clock Frequency: 96 MHz
-// MT9P017 OP (Output) Pixel Clock Frequency: 48 MHz
-// pre_pll_clk_div = 2
-// pll_multiplier = 40
-// vt_sys_clk_div = 1
-// vt_pix_clk_div = 5
-// op_sys_clk_div = 1
-// op_pix_clk_div = 10
-// ip_clk = 12 MHz
-// op_clk = 480 MHz
-// op_sys_clk = 480 MHz
-// 
-// [SENSOR PARAMETERS]
-// 
-// Requested Frames Per Second: 27.000
-// Output Columns: 1920
-// Output Rows: 1080
-// Use Binning: Unchecked
-// Allow Skipping: Unchecked
-// Blanking Computation: HB Max then VB
-// 
-// Max Frame Time: 37.037 msec
-// Max Frame Clocks: 3555555.5 clocks (96 MHz)
-// Maximun Frame Rate: 27.456 fps
-// Pixel Clock: divided by 1
-// Skip Mode: 1x cols, 1x rows, Bin Mode: No
-// Horiz clks:  1920 active + 1153 blank = 3073 total
-// Vert  rows:  1080 active + 77 blank = 1157 total
-// 
-// Actual Frame Clocks: 3555555 clocks
-// Row Time: 32.010 usec / 3073 clocks
-// Frame time: 37.037031 msec
-// Frames per Sec: 27 fps
-// 
-// 
-// 
-
-
-
-//[AR0542 (A-5141) Register Wizard Defaults]
-
-
-
-	{2,0x0103, 0x01},    //SOFTWARE_RESET (clears itself)                               
-	{TIME_DELAY, 0, 5},      //Initialization Time                                      
-	                                                                                    
-	//stop_streaming                                                                    
-	{2,0x0100, 0x00},    // MODE_SELECT                                                 
-	{2,0x301A, 0x0218},    //RESET_REGISTER enable mipi interface  bit[9] mask bad frame
-	{2,0x3064, 0xB800},    // SMIA_TEST                                                 
-	{2,0x31AE, 0x0202},    // two lane                                                  
-	{2,0x0112, 0x0A0A},    // 10bit raw output                                          
-	{1,0x0300, 0x05},    //vt_pix_clk_div = 5                                           
-	{1,0x0302, 0x01},    //vt_sys_clk_div = 1                                           
-	{1,0x0304, 0x02},    //pre_pll_clk_div = 2                                          
-	{1,0x0306, 0x28},    //pll_multiplier    =  40                                      
-	{1,0x0308, 0x0A},    //op_pix_clk_div =  10                                         
-	{1,0x030A, 0x01},    //op_sys_clk_div = 1                                           
-	                                                                                    
-	  //stop_streaming                                                                  
-	{1,0x0100, 0x0 },    // MODE_SELECT                                                 
-	{1,0x0104, 0x01},    // GROUPED_PARAMETER_HOLD = 0x1                                
-	                                                                                    
-	//1296 x 972  Timing settings 30fps                                                 
-	{2,0x3064, 0xB800},    // SMIA_TEST                                                 
-	{2,0x31AE, 0x0202},    // two lane 201 tow 202                                      
-	{2,0x0112, 0x0A0A},    // 10bit raw output                                          
-	//PLL MCLK=26MHZ, PCLK = 104MHZ, VT = 104MHZ                                        
-	{1,0x0300, 0x05},    //vt_pix_clk_div = 5                                           
-	{1,0x0302, 0x01},    //vt_sys_clk_div = 1                                           
-	{1,0x0304, 0x02},    //pre_pll_clk_div = 2                                          
-	{1,0x0306, 0x28},    //pll_multiplier    =  40                                      
-	{1,0x0308, 0x0A},    //op_pix_clk_div =  10                                         
-	{1,0x030A, 0x01},    //op_sys_clk_div = 1                                           
-	                                                                                    
-	{2,0x0344, 0x0158},    // X_ADDR_START   =  8                                       
-	{2,0x0346, 0x01B8},    // Y_ADDR_START   =  8                                       
-	{2,0x0348, 0x08D7},    // X_ADDR_END      = 2597                                    
-	{2,0x034A, 0x05EF},    // Y_ADDR_END       =  1949                                  
-	{2,0x3040, 0x8041},    // READ_MODE  10 011 000011 xy binning enable xodd=3, yodd=3 
-	{2,0x034C, 0x0780},    // X_OUTPUT_SIZE    = 1296                                   
-	{2,0x034E, 0x0438},    // Y_OUTPUT_SIZE    =  972                                   
-	{2,0x300C, 0x0C01},    // LINE_LENGTH  3151                                         
-	{2,0x300A, 0x0485},    // FRAME_LINEs  1100                                         
-	                                                                                    
-	{2,0x3014, 0x0A1F},    // fine_integration_time                                     
-	{2,0x3010, 0x00A0},    // fine_correction                                           
-	{1,0x0104, 0x00},    // GROUPED_PARAMETER_HOLD                                      
-	                                                                                    
-	    //start_streaming                                                               
-	{1,0x0100, 0x01},    // MODE_SELECT    
-	{END_OF_SCRIPT, 0, 0},
+        // This file was generated by: AR0542 (A-5141) Register Wizard
+        //   Version: 4.5.13.36518    Build Date: 07/08/2013
+        //
+        // [PLL PARAMETERS]
+        //
+        // Bypass PLL: Unchecked
+        // Input Frequency: 24.000
+        // Use Min Freq.: Unchecked
+        // Target VT Frequency: 96.000
+        // Target op_sys_clk Frequency: Unspecified
+        //
+        // Target PLL VT Frequency: 96 MHz
+        // Target PLL OP Frequency: 96 MHz
+        // MT9P017 Input Clock Frequency: 24 MHz
+        // MT9P017 VT (Internal) Pixel Clock Frequency: 96 MHz
+        // MT9P017 OP (Output) Pixel Clock Frequency: 48 MHz
+        // pre_pll_clk_div = 2
+        // pll_multiplier = 40
+        // vt_sys_clk_div = 1
+        // vt_pix_clk_div = 5
+        // op_sys_clk_div = 1
+        // op_pix_clk_div = 10
+        // ip_clk = 12 MHz
+        // op_clk = 480 MHz
+        // op_sys_clk = 480 MHz
+        //
+        // [SENSOR PARAMETERS]
+        //
+        // Requested Frames Per Second: 27.000
+        // Output Columns: 1920
+        // Output Rows: 1080
+        // Use Binning: Unchecked
+        // Allow Skipping: Unchecked
+        // Blanking Computation: HB Max then VB
+        //
+        // Max Frame Time: 37.037 msec
+        // Max Frame Clocks: 3555555.5 clocks (96 MHz)
+        // Maximun Frame Rate: 27.456 fps
+        // Pixel Clock: divided by 1
+        // Skip Mode: 1x cols, 1x rows, Bin Mode: No
+        // Horiz clks:  1920 active + 1153 blank = 3073 total
+        // Vert  rows:  1080 active + 77 blank = 1157 total
+        //
+        // Actual Frame Clocks: 3555555 clocks
+        // Row Time: 32.010 usec / 3073 clocks
+        // Frame time: 37.037031 msec
+        // Frames per Sec: 27 fps
+        //
+        //
+        //
+
+
+
+        //[AR0542 (A-5141) Register Wizard Defaults]
+
+
+
+        {1,0x0103, 0x01},    //SOFTWARE_RESET (clears itself)
+        {TIME_DELAY, 0, 5},      //Initialization Time
+
+        //stop_streaming
+        {1,0x0100, 0x00},    // MODE_SELECT
+        {2,0x301A, 0x0218},    //RESET_REGISTER enable mipi interface  bit[9] mask bad frame
+        {2,0x3064, 0xB800},    // SMIA_TEST
+        {2,0x31AE, 0x0202},    // two lane
+        {2,0x0112, 0x0A0A},    // 10bit raw output
+        //Silicon Recommendation
+#if 1
+        //1.)    Add the ?¡ãRecommended Settings?¡À
+        //[=========== Recommended Settings ==============]
+        //[REV1_recommended_settings]
+        {2, 0x316A, 0x8400}, // RESERVED
+        {2, 0x316C, 0x8400}, // RESERVED
+        {2, 0x316E, 0x8400}, // RESERVED
+        {2, 0x3EFA, 0x1A1F}, // RESERVED
+        {2, 0x3ED2, 0xD965}, // RESERVED
+        {2, 0x3ED8, 0x7F1B}, // RESERVED
+        {2, 0x3EDA, 0x2F11}, // RESERVED
+        {2, 0x3EE2, 0x0060}, // RESERVED
+        {2, 0x3EF2, 0xD965}, // RESERVED
+        {2, 0x3EF8, 0x797F}, // RESERVED
+        {2, 0x3EFC, 0x286F}, // Customer_Request 35298
+        {2, 0x3EFE, 0x2C01},
+        //[REV1_pixel_timing]
+        // @00 Jump Table  // Customer_Request 35298 - Start
+        {2, 0x3E00, 0x042F},
+        {2, 0x3E02, 0xFFFF},
+        {2, 0x3E04, 0xFFFF},
+        {2, 0x3E06, 0xFFFF},
+        // @04 Read
+        {2, 0x3E08, 0x8071},
+        {2, 0x3E0A, 0x7281},
+        {2, 0x3E0C, 0x4011},
+        {2, 0x3E0E, 0x8010},
+        {2, 0x3E10, 0x60A5},
+        {2, 0x3E12, 0x4080},
+        {2, 0x3E14, 0x4180},
+        {2, 0x3E16, 0x0018},
+        {2, 0x3E18, 0x46B7},
+        {2, 0x3E1A, 0x4994},
+        {2, 0x3E1C, 0x4997},
+        {2, 0x3E1E, 0x4682},
+        {2, 0x3E20, 0x0018},
+        {2, 0x3E22, 0x4241},
+        {2, 0x3E24, 0x8000},
+        {2, 0x3E26, 0x1880},
+        {2, 0x3E28, 0x4785},
+        {2, 0x3E2A, 0x4992},
+        {2, 0x3E2C, 0x4997},
+        {2, 0x3E2E, 0x4780},
+        {2, 0x3E30, 0x4D80},
+        {2, 0x3E32, 0x100C},
+        {2, 0x3E34, 0x8000},
+        {2, 0x3E36, 0x184A},
+        {2, 0x3E38, 0x8042},
+        {2, 0x3E3A, 0x001A},
+        {2, 0x3E3C, 0x9610},
+        {2, 0x3E3E, 0x0C80},
+        {2, 0x3E40, 0x4DC6},
+        {2, 0x3E42, 0x4A80},
+        {2, 0x3E44, 0x0018},
+        {2, 0x3E46, 0x8042},
+        {2, 0x3E48, 0x8041},
+        {2, 0x3E4A, 0x0018},
+        {2, 0x3E4C, 0x804B},
+        {2, 0x3E4E, 0xB74B},
+        {2, 0x3E50, 0x8010},
+        {2, 0x3E52, 0x6056},
+        {2, 0x3E54, 0x001C},
+        {2, 0x3E56, 0x8211},
+        {2, 0x3E58, 0x8056},
+        {2, 0x3E5A, 0x827C},
+        {2, 0x3E5C, 0x0970},
+        {2, 0x3E5E, 0x8082},
+        {2, 0x3E60, 0x7281},
+        {2, 0x3E62, 0x4C40},
+        {2, 0x3E64, 0x8E4D},
+        {2, 0x3E66, 0x8110},
+        {2, 0x3E68, 0x0CAF},
+        {2, 0x3E6A, 0x4D80},
+        {2, 0x3E6C, 0x100C},
+        {2, 0x3E6E, 0x8440},
+        {2, 0x3E70, 0x4C81},
+        {2, 0x3E72, 0x7C5F},
+        {2, 0x3E74, 0x7000},
+        {2, 0x3E76, 0x0000},
+        {2, 0x3E78, 0x0000},
+        {2, 0x3E7A, 0x0000},
+        {2, 0x3E7C, 0x0000},
+        {2, 0x3E7E, 0x0000},
+        {2, 0x3E80, 0x0000},
+        {2, 0x3E82, 0x0000},
+        {2, 0x3E84, 0x0000},
+        {2, 0x3E86, 0x0000},
+        {2, 0x3E88, 0x0000},
+        {2, 0x3E8A, 0x0000},
+        {2, 0x3E8C, 0x0000},
+        {2, 0x3E8E, 0x0000},
+        {2, 0x3E90, 0x0000},
+        {2, 0x3E92, 0x0000},
+        {2, 0x3E94, 0x0000},
+        {2, 0x3E96, 0x0000},
+        {2, 0x3E98, 0x0000},
+        {2, 0x3E9A, 0x0000},
+        {2, 0x3E9C, 0x0000},
+        {2, 0x3E9E, 0x0000},
+        {2, 0x3EA0, 0x0000},
+        {2, 0x3EA2, 0x0000},
+        {2, 0x3EA4, 0x0000},
+        {2, 0x3EA6, 0x0000},
+        {2, 0x3EA8, 0x0000},
+        {2, 0x3EAA, 0x0000},
+        {2, 0x3EAC, 0x0000},
+        {2, 0x3EAE, 0x0000},
+        {2, 0x3EB0, 0x0000},
+        {2, 0x3EB2, 0x0000},
+        {2, 0x3EB4, 0x0000},
+        {2, 0x3EB6, 0x0000},
+        {2, 0x3EB8, 0x0000},
+        {2, 0x3EBA, 0x0000},
+        {2, 0x3EBC, 0x0000},
+        {2, 0x3EBE, 0x0000},
+        {2, 0x3EC0, 0x0000},
+        {2, 0x3EC2, 0x0000},
+        {2, 0x3EC4, 0x0000},
+        {2, 0x3EC6, 0x0000},
+        {2, 0x3EC8, 0x0000},
+        {2, 0x3ECA, 0x0000}, // Customer_Request 35298 - End
+
+        {2, 0x3170, 0x2150},
+        {2, 0x317A, 0x0150},
+        {2, 0x3ECC, 0x2200},
+        {2, 0x3174, 0x0000},
+        {2, 0x3176, 0X0000},
+        {2, 0x30BC, 0x0384},
+        {2, 0x30C0, 0x1220},
+        {2, 0x30D4, 0x9200},
+        {2, 0x30B2, 0xC000},
+        {2, 0x31B0, 0x00C4},
+        {2, 0x31B2, 0x0064},
+        {2, 0x31B4, 0x0E77},
+        {2, 0x31B6, 0x0D24},
+        {2, 0x31B8, 0x020E},
+        {2, 0x31BA, 0x0710},
+        {2, 0x31BC, 0x2A0D},
+        {2, 0x31BE, 0xC003},
+        {2, 0x3ECE, 0x000A}, // DAC_LD_2_3
+
+        //2.)    Add the 2DDC setting
+        // add 2DDC setting_05132014
+        // AR0543 ADACD and 2DDC settings
+        // updated June 2013--ADACD and 2DDC settings
+        // ADACD: low gain
+        {2, 0x3100, 0x0002},     // ADACD_CONTROL
+        {2, 0x3102, 0x0064},     // ADACD_NOISE_MODEL1
+        {2, 0x3104, 0x0B6D},     // ADACD_NOISE_MODEL2
+        {2, 0x3106, 0x0201},     // ADACD_NOISE_FLOOR1
+        {2, 0x3108, 0x0905},     // ADACD_NOISE_FLOOR2
+        {2, 0x310A, 0x002A},     // ADACD_PEDESTAL
+        //2DDC: low gain
+        {2, 0x31E0, 0x1F01},      // PIX_DEF_ID
+        {2, 0x3F02, 0x0001},      // PIX_DEF_2D_DDC_THRESH_HI3
+        {2, 0x3F04, 0x0032},      // PIX_DEF_2D_DDC_THRESH_LO3
+        {2, 0x3F06, 0x015E},      // PIX_DEF_2D_DDC_THRESH_HI4
+        {2, 0x3F08, 0x0190},      // PIX_DEF_2D_DDC_THRESH_LO4
+        //3.)    Add Minimum Analog Gain ( Normalized 1x Gain)
+        //>> Just test in normal light environment
+        // add Minimum Analog Gain
+        {2, 0x305E, 0x1127}, // GLOBAL_GAIN
+#endif
+        {1,0x0104, 0x01},    // GROUPED_PARAMETER_HOLD = 0x1
+#if 1 //85h lens shading
+        {2, 0x3780, 0x0000}, 	// POLY_SC_ENABLE
+        {2, 0x3600, 0x0170}, 	// P_GR_P0Q0
+        {2, 0x3602, 0x2348}, 	// P_GR_P0Q1
+        {2, 0x3604, 0x1D71}, 	// P_GR_P0Q2
+        {2, 0x3606, 0x2808}, 	// P_GR_P0Q3
+        {2, 0x3608, 0xC4B0}, 	// P_GR_P0Q4
+        {2, 0x360A, 0x0170}, 	// P_RD_P0Q0
+        {2, 0x360C, 0xC04C}, 	// P_RD_P0Q1
+        {2, 0x360E, 0x1CD1}, 	// P_RD_P0Q2
+        {2, 0x3610, 0x15EF}, 	// P_RD_P0Q3
+        {2, 0x3612, 0xFD30}, 	// P_RD_P0Q4
+        {2, 0x3614, 0x00D0}, 	// P_BL_P0Q0
+        {2, 0x3616, 0x64EA}, 	// P_BL_P0Q1
+        {2, 0x3618, 0x2FF0}, 	// P_BL_P0Q2
+        {2, 0x361A, 0xB6EE}, 	// P_BL_P0Q3
+        {2, 0x361C, 0xABCF}, 	// P_BL_P0Q4
+        {2, 0x361E, 0x01F0}, 	// P_GB_P0Q0
+        {2, 0x3620, 0xF76C}, 	// P_GB_P0Q1
+        {2, 0x3622, 0x2751}, 	// P_GB_P0Q2
+        {2, 0x3624, 0x0FAE}, 	// P_GB_P0Q3
+        {2, 0x3626, 0xFFD0}, 	// P_GB_P0Q4
+        {2, 0x3640, 0x80ED}, 	// P_GR_P1Q0
+        {2, 0x3642, 0x834E}, 	// P_GR_P1Q1
+        {2, 0x3644, 0x8AEF}, 	// P_GR_P1Q2
+        {2, 0x3646, 0x3DAC}, 	// P_GR_P1Q3
+        {2, 0x3648, 0x2D50}, 	// P_GR_P1Q4
+        {2, 0x364A, 0xF32C}, 	// P_RD_P1Q0
+        {2, 0x364C, 0x5ECE}, 	// P_RD_P1Q1
+        {2, 0x364E, 0x8B0E}, 	// P_RD_P1Q2
+        {2, 0x3650, 0xA7AF}, 	// P_RD_P1Q3
+        {2, 0x3652, 0x2A6F}, 	// P_RD_P1Q4
+        {2, 0x3654, 0xA2AC}, 	// P_BL_P1Q0
+        {2, 0x3656, 0x134E}, 	// P_BL_P1Q1
+        {2, 0x3658, 0x3E6E}, 	// P_BL_P1Q2
+        {2, 0x365A, 0xCF6D}, 	// P_BL_P1Q3
+        {2, 0x365C, 0xA1CE}, 	// P_BL_P1Q4
+        {2, 0x365E, 0x9D2C}, 	// P_GB_P1Q0
+        {2, 0x3660, 0xC0CE}, 	// P_GB_P1Q1
+        {2, 0x3662, 0x310E}, 	// P_GB_P1Q2
+        {2, 0x3664, 0x2B6E}, 	// P_GB_P1Q3
+        {2, 0x3666, 0xA46E}, 	// P_GB_P1Q4
+        {2, 0x3680, 0x25F1}, 	// P_GR_P2Q0
+        {2, 0x3682, 0x612E}, 	// P_GR_P2Q1
+        {2, 0x3684, 0x166F}, 	// P_GR_P2Q2
+        {2, 0x3686, 0x544E}, 	// P_GR_P2Q3
+        {2, 0x3688, 0x92D3}, 	// P_GR_P2Q4
+        {2, 0x368A, 0x4DB1}, 	// P_RD_P2Q0
+        {2, 0x368C, 0xFE2D}, 	// P_RD_P2Q1
+        {2, 0x368E, 0x39CE}, 	// P_RD_P2Q2
+        {2, 0x3690, 0xCACF}, 	// P_RD_P2Q3
+        {2, 0x3692, 0x8073}, 	// P_RD_P2Q4
+        {2, 0x3694, 0x7BD0}, 	// P_BL_P2Q0
+        {2, 0x3696, 0x1A2E}, 	// P_BL_P2Q1
+        {2, 0x3698, 0x4BEF}, 	// P_BL_P2Q2
+        {2, 0x369A, 0x2FF0}, 	// P_BL_P2Q3
+        {2, 0x369C, 0xB072}, 	// P_BL_P2Q4
+        {2, 0x369E, 0x1EB1}, 	// P_GB_P2Q0
+        {2, 0x36A0, 0xB10D}, 	// P_GB_P2Q1
+        {2, 0x36A2, 0x532E}, 	// P_GB_P2Q2
+        {2, 0x36A4, 0xDEEE}, 	// P_GB_P2Q3
+        {2, 0x36A6, 0xEC12}, 	// P_GB_P2Q4
+        {2, 0x36C0, 0x39EC}, 	// P_GR_P3Q0
+        {2, 0x36C2, 0x89CD}, 	// P_GR_P3Q1
+        {2, 0x36C4, 0x39D0}, 	// P_GR_P3Q2
+        {2, 0x36C6, 0x7E10}, 	// P_GR_P3Q3
+        {2, 0x36C8, 0xD031}, 	// P_GR_P3Q4
+        {2, 0x36CA, 0x3BAF}, 	// P_RD_P3Q0
+        {2, 0x36CC, 0xEC8D}, 	// P_RD_P3Q1
+        {2, 0x36CE, 0x448E}, 	// P_RD_P3Q2
+        {2, 0x36D0, 0x402F}, 	// P_RD_P3Q3
+        {2, 0x36D2, 0xD691}, 	// P_RD_P3Q4
+        {2, 0x36D4, 0x6D49}, 	// P_BL_P3Q0
+        {2, 0x36D6, 0xF42D}, 	// P_BL_P3Q1
+        {2, 0x36D8, 0x2FB0}, 	// P_BL_P3Q2
+        {2, 0x36DA, 0x598B}, 	// P_BL_P3Q3
+        {2, 0x36DC, 0xCE91}, 	// P_BL_P3Q4
+        {2, 0x36DE, 0x0E2C}, 	// P_GB_P3Q0
+        {2, 0x36E0, 0x1189}, 	// P_GB_P3Q1
+        {2, 0x36E2, 0x0571}, 	// P_GB_P3Q2
+        {2, 0x36E4, 0x1DD0}, 	// P_GB_P3Q3
+        {2, 0x36E6, 0x9CB2}, 	// P_GB_P3Q4
+        {2, 0x3700, 0xD830}, 	// P_GR_P4Q0
+        {2, 0x3702, 0x8D0D}, 	// P_GR_P4Q1
+        {2, 0x3704, 0xB9F3}, 	// P_GR_P4Q2
+        {2, 0x3706, 0x9CB1}, 	// P_GR_P4Q3
+        {2, 0x3708, 0x5CF3}, 	// P_GR_P4Q4
+        {2, 0x370A, 0x8291}, 	// P_RD_P4Q0
+        {2, 0x370C, 0x65EE}, 	// P_RD_P4Q1
+        {2, 0x370E, 0xEDD3}, 	// P_RD_P4Q2
+        {2, 0x3710, 0xD82E}, 	// P_RD_P4Q3
+        {2, 0x3712, 0x3D14}, 	// P_RD_P4Q4
+        {2, 0x3714, 0xA150}, 	// P_BL_P4Q0
+        {2, 0x3716, 0xB06F}, 	// P_BL_P4Q1
+        {2, 0x3718, 0xFC12}, 	// P_BL_P4Q2
+        {2, 0x371A, 0x9170}, 	// P_BL_P4Q3
+        {2, 0x371C, 0x07B3}, 	// P_BL_P4Q4
+        {2, 0x371E, 0x9E90}, 	// P_GB_P4Q0
+        {2, 0x3720, 0xBD8B}, 	// P_GB_P4Q1
+        {2, 0x3722, 0xB413}, 	// P_GB_P4Q2
+        {2, 0x3724, 0x1611}, 	// P_GB_P4Q3
+        {2, 0x3726, 0x1B53}, 	// P_GB_P4Q4
+        {2, 0x3782, 0x04F4}, 	// POLY_ORIGIN_C
+        {2, 0x3784, 0x03C8}, 	// POLY_ORIGIN_R
+        {2, 0x37C0, 0x3E29}, 	// P_GR_Q5
+        {2, 0x37C2, 0x0FC8}, 	// P_RD_Q5
+        {2, 0x37C4, 0x0F2A}, 	// P_BL_Q5
+        {2, 0x37C6, 0x5209}, 	// P_GB_Q5
+        {2, 0x3780, 0x8000}, 	// POLY_SC_ENABLE
+#endif
+        //REG= 0x301C, 0x01 	//Turn-on streamming
+
+
+        //1296 x 972  Timing settings 30fps
+        {2,0x3064, 0xB800},    // SMIA_TEST
+        {2,0x31AE, 0x0202},    // two lane 201 tow 202
+        {2,0x0112, 0x0A0A},    // 10bit raw output
+        //PLL MCLK=26MHZ, PCLK = 104MHZ, VT = 104MHZ
+        {2,0x0300, 0x05},    //vt_pix_clk_div = 5
+        {2,0x0302, 0x01},    //vt_sys_clk_div = 1
+        {2,0x0304, 0x02},    //pre_pll_clk_div = 2
+        {2,0x0306, 0x5A},    //pll_multiplier    =  40
+        {2,0x0308, 0x0A},    //op_pix_clk_div =  10
+        {2,0x030A, 0x01},    //op_sys_clk_div = 1
+
+        {2,0x0344, 0x0158},    // X_ADDR_START   =  8
+        {2,0x0346, 0x01B8},    // Y_ADDR_START   =  8
+        {2,0x0348, 0x08D7},    // X_ADDR_END      = 2597
+        {2,0x034A, 0x05EF},    // Y_ADDR_END       =  1949
+        {2,0x3040, 0x8041},    // READ_MODE  10 011 000011 xy binning enable xodd=3, yodd=3
+        {2,0x034C, 0x0780},    // X_OUTPUT_SIZE    = 1296
+        {2,0x034E, 0x0438},    // Y_OUTPUT_SIZE    =  972
+        {2,0x300C, 0x0C01},    // LINE_LENGTH  3151
+        {2,0x300A, 0x0485},    // FRAME_LINEs  1100
+
+        {2,0x3014, 0x0A1F},    // fine_integration_time
+        {2,0x3010, 0x00A0},    // fine_correction
+        {1,0x0104, 0x00},    // GROUPED_PARAMETER_HOLD
+
+        //start_streaming
+        {1,0x0100, 0x01},    // MODE_SELECT
+        {END_OF_SCRIPT, 0, 0},
 };
 
 static cam_i2c_msg_t AR0543_capture_5M_script[] = {
-	{END_OF_SCRIPT, 0, 0},
+        {END_OF_SCRIPT, 0, 0},
 };
 
 static cam_i2c_msg_t AR0543_5M_script_mipi[] = {
-// This file was generated by: AR0542 (A-5141) Register Wizard
-//   Version: 4.5.13.36518    Build Date: 07/08/2013
-// 
-// [PLL PARAMETERS]
-// 
-// Bypass PLL: Unchecked
-// Input Frequency: 24.000
-// Use Min Freq.: Unchecked
-// Target VT Frequency: 96.000
-// Target op_sys_clk Frequency: Unspecified
-// 
-// Target PLL VT Frequency: 96 MHz
-// Target PLL OP Frequency: 76.800 MHz
-// MT9P017 Input Clock Frequency: 24 MHz
-// MT9P017 VT (Internal) Pixel Clock Frequency: 96 MHz
-// MT9P017 OP (Output) Pixel Clock Frequency: 76.800 MHz
-// pre_pll_clk_div = 2
-// pll_multiplier = 64
-// vt_sys_clk_div = 1
-// vt_pix_clk_div = 8
-// op_sys_clk_div = 1
-// op_pix_clk_div = 10
-// ip_clk = 12 MHz
-// op_clk = 768 MHz
-// op_sys_clk = 768 MHz
-// 
-// [SENSOR PARAMETERS]
-// 
-// Requested Frames Per Second: 12.250
-// Output Columns: 2592
-// Output Rows: 1944
-// Use Binning: Unchecked
-// Allow Skipping: Unchecked
-// Blanking Computation: HB Max then VB
-// 
-// Max Frame Time: 81.6327 msec
-// Max Frame Clocks: 7836734.6 clocks (96 MHz)
-// Maximun Frame Rate: 12.859 fps
-// Pixel Clock: divided by 1
-// Skip Mode: 1x cols, 1x rows, Bin Mode: No
-// Horiz clks:  2592 active + 1285 blank = 3877 total
-// Vert  rows:  1944 active + 77 blank = 2021 total
-// 
-// Actual Frame Clocks: 7836734 clocks
-// Row Time: 40.385 usec / 3877 clocks
-// Frame time: 81.632646 msec
-// Frames per Sec: 12.250 fps
- 
-	{1,0x0103, 0x01},    //SOFTWARE_RESET (clears itself)
-	{TIME_DELAY, 0, 5},      //Initialization Time
+        // This file was generated by: AR0542 (A-5141) Register Wizard
+        //   Version: 4.5.13.36518    Build Date: 07/08/2013
+        //
+        // [PLL PARAMETERS]
+        //
+        // Bypass PLL: Unchecked
+        // Input Frequency: 24.000
+        // Use Min Freq.: Unchecked
+        // Target VT Frequency: 96.000
+        // Target op_sys_clk Frequency: Unspecified
+        //
+        // Target PLL VT Frequency: 96 MHz
+        // Target PLL OP Frequency: 76.800 MHz
+        // MT9P017 Input Clock Frequency: 24 MHz
+        // MT9P017 VT (Internal) Pixel Clock Frequency: 96 MHz
+        // MT9P017 OP (Output) Pixel Clock Frequency: 76.800 MHz
+        // pre_pll_clk_div = 2
+        // pll_multiplier = 64
+        // vt_sys_clk_div = 1
+        // vt_pix_clk_div = 8
+        // op_sys_clk_div = 1
+        // op_pix_clk_div = 10
+        // ip_clk = 12 MHz
+        // op_clk = 768 MHz
+        // op_sys_clk = 768 MHz
+        //
+        // [SENSOR PARAMETERS]
+        //
+        // Requested Frames Per Second: 12.250
+        // Output Columns: 2592
+        // Output Rows: 1944
+        // Use Binning: Unchecked
+        // Allow Skipping: Unchecked
+        // Blanking Computation: HB Max then VB
+        //
+        // Max Frame Time: 81.6327 msec
+        // Max Frame Clocks: 7836734.6 clocks (96 MHz)
+        // Maximun Frame Rate: 12.859 fps
+        // Pixel Clock: divided by 1
+        // Skip Mode: 1x cols, 1x rows, Bin Mode: No
+        // Horiz clks:  2592 active + 1285 blank = 3877 total
+        // Vert  rows:  1944 active + 77 blank = 2021 total
+        //
+        // Actual Frame Clocks: 7836734 clocks
+        // Row Time: 40.385 usec / 3877 clocks
+        // Frame time: 81.632646 msec
+        // Frames per Sec: 12.250 fps
+
+        {1,0x0103, 0x01},    //SOFTWARE_RESET (clears itself)
+        {TIME_DELAY, 0, 5},      //Initialization Time
 #if 1
-	//[AR0542 (A-5141) Register Wizard Defaults]
-	{1, 0x0100, 0x0},	//Mode Select = 0x0
-	//REG = 0x301A, 0x0018	//Reset Register = 0x18
-	{2, 0x0112, 0x0A0A},	//CCP Data Format = 0xA0A
-	{2, 0x3064, 0x7800},	//SMIA_Test = 0x7800
-	{2, 0x31AE, 0x0202},	//Serial Format = 0x202
-	
-	//Silicon Recommendation
-	//REG= 0x301C, 0x00 	//Turn-off streamming
-	{2, 0x316A, 0x8400}, 	//RESERVED
-	{2, 0x316C, 0x8400}, 	//RESERVED
-	{2, 0x316E, 0x8400}, 	//RESERVED
-	{2, 0x3EFA, 0x171F}, 	//RESERVED
-	{2, 0x3ED2, 0xD965}, 	//Manufacturer-Specific
-	{2, 0x3ED8, 0x7F1B}, 	//Manufacturer-Specific
-	{2, 0x3EDA, 0x2F11}, 	//Manufacturer-Specific
-	{2, 0x3EDE, 0xB000}, 	//Manufacturer-Specific
-	{2, 0x3EE2, 0x0060}, 	//Manufacturer-Specific
-	{2, 0x3EF2, 0xD965}, 	//Manufacturer-Specific
-	{2, 0x3EF8, 0x797F}, 	//Manufacturer-Specific
-	{2, 0x3EFC, 0x246F}, 	//Manufacturer-Specific
-	{2, 0x3EFE, 0x6F01}, 	//Manufacturer-Specific
-	//LOAD= A-5141_pixel_timing
-	{2, 0x3E00, 0x0428},
-	{2, 0x3E02, 0xFFFF},
-	{2, 0x3E04, 0xFFFF},
-	{2, 0x3E06, 0xFFFF},
-	{2, 0x3E08, 0x8071},
-	{2, 0x3E0A, 0x7281},
-	{2, 0x3E0C, 0x0041},
-	{2, 0x3E0E, 0x5355},
-	{2, 0x3E10, 0x8710},
-	{2, 0x3E12, 0x6085},
-	{2, 0x3E14, 0x4080},
-	{2, 0x3E16, 0x41A0},
-	{2, 0x3E18, 0x0018},
-	{2, 0x3E1A, 0x9057},
-	{2, 0x3E1C, 0xA049},
-	{2, 0x3E1E, 0xA649},
-	{2, 0x3E20, 0x8846},
-	{2, 0x3E22, 0x8142},
-	{2, 0x3E24, 0x0082},
-	{2, 0x3E26, 0x8B49},
-	{2, 0x3E28, 0x9C49},
-	{2, 0x3E2A, 0x8A10},
-	{2, 0x3E2C, 0x0C82},
-	{2, 0x3E2E, 0x4784},
-	{2, 0x3E30, 0x4D85},
-	{2, 0x3E32, 0x0406},
-	{2, 0x3E34, 0x9510},
-	{2, 0x3E36, 0x0EC3},
-	{2, 0x3E38, 0x4A42},
-	{2, 0x3E3A, 0x8341},
-	{2, 0x3E3C, 0x8B4B},
-	{2, 0x3E3E, 0xA84B},
-	{2, 0x3E40, 0x8056},
-	{2, 0x3E42, 0x8000},
-	{2, 0x3E44, 0x1C81},
-	{2, 0x3E46, 0x10E0},
-	{2, 0x3E48, 0x8055},
-	{2, 0x3E4A, 0x1C00},
-	{2, 0x3E4C, 0x827C},
-	{2, 0x3E4E, 0x0970},
-	{2, 0x3E50, 0x8082},
-	{2, 0x3E52, 0x7281},
-	{2, 0x3E54, 0x4C40},
-	{2, 0x3E56, 0x9110},
-	{2, 0x3E58, 0x0C85},
-	{2, 0x3E5A, 0x4D9E},
-	{2, 0x3E5C, 0x4D80},
-	{2, 0x3E5E, 0x100C},
-	{2, 0x3E60, 0x8E40},
-	{2, 0x3E62, 0x4C81},
-	{2, 0x3E64, 0x7C51},
-	{2, 0x3E66, 0x7000},
-	{2, 0x3E68, 0x0000},
-	{2, 0x3E6A, 0x0000},
-	{2, 0x3E6C, 0x0000},
-	{2, 0x3E6E, 0x0000},
-	{2, 0x3E70, 0x0000},
-	{2, 0x3E72, 0x0000},
-	{2, 0x3E74, 0x0000},
-	{2, 0x3E76, 0x0000},
-	{2, 0x3E78, 0x0000},
-	{2, 0x3E7A, 0x0000},
-	{2, 0x3E7C, 0x0000},
-	{2, 0x3E7E, 0x0000},
-	{2, 0x3E80, 0x0000},
-	{2, 0x3E82, 0x0000},
-	{2, 0x3E84, 0x0000},
-	{2, 0x3E86, 0x0000},
-	{2, 0x3E88, 0x0000},
-	{2, 0x3E8A, 0x0000},
-	{2, 0x3E8C, 0x0000},
-	{2, 0x3E8E, 0x0000},
-	{2, 0x3E90, 0x0000},
-	{2, 0x3E92, 0x0000},
-	{2, 0x3E94, 0x0000},
-	{2, 0x3E96, 0x0000},
-	{2, 0x3E98, 0x0000},
-	{2, 0x3E9A, 0x0000},
-	{2, 0x3E9C, 0x0000},
-	{2, 0x3E9E, 0x0000},
-	{2, 0x3EA0, 0x0000},
-	{2, 0x3EA2, 0x0000},
-	{2, 0x3EA4, 0x0000},
-	{2, 0x3EA6, 0x0000},
-	{2, 0x3EA8, 0x0000},
-	{2, 0x3EAA, 0x0000},
-	{2, 0x3EAC, 0x0000},
-	{2, 0x3EAE, 0x0000},
-	{2, 0x3EB0, 0x0000},
-	{2, 0x3EB2, 0x0000},
-	{2, 0x3EB4, 0x0000},
-	{2, 0x3EB6, 0x0000},
-	{2, 0x3EB8, 0x0000},
-	{2, 0x3EBA, 0x0000},
-	{2, 0x3EBC, 0x0000},
-	{2, 0x3EBE, 0x0000},
-	{2, 0x3EC0, 0x0000},
-	{2, 0x3EC2, 0x0000},
-	{2, 0x3EC4, 0x0000},
-	{2, 0x3EC6, 0x0000},
-	{2, 0x3EC8, 0x0000},
-	{2, 0x3ECA, 0x0000},
-	{2, 0x3170, 0x2150},	//Manufacturer-Specific
-	{2, 0x317A, 0x0150},	//Manufacturer-Specific
-	{2, 0x3ECC, 0x2200},	//Manufacturer-Specific
-	{2, 0x3174, 0x0000},	//Manufacturer-Specific
-	{2, 0x3176, 0X0000},	//Manufacturer-Specific
-	{2, 0x30BC, 0x0384},	//CALIB_GLOBAL
-	{2, 0x30C0, 0x1220},	//CALIB_CONTROL
-	
-	//REG= 0x301C, 0x01 	//Turn-on streamming
-	
-	// PLL Settings
-	{1, 0x0300, 0x08},	//vt_pix_clk_div = 0x8
-	{1, 0x0302, 0x01},	//vt_sys_clk_div = 0x1
-	{1, 0x0304, 0x02},	//pre_pll_clk_div = 0x2
-	{1, 0x0306, 0x40},	//pll_multiplier = 0x40
-	{1, 0x0308, 0x0A},	//op_pix_clk_div = 0xA
-	{1, 0x030A, 0x01},	//op_sys_clk_div = 0x1
-	//DELAY = 1               // Allow PLL to lock
-	{TIME_DELAY, 0, 1}, 
-	
-	// Timing Settings
-	{1, 0x0104, 0x1}, 	//Grouped Parameter Hold = 0x1
-	{2, 0x034C, 0x0A20},	//Output Width = 0xA20
-	{2, 0x034E, 0x0798},	//Output Height = 0x798
-	{2, 0x0344, 0x008 },      //Column Start = 0x8
-	{2, 0x0346, 0x008 },      //Row Start = 0x8
-	{2, 0x0348, 0xA27 },      //Column End = 0xA27
-	{2, 0x034A, 0x79F },      //Row End = 0x79F
-	{2, 0x3040, 0x8041},	//Read Mode = 0x41
-	{2, 0x3010, 0x00A0},	//Fine Correction = 0xA0
-	{2, 0x3012, 0x07E4},	//Coarse Integration Time = 0x7E4
-	{2, 0x3014, 0x0D43},	//Fine Integration Time = 0xD43
-	{2, 0x0340, 0x07E5},	//Frame Lines = 0x7E5
-	{2, 0x0342, 0x0F25},	//Line Length = 0xF25
-	{1, 0x0104, 0x0},	//Grouped Parameter Hold = 0x0
-	{1, 0x0100, 0x1},	//Mode Select = 0x1
+        //[AR0542 (A-5141) Register Wizard Defaults]
+        {1, 0x0100, 0x0},	//Mode Select = 0x0
+        //REG = 0x301A, 0x0018	//Reset Register = 0x18
+        {2, 0x0112, 0x0A0A},	//CCP Data Format = 0xA0A
+        {2, 0x3064, 0x7800},	//SMIA_Test = 0x7800
+        {2, 0x31AE, 0x0202},	//Serial Format = 0x202
+
+        //Silicon Recommendation
+        //REG= 0x301C, 0x00 	//Turn-off streamming
+        {2, 0x316A, 0x8400}, 	//RESERVED
+        {2, 0x316C, 0x8400}, 	//RESERVED
+        {2, 0x316E, 0x8400}, 	//RESERVED
+        {2, 0x3EFA, 0x171F}, 	//RESERVED
+        {2, 0x3ED2, 0xD965}, 	//Manufacturer-Specific
+        {2, 0x3ED8, 0x7F1B}, 	//Manufacturer-Specific
+        {2, 0x3EDA, 0x2F11}, 	//Manufacturer-Specific
+        {2, 0x3EDE, 0xB000}, 	//Manufacturer-Specific
+        {2, 0x3EE2, 0x0060}, 	//Manufacturer-Specific
+        {2, 0x3EF2, 0xD965}, 	//Manufacturer-Specific
+        {2, 0x3EF8, 0x797F}, 	//Manufacturer-Specific
+        {2, 0x3EFC, 0x246F}, 	//Manufacturer-Specific
+        {2, 0x3EFE, 0x6F01}, 	//Manufacturer-Specific
+        //LOAD= A-5141_pixel_timing
+        {2, 0x3E00, 0x0428},
+        {2, 0x3E02, 0xFFFF},
+        {2, 0x3E04, 0xFFFF},
+        {2, 0x3E06, 0xFFFF},
+        {2, 0x3E08, 0x8071},
+        {2, 0x3E0A, 0x7281},
+        {2, 0x3E0C, 0x0041},
+        {2, 0x3E0E, 0x5355},
+        {2, 0x3E10, 0x8710},
+        {2, 0x3E12, 0x6085},
+        {2, 0x3E14, 0x4080},
+        {2, 0x3E16, 0x41A0},
+        {2, 0x3E18, 0x0018},
+        {2, 0x3E1A, 0x9057},
+        {2, 0x3E1C, 0xA049},
+        {2, 0x3E1E, 0xA649},
+        {2, 0x3E20, 0x8846},
+        {2, 0x3E22, 0x8142},
+        {2, 0x3E24, 0x0082},
+        {2, 0x3E26, 0x8B49},
+        {2, 0x3E28, 0x9C49},
+        {2, 0x3E2A, 0x8A10},
+        {2, 0x3E2C, 0x0C82},
+        {2, 0x3E2E, 0x4784},
+        {2, 0x3E30, 0x4D85},
+        {2, 0x3E32, 0x0406},
+        {2, 0x3E34, 0x9510},
+        {2, 0x3E36, 0x0EC3},
+        {2, 0x3E38, 0x4A42},
+        {2, 0x3E3A, 0x8341},
+        {2, 0x3E3C, 0x8B4B},
+        {2, 0x3E3E, 0xA84B},
+        {2, 0x3E40, 0x8056},
+        {2, 0x3E42, 0x8000},
+        {2, 0x3E44, 0x1C81},
+        {2, 0x3E46, 0x10E0},
+        {2, 0x3E48, 0x8055},
+        {2, 0x3E4A, 0x1C00},
+        {2, 0x3E4C, 0x827C},
+        {2, 0x3E4E, 0x0970},
+        {2, 0x3E50, 0x8082},
+        {2, 0x3E52, 0x7281},
+        {2, 0x3E54, 0x4C40},
+        {2, 0x3E56, 0x9110},
+        {2, 0x3E58, 0x0C85},
+        {2, 0x3E5A, 0x4D9E},
+        {2, 0x3E5C, 0x4D80},
+        {2, 0x3E5E, 0x100C},
+        {2, 0x3E60, 0x8E40},
+        {2, 0x3E62, 0x4C81},
+        {2, 0x3E64, 0x7C51},
+        {2, 0x3E66, 0x7000},
+        {2, 0x3E68, 0x0000},
+        {2, 0x3E6A, 0x0000},
+        {2, 0x3E6C, 0x0000},
+        {2, 0x3E6E, 0x0000},
+        {2, 0x3E70, 0x0000},
+        {2, 0x3E72, 0x0000},
+        {2, 0x3E74, 0x0000},
+        {2, 0x3E76, 0x0000},
+        {2, 0x3E78, 0x0000},
+        {2, 0x3E7A, 0x0000},
+        {2, 0x3E7C, 0x0000},
+        {2, 0x3E7E, 0x0000},
+        {2, 0x3E80, 0x0000},
+        {2, 0x3E82, 0x0000},
+        {2, 0x3E84, 0x0000},
+        {2, 0x3E86, 0x0000},
+        {2, 0x3E88, 0x0000},
+        {2, 0x3E8A, 0x0000},
+        {2, 0x3E8C, 0x0000},
+        {2, 0x3E8E, 0x0000},
+        {2, 0x3E90, 0x0000},
+        {2, 0x3E92, 0x0000},
+        {2, 0x3E94, 0x0000},
+        {2, 0x3E96, 0x0000},
+        {2, 0x3E98, 0x0000},
+        {2, 0x3E9A, 0x0000},
+        {2, 0x3E9C, 0x0000},
+        {2, 0x3E9E, 0x0000},
+        {2, 0x3EA0, 0x0000},
+        {2, 0x3EA2, 0x0000},
+        {2, 0x3EA4, 0x0000},
+        {2, 0x3EA6, 0x0000},
+        {2, 0x3EA8, 0x0000},
+        {2, 0x3EAA, 0x0000},
+        {2, 0x3EAC, 0x0000},
+        {2, 0x3EAE, 0x0000},
+        {2, 0x3EB0, 0x0000},
+        {2, 0x3EB2, 0x0000},
+        {2, 0x3EB4, 0x0000},
+        {2, 0x3EB6, 0x0000},
+        {2, 0x3EB8, 0x0000},
+        {2, 0x3EBA, 0x0000},
+        {2, 0x3EBC, 0x0000},
+        {2, 0x3EBE, 0x0000},
+        {2, 0x3EC0, 0x0000},
+        {2, 0x3EC2, 0x0000},
+        {2, 0x3EC4, 0x0000},
+        {2, 0x3EC6, 0x0000},
+        {2, 0x3EC8, 0x0000},
+        {2, 0x3ECA, 0x0000},
+        {2, 0x3170, 0x2150},	//Manufacturer-Specific
+        {2, 0x317A, 0x0150},	//Manufacturer-Specific
+        {2, 0x3ECC, 0x2200},	//Manufacturer-Specific
+        {2, 0x3174, 0x0000},	//Manufacturer-Specific
+        {2, 0x3176, 0X0000},	//Manufacturer-Specific
+        {2, 0x30BC, 0x0384},	//CALIB_GLOBAL
+        {2, 0x30C0, 0x1220},	//CALIB_CONTROL
+
+        //REG= 0x301C, 0x01 	//Turn-on streamming
+#if 1 //85h lens shading
+        {1,0x0104, 0x01},    // GROUPED_PARAMETER_HOLD = 0x1
+        {2, 0x3780, 0x0000}, 	// POLY_SC_ENABLE
+        {2, 0x3600, 0x0170}, 	// P_GR_P0Q0
+        {2, 0x3602, 0x2348}, 	// P_GR_P0Q1
+        {2, 0x3604, 0x1D71}, 	// P_GR_P0Q2
+        {2, 0x3606, 0x2808}, 	// P_GR_P0Q3
+        {2, 0x3608, 0xC4B0}, 	// P_GR_P0Q4
+        {2, 0x360A, 0x0170}, 	// P_RD_P0Q0
+        {2, 0x360C, 0xC04C}, 	// P_RD_P0Q1
+        {2, 0x360E, 0x1CD1}, 	// P_RD_P0Q2
+        {2, 0x3610, 0x15EF}, 	// P_RD_P0Q3
+        {2, 0x3612, 0xFD30}, 	// P_RD_P0Q4
+        {2, 0x3614, 0x00D0}, 	// P_BL_P0Q0
+        {2, 0x3616, 0x64EA}, 	// P_BL_P0Q1
+        {2, 0x3618, 0x2FF0}, 	// P_BL_P0Q2
+        {2, 0x361A, 0xB6EE}, 	// P_BL_P0Q3
+        {2, 0x361C, 0xABCF}, 	// P_BL_P0Q4
+        {2, 0x361E, 0x01F0}, 	// P_GB_P0Q0
+        {2, 0x3620, 0xF76C}, 	// P_GB_P0Q1
+        {2, 0x3622, 0x2751}, 	// P_GB_P0Q2
+        {2, 0x3624, 0x0FAE}, 	// P_GB_P0Q3
+        {2, 0x3626, 0xFFD0}, 	// P_GB_P0Q4
+        {2, 0x3640, 0x80ED}, 	// P_GR_P1Q0
+        {2, 0x3642, 0x834E}, 	// P_GR_P1Q1
+        {2, 0x3644, 0x8AEF}, 	// P_GR_P1Q2
+        {2, 0x3646, 0x3DAC}, 	// P_GR_P1Q3
+        {2, 0x3648, 0x2D50}, 	// P_GR_P1Q4
+        {2, 0x364A, 0xF32C}, 	// P_RD_P1Q0
+        {2, 0x364C, 0x5ECE}, 	// P_RD_P1Q1
+        {2, 0x364E, 0x8B0E}, 	// P_RD_P1Q2
+        {2, 0x3650, 0xA7AF}, 	// P_RD_P1Q3
+        {2, 0x3652, 0x2A6F}, 	// P_RD_P1Q4
+        {2, 0x3654, 0xA2AC}, 	// P_BL_P1Q0
+        {2, 0x3656, 0x134E}, 	// P_BL_P1Q1
+        {2, 0x3658, 0x3E6E}, 	// P_BL_P1Q2
+        {2, 0x365A, 0xCF6D}, 	// P_BL_P1Q3
+        {2, 0x365C, 0xA1CE}, 	// P_BL_P1Q4
+        {2, 0x365E, 0x9D2C}, 	// P_GB_P1Q0
+        {2, 0x3660, 0xC0CE}, 	// P_GB_P1Q1
+        {2, 0x3662, 0x310E}, 	// P_GB_P1Q2
+        {2, 0x3664, 0x2B6E}, 	// P_GB_P1Q3
+        {2, 0x3666, 0xA46E}, 	// P_GB_P1Q4
+        {2, 0x3680, 0x25F1}, 	// P_GR_P2Q0
+        {2, 0x3682, 0x612E}, 	// P_GR_P2Q1
+        {2, 0x3684, 0x166F}, 	// P_GR_P2Q2
+        {2, 0x3686, 0x544E}, 	// P_GR_P2Q3
+        {2, 0x3688, 0x92D3}, 	// P_GR_P2Q4
+        {2, 0x368A, 0x4DB1}, 	// P_RD_P2Q0
+        {2, 0x368C, 0xFE2D}, 	// P_RD_P2Q1
+        {2, 0x368E, 0x39CE}, 	// P_RD_P2Q2
+        {2, 0x3690, 0xCACF}, 	// P_RD_P2Q3
+        {2, 0x3692, 0x8073}, 	// P_RD_P2Q4
+        {2, 0x3694, 0x7BD0}, 	// P_BL_P2Q0
+        {2, 0x3696, 0x1A2E}, 	// P_BL_P2Q1
+        {2, 0x3698, 0x4BEF}, 	// P_BL_P2Q2
+        {2, 0x369A, 0x2FF0}, 	// P_BL_P2Q3
+        {2, 0x369C, 0xB072}, 	// P_BL_P2Q4
+        {2, 0x369E, 0x1EB1}, 	// P_GB_P2Q0
+        {2, 0x36A0, 0xB10D}, 	// P_GB_P2Q1
+        {2, 0x36A2, 0x532E}, 	// P_GB_P2Q2
+        {2, 0x36A4, 0xDEEE}, 	// P_GB_P2Q3
+        {2, 0x36A6, 0xEC12}, 	// P_GB_P2Q4
+        {2, 0x36C0, 0x39EC}, 	// P_GR_P3Q0
+        {2, 0x36C2, 0x89CD}, 	// P_GR_P3Q1
+        {2, 0x36C4, 0x39D0}, 	// P_GR_P3Q2
+        {2, 0x36C6, 0x7E10}, 	// P_GR_P3Q3
+        {2, 0x36C8, 0xD031}, 	// P_GR_P3Q4
+        {2, 0x36CA, 0x3BAF}, 	// P_RD_P3Q0
+        {2, 0x36CC, 0xEC8D}, 	// P_RD_P3Q1
+        {2, 0x36CE, 0x448E}, 	// P_RD_P3Q2
+        {2, 0x36D0, 0x402F}, 	// P_RD_P3Q3
+        {2, 0x36D2, 0xD691}, 	// P_RD_P3Q4
+        {2, 0x36D4, 0x6D49}, 	// P_BL_P3Q0
+        {2, 0x36D6, 0xF42D}, 	// P_BL_P3Q1
+        {2, 0x36D8, 0x2FB0}, 	// P_BL_P3Q2
+        {2, 0x36DA, 0x598B}, 	// P_BL_P3Q3
+        {2, 0x36DC, 0xCE91}, 	// P_BL_P3Q4
+        {2, 0x36DE, 0x0E2C}, 	// P_GB_P3Q0
+        {2, 0x36E0, 0x1189}, 	// P_GB_P3Q1
+        {2, 0x36E2, 0x0571}, 	// P_GB_P3Q2
+        {2, 0x36E4, 0x1DD0}, 	// P_GB_P3Q3
+        {2, 0x36E6, 0x9CB2}, 	// P_GB_P3Q4
+        {2, 0x3700, 0xD830}, 	// P_GR_P4Q0
+        {2, 0x3702, 0x8D0D}, 	// P_GR_P4Q1
+        {2, 0x3704, 0xB9F3}, 	// P_GR_P4Q2
+        {2, 0x3706, 0x9CB1}, 	// P_GR_P4Q3
+        {2, 0x3708, 0x5CF3}, 	// P_GR_P4Q4
+        {2, 0x370A, 0x8291}, 	// P_RD_P4Q0
+        {2, 0x370C, 0x65EE}, 	// P_RD_P4Q1
+        {2, 0x370E, 0xEDD3}, 	// P_RD_P4Q2
+        {2, 0x3710, 0xD82E}, 	// P_RD_P4Q3
+        {2, 0x3712, 0x3D14}, 	// P_RD_P4Q4
+        {2, 0x3714, 0xA150}, 	// P_BL_P4Q0
+        {2, 0x3716, 0xB06F}, 	// P_BL_P4Q1
+        {2, 0x3718, 0xFC12}, 	// P_BL_P4Q2
+        {2, 0x371A, 0x9170}, 	// P_BL_P4Q3
+        {2, 0x371C, 0x07B3}, 	// P_BL_P4Q4
+        {2, 0x371E, 0x9E90}, 	// P_GB_P4Q0
+        {2, 0x3720, 0xBD8B}, 	// P_GB_P4Q1
+        {2, 0x3722, 0xB413}, 	// P_GB_P4Q2
+        {2, 0x3724, 0x1611}, 	// P_GB_P4Q3
+        {2, 0x3726, 0x1B53}, 	// P_GB_P4Q4
+        {2, 0x3782, 0x04F4}, 	// POLY_ORIGIN_C
+        {2, 0x3784, 0x03C8}, 	// POLY_ORIGIN_R
+        {2, 0x37C0, 0x3E29}, 	// P_GR_Q5
+        {2, 0x37C2, 0x0FC8}, 	// P_RD_Q5
+        {2, 0x37C4, 0x0F2A}, 	// P_BL_Q5
+        {2, 0x37C6, 0x5209}, 	// P_GB_Q5
+        {2, 0x3780, 0x8000}, 	// POLY_SC_ENABLE
+#endif
+        // PLL Settings
+        {2, 0x0300, 0x04},	//vt_pix_clk_div = 0x8
+        {2, 0x0302, 0x01},	//vt_sys_clk_div = 0x1
+        {2, 0x0304, 0x02},	//pre_pll_clk_div = 0x2
+        {2, 0x0306, 0x50},	//pll_multiplier = 0x40
+        {2, 0x0308, 0x0A},	//op_pix_clk_div = 0xA
+        {2, 0x030A, 0x01},	//op_sys_clk_div = 0x1
+        //DELAY = 1               // Allow PLL to lock
+        {TIME_DELAY, 0, 1},
+
+        // Timing Settings
+        {2, 0x034C, 0x0A20},	//Output Width = 0xA20
+        {2, 0x034E, 0x0798},	//Output Height = 0x798
+        {2, 0x0344, 0x008 },      //Column Start = 0x8
+        {2, 0x0346, 0x008 },      //Row Start = 0x8
+        {2, 0x0348, 0xA27 },      //Column End = 0xA27
+        {2, 0x034A, 0x79F },      //Row End = 0x79F
+        {2, 0x3040, 0x8041},	//Read Mode = 0x41
+        {2, 0x3010, 0x00A0},	//Fine Correction = 0xA0
+        {2, 0x3012, 0x07E4},	//Coarse Integration Time = 0x7E4
+        {2, 0x3014, 0x0D43},	//Fine Integration Time = 0xD43
+        {2, 0x0340, 0x07E5},	//Frame Lines = 0x7E5
+        {2, 0x0342, 0x0F25},	//Line Length = 0xF25
+        {1, 0x0104, 0x0},	//Grouped Parameter Hold = 0x0
+        {1, 0x0100, 0x1},	//Mode Select = 0x1
 #endif
 
-	{END_OF_SCRIPT, 0, 0},
+        {END_OF_SCRIPT, 0, 0},
 };
 
 static resolution_param_t  prev_resolution_array[] = {
@@ -1383,7 +2556,7 @@ static resolution_param_t  prev_resolution_array[] = {
 		.reg_script[1]		= AR0543_720P_script_mipi,
 	}, {
 		.frmsize			= {1280, 960},
-		.active_frmsize		= {1280, 960},
+		.active_frmsize		= {1296, 972},
 		.active_fps			= 30,
 		.size_type			= SIZE_1280X960,
 		.reg_script[0]		= AR0543_preview_960P_script,
@@ -1401,32 +2574,32 @@ static resolution_param_t  prev_resolution_array[] = {
 static resolution_param_t  debug_prev_resolution_array[] = {
 	{
 		.frmsize			= {176, 144},
-		.active_frmsize		= {640, 480},
+		.active_frmsize		= {1296, 972},
 		.active_fps			= 30,
 		.size_type			= SIZE_176X144,
 		.reg_script[0]		= AR0543_preview_VGA_script,
-		.reg_script[1]		= AR0543_VGA_script_mipi,
+		.reg_script[1]		= AR0543_960P_script_mipi,
 	},{
 		.frmsize			= {320, 240},
-		.active_frmsize		= {640, 480},
+		.active_frmsize		= {1296, 972},
 		.active_fps			= 30,
 		.size_type			= SIZE_320X240,
 		.reg_script[0]		= AR0543_preview_VGA_script,
-		.reg_script[1]		= AR0543_VGA_script_mipi,
+		.reg_script[1]		= AR0543_960P_script_mipi,
 	},{
 		.frmsize			= {352, 288},
-		.active_frmsize		= {640, 480},
+		.active_frmsize		= {1296, 972},
 		.active_fps			= 30,
 		.size_type			= SIZE_352X288,
 		.reg_script[0]		= AR0543_preview_VGA_script,
-		.reg_script[1]		= AR0543_VGA_script_mipi,
+		.reg_script[1]		= AR0543_960P_script_mipi,
 	}, {
 		.frmsize			= {640, 480},
-		.active_frmsize		= {640, 480},
+		.active_frmsize		= {1296, 972},
 		.active_fps			= 30,
 		.size_type			= SIZE_640X480,
 		.reg_script[0]		= AR0543_preview_VGA_script,
-		.reg_script[1]		= AR0543_VGA_script_mipi,
+		.reg_script[1]		= AR0543_960P_script_mipi,
 	}, {
 		.frmsize			= {1280, 720},
 		.active_frmsize		= {1280, 720},
@@ -1436,11 +2609,11 @@ static resolution_param_t  debug_prev_resolution_array[] = {
 		.reg_script[1]		= AR0543_720P_script_mipi,
 	}, {
 		.frmsize			= {1280, 960},
-		.active_frmsize		= {1280, 960},
-		.active_fps			= 30,
+		.active_frmsize		= {2592, 1944},
+		.active_fps			= 7.5,
 		.size_type			= SIZE_1280X960,
 		.reg_script[0]		= AR0543_preview_960P_script,
-		.reg_script[1]		= AR0543_960P_script_mipi,
+		.reg_script[1]		= AR0543_5M_script_mipi,
 	}, {
 		.frmsize			= {1920, 1080},
 		.active_frmsize		= {1920, 1080},
@@ -1466,16 +2639,44 @@ static resolution_param_t  capture_resolution_array[] = {
 		.size_type			= SIZE_2592X1944,
 		.reg_script[0]			= AR0543_capture_5M_script,
 		.reg_script[1]			= AR0543_5M_script_mipi,
-	},
+       },{
+               .frmsize                        = {2048, 1536},
+               .active_frmsize         = {2592, 1944},
+               .active_fps                     = 15,
+               .size_type                      = SIZE_2048X1536,
+               .reg_script[0]                  = AR0543_capture_5M_script,
+               .reg_script[1]                  = AR0543_5M_script_mipi,
+       },{
+               .frmsize                        = {1600, 1200},
+               .active_frmsize         = {2592, 1944},
+               .active_fps                     = 15,
+               .size_type                      = SIZE_1600X1200,
+               .reg_script[0]                  = AR0543_capture_5M_script,
+               .reg_script[1]                  = AR0543_5M_script_mipi,
+
+        },
 };
 
+static char *vstrdup(const char *buf)
+{
+	char * buf_orig = NULL;
+	int n = strlen(buf)+1;
+	buf_orig = vmalloc(n);
+	if(buf_orig){
+		memset(buf_orig, 0, n);
+		memcpy(buf_orig, buf, n-1);
+	}
+	return buf_orig;
+}
 
 static void parse_param(const char *buf,char **parm){
 	char *buf_orig, *ps, *token;
 	unsigned int n=0;
 
-	buf_orig = kstrdup(buf, GFP_KERNEL);
+	//buf_orig = kstrdup(buf, GFP_KERNEL);
+	buf_orig = vstrdup(buf);
 	ps = buf_orig;
+	n=0;
 	while(1) {
 	        token = strsep(&ps, " \n");
 	        if (token == NULL)
@@ -1485,6 +2686,7 @@ static void parse_param(const char *buf,char **parm){
 	        parm[n++] = token;
 	        printk("%s\n",parm[n-1]);
 	}
+	vfree(buf_orig);
 	//kfree(buf_orig);
 }
 
@@ -1824,11 +3026,20 @@ static void dw9714_init(unsigned char mode)
 /* power down for dw9714*/
 static void dw9714_uninit(void)
 {
-    char buf[3];
-    struct i2c_adapter *adapter;
-	buf[0] = 0x80;
-	buf[1] = 0x0;
+	char buf[3];
+	struct i2c_adapter *adapter;
+	int vcm_data;
 	adapter = i2c_get_adapter(4);
+	
+	// set the step to 100
+	vcm_data = 100 << 4 | 1 << 2;
+	buf[0] = vcm_data >> 8 & 0xff;
+	buf[1] = vcm_data & 0xff;
+	my_i2c_put_byte_add8(adapter,0x0c,buf,2);
+	
+	msleep(10);
+	// close the vcm
+	buf[0] = buf[0] | 0x80;
 	my_i2c_put_byte_add8(adapter,0x0c,buf,2);	
 }
 
@@ -1943,10 +3154,7 @@ void AR0543_set_param_exposure(struct ar0543_device *dev,enum camera_exposure_e
 {
     //struct i2c_client *client = v4l2_get_subdevdata(&dev->sd);
     int value;
-    if(para == EXPOSURE_0_STEP){
-        dev->cam_para->cam_command = CAM_COMMAND_AE_ON;
-        dev->ae_on = true;
-    }else{
+
         if(dev->ae_on == false){ // set ae on
             dev->cam_para->cam_command = CAM_COMMAND_AE_ON;	
             dev->fe_arg.port = TVIN_PORT_ISP;
@@ -1961,7 +3169,7 @@ void AR0543_set_param_exposure(struct ar0543_device *dev,enum camera_exposure_e
         dev->cam_para->cam_command = CAM_COMMAND_SET_AE_LEVEL;
         dev->cam_para->exposure_level = value;
         printk("set manual exposure level:%d\n",value);
-    }
+
     dev->fe_arg.port = TVIN_PORT_ISP;
     dev->fe_arg.index = 0;
     dev->fe_arg.arg = (void *)(dev->cam_para);
@@ -2430,7 +3638,8 @@ static int ar0543_setting(struct ar0543_device *dev,int PROP_ID,int value )
 		if(ar0543_qctrl[13].default_value!=value){
 			ar0543_qctrl[13].default_value=value;
 			printk(" set camera  focus zone =%d. \n ",value);
-			set_focus_zone(dev, value);
+			if(fh->stream_on)
+            	set_focus_zone(dev, value);
 		}
 		break;
 	case V4L2_CID_FOCUS_AUTO:
@@ -2798,6 +4007,20 @@ static int vidioc_enum_frameintervals(struct file *file, void *priv,
 
 }
 
+static int vidioc_s_crop(struct file *file, void *fh,
+					const struct v4l2_crop *a)
+{
+	if (a->c.width == 0 && a->c.height == 0) {
+		printk("disable capture proc\n");
+		capture_proc = 0;
+	} else {
+		printk("enable capture proc\n");
+		capture_proc = 1;
+	}
+
+	return 0;
+}
+
 static int vidioc_g_fmt_vid_cap(struct file *file, void *priv,
 					struct v4l2_format *f)
 {
@@ -2886,20 +4109,16 @@ static int vidioc_s_fmt_vid_cap(struct file *file, void *priv,
 	fh->type          = f->type;
     if(f->fmt.pix.pixelformat==V4L2_PIX_FMT_RGB24){
         ar0543_work_mode = CAMERA_CAPTURE;
-        res_param = get_resolution_param(dev, 1, fh->width,fh->height);
-        if (!res_param) {
-            printk("error, resolution param not get\n");
-            goto out;
-        }
-        set_resolution_param(dev, res_param);
     }
     else {
     	printk("preview resolution is %dX%d\n",fh->width,  fh->height);
-        if((fh->width == 1280 && fh->height == 720) || 
-        	(fh->width == 1920 && fh->height == 1080)){
+        if (0 == capture_proc) {
         	ar0543_work_mode = CAMERA_RECORD;
-        }else
+        }else {
         	ar0543_work_mode = CAMERA_PREVIEW;
+        }
+        if (0 == dev->is_vdin_start) {
+			printk("loading sensor setting\n");
         res_param = get_resolution_param(dev, 0, fh->width,fh->height);
         if (!res_param) {
             printk("error, resolution param not get\n");
@@ -2911,6 +4130,7 @@ static int vidioc_s_fmt_vid_cap(struct file *file, void *priv,
             dest_hactive = 0;
             dest_vactive = 0;
         }
+        }
     }
 	ret = 0;
 out:
@@ -3006,6 +4226,13 @@ static int vidiocgmbuf(struct file *file, void *priv, struct video_mbuf *mbuf)
     }
 };*/
 #endif
+static unsigned int settle = 24;
+module_param(settle, uint, 0644);
+MODULE_PARM_DESC(settle, "settle time info");
+
+static unsigned int skip_count = 6;
+module_param(skip_count, uint, 0644);
+MODULE_PARM_DESC(skip_count, "activates skip_count info");
 
 static int vidioc_streamon(struct file *file, void *priv, enum v4l2_buf_type i)
 {
@@ -3019,6 +4246,15 @@ static int vidioc_streamon(struct file *file, void *priv, enum v4l2_buf_type i)
 	if (i != fh->type)
 		return -EINVAL;
 
+        if (dev->is_vdin_start) {
+		printk("vidioc_streamon in capture process\n");
+		ret =  videobuf_streamon(&fh->vb_vidq);
+		if(ret == 0){
+			fh->stream_on        = 1;
+		}
+
+		return 0;
+	}
 	memset( &para, 0, sizeof( para ));
 	//para.port  = TVIN_PORT_CAMERA;
 	
@@ -3046,7 +4282,7 @@ static int vidioc_streamon(struct file *file, void *priv, enum v4l2_buf_type i)
 	para.hs_bp = 0;
 	para.vs_bp = 2;
 	para.cfmt = dev->cam_info.bayer_fmt;
-	para.dfmt = TVIN_NV21;
+	//para.dfmt = TVIN_NV21;
 	para.scan_mode = TVIN_SCAN_MODE_PROGRESSIVE;
 	para.bt_path = dev->cam_info.bt_path;
 	current_fmt = 0;
@@ -3068,6 +4304,7 @@ static int vidioc_streamon(struct file *file, void *priv, enum v4l2_buf_type i)
 	        para.csi_hw_info.ui_val = 2; //ns
 	        para.csi_hw_info.urgent = 1;
 
+	        para.csi_hw_info.settle = settle;
 	        para.csi_hw_info.hs_freq = 410; //MHz
 	        para.csi_hw_info.clk_channel = dev->cam_info.clk_channel; //clock channel a or b
 	}
@@ -3083,6 +4320,7 @@ static int vidioc_streamon(struct file *file, void *priv, enum v4l2_buf_type i)
 	ret =  videobuf_streamon(&fh->vb_vidq);
 	if(ret == 0){
 		dev->vops->start_tvin_service(0,&para);
+        dev->is_vdin_start      = 1;
 		fh->stream_on        = 1;
 	}
 	dev->vdin_arg.cmd = VDIN_CMD_SET_CM2;
@@ -3092,6 +4330,7 @@ static int vidioc_streamon(struct file *file, void *priv, enum v4l2_buf_type i)
 	AR0543_set_param_wb(fh->dev,ar0543_qctrl[4].default_value);
 	AR0543_set_param_exposure(fh->dev,ar0543_qctrl[5].default_value);
 	AR0543_set_param_effect(fh->dev,ar0543_qctrl[6].default_value);
+    AR0543_AutoFocus(fh->dev, ar0543_qctrl[8].default_value);
 	return ret;
 }
 
@@ -3106,10 +4345,17 @@ static int vidioc_streamoff(struct file *file, void *priv, enum v4l2_buf_type i)
 	if (i != fh->type)
 		return -EINVAL;
 	ret = videobuf_streamoff(&fh->vb_vidq);
+	if (capture_proc) {
+		printk("vidioc_streamoff in capture process\n");
+		fh->stream_on        = 0;
+		return 0;
+	}
 	if(ret == 0 ){
-        dev->vops->stop_tvin_service(0);
+    	dev->vops->stop_tvin_service(0);
+ 		dev->is_vdin_start      = 0;
         fh->stream_on        = 0;
 	}
+	dev->ae_on = false;
 	return ret;
 }
 
@@ -3190,8 +4436,9 @@ static int vidioc_enum_framesizes(struct file *file, void *fh,struct v4l2_frmsiz
               if (fsize->index >= ARRAY_SIZE(prev_resolution_array))
                       return -EINVAL;
               frmsize = &prev_resolution_array[fsize->index].frmsize;
-              printk("ar0543_prev_resolution[fsize->index]"
-                              "   after fsize->index== %d\n",fsize->index);
+              //printk("ar0543_prev_resolution[fsize->index]"
+              //                "   after fsize->index== %d, wxh=%5dx%5d\n",
+              //                fsize->index, frmsize->width, frmsize->height);
               fsize->type = V4L2_FRMSIZE_TYPE_DISCRETE;
               fsize->discrete.width = frmsize->width;
               fsize->discrete.height = frmsize->height;
@@ -3269,12 +4516,12 @@ static int vidioc_g_ctrl(struct file *file, void *priv,
 {
 	struct ar0543_fh *fh = priv;
 	struct ar0543_device *dev = fh->dev;
-	int i; //status;
+	int i, status;
 	int ret = 0;
 
 	for (i = 0; i < ARRAY_SIZE(ar0543_qctrl); i++)
 		if (ctrl->id == ar0543_qctrl[i].id) {
-		#if 0
+		#if 1
             if( (V4L2_CID_FOCUS_AUTO == ctrl->id)
                     && bDoingAutoFocusMode){
                 dev->cam_para->cam_command = CAM_COMMAND_GET_STATE;
@@ -3364,7 +4611,8 @@ static int ar0543_open(struct file *file)
     resource_size_t mem_start = 0;
     unsigned int mem_size = 0;
     int retval = 0;
-#if CONFIG_CMA
+    capture_proc = 0;
+#ifdef CONFIG_CMA
     retval = vm_init_buf(24*SZ_1M);
     if(retval <0) {
     	printk("error: no cma memory\n");
@@ -3377,11 +4625,14 @@ static int ar0543_open(struct file *file)
     aml_cam_init(&dev->cam_info);
     printk("config path:%s\n",(dev->cam_info).config);
     if((dev->cam_info).config != NULL){
-        if((dev->configure = kmalloc(sizeof(configure_t),0)) != NULL){
+		if(cf != NULL){
+			dev->configure = cf ;
+			printk("dgt, has a configure:%p. usi it\n", cf);
+		}else if((dev->configure = vmalloc(sizeof(configure_t))) != NULL){
             if(parse_config((dev->cam_info).config,dev->configure) == 0){
-                printk("parse successfully");
+                printk("parse successfully, pointer:%p\n", dev->configure);
             }else{
-                printk("parse failed");
+                printk("parse failed\n");
                 return -EINVAL;
             }
         }else{
@@ -3389,21 +4640,27 @@ static int ar0543_open(struct file *file)
             return -ENOMEM;
         }      
     }
-    if((dev->cam_para = kzalloc(sizeof(cam_parameter_t),0)) == NULL){
-        printk("memalloc failed\n");
-        return -ENOMEM;
-    }
-    if(generate_para(dev->cam_para,dev->pindex,dev->configure) != 0){
-        printk("generate para failed\n");
-        free_para(dev->cam_para);
-        kfree(dev->cam_para);
-        return -EINVAL;
-    }
+	if(g_cp != NULL){
+		printk("dgt, has a cam_para:%p,use it\n", g_cp);
+		dev->cam_para = g_cp;
+	}else{ 
+		if((dev->cam_para = vmalloc(sizeof(cam_parameter_t))) == NULL){
+			printk("memalloc failed\n");
+			return -ENOMEM;
+		}
+		if(generate_para(dev->cam_para,dev->pindex,dev->configure) != 0){
+			printk("generate para failed\n");
+			free_para(dev->cam_para);
+			vfree(dev->cam_para);
+			return -EINVAL;
+		}
+	}
     dev->cam_para->cam_function.set_aet_new_step = AR0543_set_aet_new_step;
     dev->cam_para->cam_function.check_mains_freq = AR0543_check_mains_freq;
     dev->cam_para->cam_function.set_af_new_step = AR0543_set_af_new_step;
     dev->camera_priv_data.configure = dev->configure;
     dev->cam_para->cam_function.priv_data = (void *)&dev->camera_priv_data;  
+	g_cp = dev->cam_para;
     dev->ae_on = false;
     AR0543_init_regs(dev);
     msleep(40);
@@ -3482,6 +4739,7 @@ static int ar0543_open(struct file *file)
 	bDoingAutoFocusMode=false;
     cf = dev->configure;
     printk("open successfully\n");
+    dev->is_vdin_start = 0;
     return 0;
 }
 
@@ -3520,32 +4778,19 @@ static int ar0543_close(struct file *file)
     struct video_device  *vdev = video_devdata(file);
     int i=0;
     ar0543_have_open = 0;
+    capture_proc = 0;
     ar0543_stop_thread(vidq);
     videobuf_stop(&fh->vb_vidq);
-    if(fh->stream_on){
+    if (dev->is_vdin_start) {
         dev->vops->stop_tvin_service(0);
+        dev->is_vdin_start = 0;
     }
     videobuf_mmap_free(&fh->vb_vidq);
 
     kfree(fh);
-    if(dev->configure != NULL){
-        if(dev->configure->aet_valid){
-            for(i = 0; i < dev->configure->aet.sum; i++){
-                kfree(dev->configure->aet.aet[i].info);
-                dev->configure->aet.aet[i].info = NULL;
-                kfree(dev->configure->aet.aet[i].aet_table);
-                dev->configure->aet.aet[i].aet_table = NULL;
-            }
-        }
-        kfree(dev->configure);
-        dev->configure = NULL;
-    }
-    cf = NULL;
-    if(dev->cam_para != NULL ){
-        free_para(dev->cam_para);
-        kfree(dev->cam_para);
-        dev->cam_para = NULL;
-    }
+
+	dev->configure = NULL;
+    dev->cam_para = NULL;
 	dev->camera_priv_data.sensor_aet_table = NULL;
 	dev->camera_priv_data.sensor_aet_info = NULL;
     mutex_lock(&dev->mutex);
@@ -3571,7 +4816,6 @@ static int ar0543_close(struct file *file)
     //ar0543_frmintervals_active.denominator = 15;
     power_down_ar0543(dev);
     dw9714_uninit();
-    msleep(10);
 
     aml_cam_uninit(&dev->cam_info);
 
@@ -3588,7 +4832,7 @@ static int ar0543_close(struct file *file)
 	class_remove_file(cam_class,&class_attr_light_source_debug);
     class_remove_file(cam_class,&class_attr_version_debug);
     class_destroy(cam_class);
-    printk("close success\n");
+    printk("%s close success\n", __func__);
 #ifdef CONFIG_CMA
     vm_deinit_buf();
 #endif
@@ -3646,6 +4890,7 @@ static const struct v4l2_ioctl_ops ar0543_ioctl_ops = {
 	.vidioc_enum_framesizes = vidioc_enum_framesizes,
 	.vidioc_g_parm = vidioc_g_parm,
 	.vidioc_enum_frameintervals = vidioc_enum_frameintervals,
+    .vidioc_s_crop        = vidioc_s_crop,
 #ifdef CONFIG_VIDEO_V4L1_COMPAT
 	.vidiocgmbuf          = vidiocgmbuf,
 #endif
@@ -3709,7 +4954,8 @@ static ssize_t cam_info_store(struct device *dev,struct device_attribute *attr,c
 	
 	if(!buf)
 		return len;
-	buf_orig = kstrdup(buf, GFP_KERNEL);
+	//buf_orig = kstrdup(buf, GFP_KERNEL);
+	buf_orig = vstrdup(buf);
 	t = dev_get_drvdata(dev);
 	
 	ps = buf_orig;
@@ -3735,7 +4981,7 @@ static ssize_t cam_info_store(struct device *dev,struct device_attribute *attr,c
 	    printk("clk channel =%s\n", t->cam_info.interface?"clkB":"clkA");
 	}
 	
-	kfree(buf_orig);
+	vfree(buf_orig);
 	
 	return len;
 
@@ -3793,6 +5039,10 @@ static int ar0543_probe(struct i2c_client *client,
 		return err;
 	}
 	device_create_file( &t->vdev->dev, &dev_attr_cam_info);
+
+	cf = NULL;
+	g_cp = NULL;
+
 	return 0;
 }
 
@@ -3805,6 +5055,24 @@ static int ar0543_remove(struct i2c_client *client)
 	v4l2_device_unregister_subdev(sd);
 	wake_lock_destroy(&(t->wake_lock));
 	kfree(t);
+	if(cf){
+		if(cf->aet_valid){
+			int i =0;
+            for(i = 0; i < cf->aet.sum; i++){
+                vfree(cf->aet.aet[i].info);
+                cf->aet.aet[i].info = NULL;
+                vfree(cf->aet.aet[i].aet_table);
+                cf->aet.aet[i].aet_table = NULL;
+            }
+        }
+        vfree(cf);
+        cf = NULL;
+	}
+	if(g_cp){
+        free_para(g_cp);
+		vfree(g_cp);
+		g_cp = NULL;
+	}
 	return 0;
 }
 
diff --git a/include/linux/amlogic/tvin/tvin_v4l2.h b/include/linux/amlogic/tvin/tvin_v4l2.h
index 2b9157589fb1..aa58c1ac1a55 100755
--- a/include/linux/amlogic/tvin/tvin_v4l2.h
+++ b/include/linux/amlogic/tvin/tvin_v4l2.h
@@ -752,6 +752,7 @@ typedef struct csi_parm_s {
 	unsigned ui_val; //ns
 	unsigned hs_freq; //hz
 	unsigned urgent;
+        unsigned settle;
 
         unsigned int lane_mask;
 
-- 
2.19.0

